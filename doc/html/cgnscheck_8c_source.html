<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>CGNS: cgnscheck.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>cgnscheck.c</h1><a href="cgnscheck_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * cgnscheck.c - check CGNS file</span>
<a name="l00003"></a>00003 <span class="comment"> */</span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;stdarg.h&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;ctype.h&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#ifdef _WIN32</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span><span class="preprocessor"># include &lt;io.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#else</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span><span class="preprocessor"># include &lt;unistd.h&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#endif</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="tools_2getargs_8h.html">getargs.h</a>"</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include "<a class="code" href="hash_8h.html">hash.h</a>"</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include "<a class="code" href="cgnslib_8h.html">cgnslib.h</a>"</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include "<a class="code" href="cgns__header_8h.html">cgns_header.h</a>"</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include "<a class="code" href="cgnames_8h.html">cgnames.h</a>"</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="preprocessor">#if !defined(CGNS_VERSION) || CGNS_VERSION &lt; 2300</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor"># error You need at least CGNS Version 2.3</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="preprocessor">#ifndef CG_MODE_READ</span>
<a name="l00026"></a><a class="code" href="cgnscheck_8c.html#eca03512ad78c691a2015799ba394b46">00026</a> <span class="preprocessor"></span><span class="preprocessor"># define CG_MODE_READ   MODE_READ</span>
<a name="l00027"></a><a class="code" href="cgnscheck_8c.html#a3eda4df29cceb4ed9a9c5d5d8f663d7">00027</a> <span class="preprocessor"></span><span class="preprocessor"># define CG_MODE_MODIFY MODE_MODIFY</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span>
<a name="l00030"></a>00030 <span class="preprocessor">#if CGNS_VERSION &lt; 2420</span>
<a name="l00031"></a><a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">00031</a> <span class="preprocessor"></span><span class="preprocessor"># define cg_free free</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a>00034 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor"># define USE_MID_NODES</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span>
<a name="l00038"></a>00038 <span class="keyword">static</span> <span class="keywordtype">int</span> FileVersion;
<a name="l00039"></a>00039 <span class="keyword">static</span> <span class="keywordtype">int</span> LibraryVersion = <a class="code" href="cgns_keywords_8h.html#2a5c0cc33e8f1ae352a2193106548c21">CGNS_VERSION</a>;
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="keyword">static</span> <span class="keywordtype">int</span> verbose = 0;
<a name="l00042"></a>00042 <span class="keyword">static</span> <span class="keywordtype">int</span> nwarn = 0, nerr = 0, totwarn = 0;
<a name="l00043"></a>00043 <span class="keyword">static</span> <span class="keywordtype">int</span> dowarn = 3, doerr = 1;
<a name="l00044"></a>00044 <span class="keyword">static</span> <span class="keywordtype">int</span> cgnsfn, cgnsbase, cgnszone;
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a>, <a class="code" href="write__rind_8c.html#00f223876113d78f6e69408dd20f1a5d">PhyDim</a>;
<a name="l00047"></a>00047 <span class="keyword">static</span> <span class="keywordtype">int</span> BaseClass;
<a name="l00048"></a>00048 <span class="keyword">static</span> <span class="keywordtype">int</span> *pBaseUnits, BaseUnits[9];
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="keyword">static</span> <span class="keywordtype">int</span> BaseIter;
<a name="l00051"></a>00051 <span class="keyword">static</span> <span class="keywordtype">int</span> NumSteps;
<a name="l00052"></a>00052 
<a name="l00053"></a><a class="code" href="struct_v_e_r_t_e_x.html">00053</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00054"></a><a class="code" href="struct_v_e_r_t_e_x.html#f73583b1e980b0aa03f9884812e9fd4d">00054</a>     <span class="keywordtype">float</span> x, y, z;
<a name="l00055"></a>00055 } <a class="code" href="struct_v_e_r_t_e_x.html">VERTEX</a>;
<a name="l00056"></a>00056 
<a name="l00057"></a><a class="code" href="struct_f_a_c_e.html">00057</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00058"></a><a class="code" href="struct_f_a_c_e.html#a75d52109f3f1fa6e40768b15db2814f">00058</a>     <span class="keywordtype">int</span> e1, f1;
<a name="l00059"></a><a class="code" href="struct_f_a_c_e.html#4a0019706837babe79e30464d98c3575">00059</a>     <span class="keywordtype">int</span> e2, f2;
<a name="l00060"></a><a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">00060</a>     <span class="keywordtype">int</span> nnodes;
<a name="l00061"></a><a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">00061</a>     <span class="keywordtype">int</span> *nodes;
<a name="l00062"></a>00062 } <a class="code" href="struct_f_a_c_e.html">FACE</a>;
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="struct_e_l_e_m_s_e_t.html">00064</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00065"></a><a class="code" href="struct_e_l_e_m_s_e_t.html#7913ace0d483311647b8d88f795c6bfd">00065</a>     <span class="keywordtype">char</span> <a class="code" href="_a_d_f__internals_8h.html#d77bc5a56341df5017c60d789a10e95a">name</a>[33];
<a name="l00066"></a><a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">00066</a>     <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0">ElementType_t</a> type;
<a name="l00067"></a><a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">00067</a>     <span class="keywordtype">int</span> is, ie, ib;
<a name="l00068"></a><a class="code" href="struct_e_l_e_m_s_e_t.html#ab6822646f9a53265acb577886434744">00068</a>     <span class="keywordtype">int</span> nv, ns, ne, nn;
<a name="l00069"></a><a class="code" href="struct_e_l_e_m_s_e_t.html#7f858599c75d4d48b0a564d2dbc9f693">00069</a>     <span class="keywordtype">int</span> *<a class="code" href="test__partial_8c.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a>;
<a name="l00070"></a><a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">00070</a>     <span class="keywordtype">int</span> *<a class="code" href="test__partial_8c.html#8e99857563320b5d943128e5816b1d70">parent</a>;
<a name="l00071"></a><a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">00071</a>     <span class="keywordtype">int</span> <a class="code" href="write__rind_8c.html#2566aacf797b3ab4ba9a41d425d41551">rind</a>[2];
<a name="l00072"></a><a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">00072</a>     <span class="keywordtype">int</span> invalid;
<a name="l00073"></a>00073 } <a class="code" href="struct_e_l_e_m_s_e_t.html">ELEMSET</a>;
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="struct_z_o_n_e.html">00075</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00076"></a><a class="code" href="struct_z_o_n_e.html#7913ace0d483311647b8d88f795c6bfd">00076</a>     <span class="keywordtype">char</span> <a class="code" href="_a_d_f__internals_8h.html#d77bc5a56341df5017c60d789a10e95a">name</a>[33];
<a name="l00077"></a><a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">00077</a>     <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe">ZoneType_t</a> type;
<a name="l00078"></a><a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">00078</a>     <span class="keywordtype">int</span> <a class="code" href="_a_d_f__internals_8h.html#f7e2cb66db87441e196776b2ae591e8b">idim</a>;
<a name="l00079"></a><a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">00079</a>     <span class="keywordtype">int</span> <a class="code" href="_a_d_f__internals_8h.html#c51040a8258f439eeb44220688762801">dims</a>[3][3];
<a name="l00080"></a><a class="code" href="struct_z_o_n_e.html#824ac1af8a4229ed37411081a1ffd928">00080</a>     <span class="keywordtype">int</span> nnodes;
<a name="l00081"></a><a class="code" href="struct_z_o_n_e.html#21d5307228ec77940b3f412681afeb68">00081</a>     <span class="keywordtype">int</span> maxnode;
<a name="l00082"></a><a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">00082</a>     <span class="keywordtype">int</span> dataclass;
<a name="l00083"></a><a class="code" href="struct_z_o_n_e.html#82de7fb1611503a894e054b1f3505cf5">00083</a>     <span class="keywordtype">int</span> *punits, units[9];
<a name="l00084"></a><a class="code" href="struct_z_o_n_e.html#dbfb774fafdb2da3e35a7de16db65c3c">00084</a>     <span class="keywordtype">int</span> nsets;
<a name="l00085"></a><a class="code" href="struct_z_o_n_e.html#ab6822646f9a53265acb577886434744">00085</a>     <span class="keywordtype">int</span> nv, ns, ne, nn;
<a name="l00086"></a><a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">00086</a>     <a class="code" href="struct_e_l_e_m_s_e_t.html">ELEMSET</a> *sets;
<a name="l00087"></a><a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">00087</a>     <a class="code" href="hash_8h.html#80b8cd8aa263e5a7edfc12d2834a1640">HASH</a> *<a class="code" href="test__partial_8c.html#952633aac593ee8d692314906f5bdb42">faces</a>;
<a name="l00088"></a><a class="code" href="struct_z_o_n_e.html#316acbd53e045949fbce31ae6f7366f1">00088</a>     <span class="keywordtype">int</span> nextnodes;
<a name="l00089"></a><a class="code" href="struct_z_o_n_e.html#862b1a443066be8463b7b0c2bca06856">00089</a>     <span class="keywordtype">int</span> *extnodes;
<a name="l00090"></a>00090 } <a class="code" href="struct_z_o_n_e.html">ZONE</a>;
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 <span class="keyword">static</span> <span class="keywordtype">int</span> MaxZones = 0;
<a name="l00093"></a>00093 <span class="keyword">static</span> <span class="keywordtype">int</span> NumZones = 0;
<a name="l00094"></a>00094 <span class="keyword">static</span> <a class="code" href="struct_z_o_n_e.html">ZONE</a> *Zones;
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">00096</a> <span class="keyword">typedef</span> <span class="keywordtype">char</span> <a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a>[33];
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <span class="keyword">static</span> <span class="keywordtype">int</span> MaxFamily = 0;
<a name="l00099"></a>00099 <span class="keyword">static</span> <span class="keywordtype">int</span> NumFamily = 0;
<a name="l00100"></a>00100 <span class="keyword">static</span> <a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a> *Family;
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 <span class="keyword">static</span> <span class="keywordtype">int</span> MaxFlowSolution = 0;
<a name="l00103"></a>00103 <span class="keyword">static</span> <span class="keywordtype">int</span> NumFlowSolution = 0;
<a name="l00104"></a>00104 <span class="keyword">static</span> <a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a> *FlowSolution;
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 <span class="keyword">static</span> <span class="keywordtype">int</span> MaxGridCoordinate = 0;
<a name="l00107"></a>00107 <span class="keyword">static</span> <span class="keywordtype">int</span> NumGridCoordinate = 0;
<a name="l00108"></a>00108 <span class="keyword">static</span> <a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a> *GridCoordinate;
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="keyword">static</span> <span class="keywordtype">int</span> MaxArbitraryGrid = 0;
<a name="l00111"></a>00111 <span class="keyword">static</span> <span class="keywordtype">int</span> NumArbitraryGrid = 0;
<a name="l00112"></a>00112 <span class="keyword">static</span> <a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a> *ArbitraryGrid;
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="keyword">static</span> <span class="keywordtype">int</span> MaxRigidGrid = 0;
<a name="l00115"></a>00115 <span class="keyword">static</span> <span class="keywordtype">int</span> NumRigidGrid = 0;
<a name="l00116"></a>00116 <span class="keyword">static</span> <a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a> *RigidGrid;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="comment">/* command line options */</span>
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="keyword">static</span> <span class="keywordtype">char</span> options[] = <span class="stringliteral">"vVuUw:e"</span>;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="keyword">static</span> <span class="keywordtype">char</span> *usgmsg[] = {
<a name="l00123"></a>00123     <span class="stringliteral">"usage  : cgnscheck [options] CGNSfile [CGNSoutfile]"</span>,
<a name="l00124"></a>00124     <span class="stringliteral">"options:"</span>,
<a name="l00125"></a>00125     <span class="stringliteral">"   -v        : verbose output"</span>,
<a name="l00126"></a>00126     <span class="stringliteral">"   -V        : more verbose - print descriptors"</span>,
<a name="l00127"></a>00127     <span class="stringliteral">"   -u        : update CGNS file to CGNS Library Version and check"</span>,
<a name="l00128"></a>00128     <span class="stringliteral">"   -U        : update CGNS file to CGNS Library Version only"</span>,
<a name="l00129"></a>00129     <span class="stringliteral">"   -w&lt;level&gt; : warning level output (0 to 3)"</span>,
<a name="l00130"></a>00130     <span class="stringliteral">"   -e        : don't print error"</span>,
<a name="l00131"></a>00131     NULL
<a name="l00132"></a>00132 };
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 <span class="comment">/*----------------------------------------------------------------------*/</span>
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="keyword">static</span> <span class="keywordtype">void</span> warning (<span class="keywordtype">int</span> level, <span class="keywordtype">char</span> *<a class="code" href="_a_d_f__internals_8h.html#f39d9ddd17f3c7f030824f9b612e54c6">format</a>, ...)
<a name="l00137"></a>00137 {
<a name="l00138"></a>00138     va_list arg;
<a name="l00139"></a>00139     <span class="keywordflow">if</span> (level &lt;= dowarn) {
<a name="l00140"></a>00140         va_start (arg, format);
<a name="l00141"></a>00141         printf (<span class="stringliteral">"WARNING:"</span>);
<a name="l00142"></a>00142         vprintf (format, arg);
<a name="l00143"></a>00143         va_end(arg);
<a name="l00144"></a>00144         putchar (<span class="charliteral">'\n'</span>);
<a name="l00145"></a>00145         nwarn++;
<a name="l00146"></a>00146     }
<a name="l00147"></a>00147     totwarn++;
<a name="l00148"></a>00148 }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150 <span class="keyword">static</span> <span class="keywordtype">void</span> error (<span class="keywordtype">char</span> *format, ...)
<a name="l00151"></a>00151 {
<a name="l00152"></a>00152     va_list arg;
<a name="l00153"></a>00153     <span class="keywordflow">if</span> (doerr) {
<a name="l00154"></a>00154         va_start (arg, format);
<a name="l00155"></a>00155         printf (<span class="stringliteral">"ERROR:"</span>);
<a name="l00156"></a>00156         vprintf (format, arg);
<a name="l00157"></a>00157         va_end(arg);
<a name="l00158"></a>00158         putchar (<span class="charliteral">'\n'</span>);
<a name="l00159"></a>00159     }
<a name="l00160"></a>00160     nerr++;
<a name="l00161"></a>00161 }
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="keywordtype">char</span> *func)
<a name="l00164"></a>00164 {
<a name="l00165"></a>00165     printf(<span class="stringliteral">"CGNSlib ERROR:"</span>);
<a name="l00166"></a>00166     <span class="keywordflow">if</span> (func != NULL &amp;&amp; *func)
<a name="l00167"></a>00167         printf(<span class="stringliteral">"%s:"</span>, func);
<a name="l00168"></a>00168     printf(<span class="stringliteral">"%s\n"</span>, <a class="code" href="cgns__error_8c.html#60ca7f51842a415d7748fa1e2d7ed20e">cg_get_error</a>());
<a name="l00169"></a>00169     exit(1);
<a name="l00170"></a>00170 }
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 <span class="comment">/*----------------------------------------------------------------------*/</span>
<a name="l00173"></a>00173 
<a name="l00174"></a>00174 <span class="keyword">static</span> <span class="keywordtype">void</span> create_names (<span class="keywordtype">int</span> cnt, <span class="keywordtype">int</span> *maxcnt, <a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a> **namelist)
<a name="l00175"></a>00175 {
<a name="l00176"></a>00176     <a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a> *<a class="code" href="_a_d_f__internals_8h.html#87e8d4fea30106a45a2d55992d102288">names</a> = *namelist;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178     <span class="keywordflow">if</span> (cnt &gt; *maxcnt) {
<a name="l00179"></a>00179         <span class="keywordflow">if</span> (*maxcnt)
<a name="l00180"></a>00180             names = (<a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a> *) <a class="code" href="cg__malloc_8h.html#54df243d89c451240697d7d3afb5663f">realloc</a> (names, cnt * <span class="keyword">sizeof</span>(<a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a>));
<a name="l00181"></a>00181         <span class="keywordflow">else</span>
<a name="l00182"></a>00182             names = (<a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (cnt * <span class="keyword">sizeof</span>(<a class="code" href="cgnscheck_8c.html#f103d20f1a87fdb3b7eb4cc3d3516ddb">CGNSNAME</a>));
<a name="l00183"></a>00183         <span class="keywordflow">if</span> (names == NULL) {
<a name="l00184"></a>00184             fprintf (stderr, <span class="stringliteral">"malloc failed for cgns name list\n"</span>);
<a name="l00185"></a>00185             exit (1);
<a name="l00186"></a>00186         }
<a name="l00187"></a>00187         *maxcnt = cnt;
<a name="l00188"></a>00188         *namelist = names;
<a name="l00189"></a>00189     }
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 <span class="comment">/*=======================================================================*/</span>
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="preprocessor">#ifdef CG_MAX_GOTO_DEPTH</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span><span class="preprocessor"># define MAX_GOTO_DEPTH CG_MAX_GOTO_DEPTH</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00197"></a><a class="code" href="cgnscheck_8c.html#f02e4cb5a7ddaa37685e8c0c0c0b5406">00197</a> <span class="preprocessor"></span><span class="preprocessor"># define MAX_GOTO_DEPTH 20</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00199"></a>00199 <span class="preprocessor"></span>
<a name="l00200"></a>00200 <span class="keyword">static</span> <span class="keywordtype">char</span> goLabel[<a class="code" href="cgnscheck_8c.html#f02e4cb5a7ddaa37685e8c0c0c0b5406">MAX_GOTO_DEPTH</a>][33];
<a name="l00201"></a>00201 <span class="keyword">static</span> <span class="keywordtype">int</span> goIndex[<a class="code" href="cgnscheck_8c.html#f02e4cb5a7ddaa37685e8c0c0c0b5406">MAX_GOTO_DEPTH</a>];
<a name="l00202"></a>00202 <span class="keyword">static</span> <span class="keywordtype">int</span> goDepth = 0;
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 <span class="keyword">static</span> <span class="keywordtype">void</span> goto_node ()
<a name="l00207"></a>00207 {
<a name="l00208"></a>00208     <span class="keywordtype">int</span> n, ier;
<a name="l00209"></a>00209     <span class="keywordtype">char</span> *labels[<a class="code" href="cgnscheck_8c.html#f02e4cb5a7ddaa37685e8c0c0c0b5406">MAX_GOTO_DEPTH</a>];
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="preprocessor">#if CGNS_VERSION &gt;= 2500</span>
<a name="l00212"></a>00212 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (n = 0; n &lt; goDepth; n++)
<a name="l00213"></a>00213         labels[n] = goLabel[n];
<a name="l00214"></a>00214 <span class="preprocessor"># if CGNS_VERSION &gt; 2500</span>
<a name="l00215"></a>00215 <span class="preprocessor"></span>    ier = <a class="code" href="cgnslib_8c.html#d7bfb7bca9bef4c134a95db1748e0556">cg_golist</a> (cgnsfn, cgnsbase, goDepth, labels, goIndex);
<a name="l00216"></a>00216     <span class="keywordflow">if</span> (ier) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_golist"</span>);
<a name="l00217"></a>00217 <span class="preprocessor"># else</span>
<a name="l00218"></a>00218 <span class="preprocessor"></span>    ier = <a class="code" href="cgns__header_8h.html#570493b36739d61c8b43a4c5e11c48d7">cgi_get_posit</a>(cgnsfn, cgnsbase, goDepth, goIndex, labels);
<a name="l00219"></a>00219     <span class="keywordflow">if</span> (ier) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cgi_get_posit"</span>);
<a name="l00220"></a>00220 <span class="preprocessor"># endif</span>
<a name="l00221"></a>00221 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00222"></a>00222 <span class="preprocessor"></span>    <a class="code" href="cgns__header_8h.html#9aefb3fb2179957b84774f80fc7ca76a">posit_base</a> = cgnsbase;
<a name="l00223"></a>00223     <a class="code" href="cgns__header_8h.html#ebd0971a3f05d514c15194a9a9d08617">posit_zone</a> = 0;
<a name="l00224"></a>00224     <span class="keywordflow">for</span> (n = 0; n &lt; goDepth; n++) {
<a name="l00225"></a>00225         labels[n] = goLabel[n];
<a name="l00226"></a>00226         <span class="keywordflow">if</span> (strcmp (goLabel[n], <span class="stringliteral">"Zone_t"</span>) == 0)
<a name="l00227"></a>00227             <a class="code" href="cgns__header_8h.html#ebd0971a3f05d514c15194a9a9d08617">posit_zone</a> = goIndex[n];
<a name="l00228"></a>00228     }
<a name="l00229"></a>00229 
<a name="l00230"></a>00230     <span class="keywordflow">if</span> (goDepth == 0)
<a name="l00231"></a>00231         strcpy (posit_label, <span class="stringliteral">"CGNSBase_t"</span>);
<a name="l00232"></a>00232     <span class="keywordflow">else</span>
<a name="l00233"></a>00233         strcpy (posit_label, goLabel[goDepth-1]);
<a name="l00234"></a>00234 
<a name="l00235"></a>00235     <a class="code" href="cgns__header_8h.html#137839be8362795fe24c705c6aaecf7a">posit</a> = <a class="code" href="cgns__header_8h.html#570493b36739d61c8b43a4c5e11c48d7">cgi_get_posit</a> (cgnsfn, cgnsbase, goDepth, goIndex, labels, &amp;ier);
<a name="l00236"></a>00236     <span class="keywordflow">if</span> (ier) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cgi_get_posit"</span>);
<a name="l00237"></a>00237 <span class="preprocessor">#endif</span>
<a name="l00238"></a>00238 <span class="preprocessor"></span>}
<a name="l00239"></a>00239 
<a name="l00240"></a>00240 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00241"></a>00241 
<a name="l00242"></a>00242 <span class="keyword">static</span> <span class="keywordtype">void</span> go_absolute (<span class="keywordtype">char</span> *dsname, ...)
<a name="l00243"></a>00243 {
<a name="l00244"></a>00244     <span class="keywordtype">int</span> num;
<a name="l00245"></a>00245     <span class="keywordtype">char</span> *<a class="code" href="_a_d_f__internals_8h.html#d77bc5a56341df5017c60d789a10e95a">name</a> = dsname;
<a name="l00246"></a>00246     va_list arg;
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     va_start (arg, dsname);
<a name="l00249"></a>00249     goDepth = 0;
<a name="l00250"></a>00250     <span class="keywordflow">while</span> (name != NULL) {
<a name="l00251"></a>00251         num = va_arg (arg, <span class="keywordtype">int</span>);
<a name="l00252"></a>00252         <span class="keywordflow">if</span> (goDepth == <a class="code" href="cgnscheck_8c.html#f02e4cb5a7ddaa37685e8c0c0c0b5406">MAX_GOTO_DEPTH</a>) {
<a name="l00253"></a>00253             fprintf (stderr, <span class="stringliteral">"maximum depth of goto exceeded\n"</span>);
<a name="l00254"></a>00254             exit (1);
<a name="l00255"></a>00255         }
<a name="l00256"></a>00256         strncpy (goLabel[goDepth], name, 32);
<a name="l00257"></a>00257         goLabel[goDepth][32] = 0;
<a name="l00258"></a>00258         goIndex[goDepth] = num;
<a name="l00259"></a>00259         goDepth++;
<a name="l00260"></a>00260         name = va_arg (arg, <span class="keywordtype">char</span> *);
<a name="l00261"></a>00261     }
<a name="l00262"></a>00262     va_end (arg);
<a name="l00263"></a>00263     goto_node();
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="keyword">static</span> <span class="keywordtype">void</span> go_relative (<span class="keywordtype">char</span> *dsname, ...)
<a name="l00269"></a>00269 {
<a name="l00270"></a>00270     <span class="keywordtype">int</span> num;
<a name="l00271"></a>00271     <span class="keywordtype">char</span> *name = dsname;
<a name="l00272"></a>00272     va_list arg;
<a name="l00273"></a>00273 
<a name="l00274"></a>00274     va_start (arg, dsname);
<a name="l00275"></a>00275     <span class="keywordflow">while</span> (name != NULL) {
<a name="l00276"></a>00276         num = va_arg (arg, <span class="keywordtype">int</span>);
<a name="l00277"></a>00277         <span class="keywordflow">if</span> (num &lt; 1) <span class="keywordflow">break</span>;
<a name="l00278"></a>00278         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">".."</span>)) {
<a name="l00279"></a>00279             goDepth -= num;
<a name="l00280"></a>00280             <span class="keywordflow">if</span> (goDepth &lt; 0) goDepth = 0;
<a name="l00281"></a>00281         }
<a name="l00282"></a>00282         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">"."</span>)) {
<a name="l00283"></a>00283             <span class="keywordflow">if</span> (goDepth == <a class="code" href="cgnscheck_8c.html#f02e4cb5a7ddaa37685e8c0c0c0b5406">MAX_GOTO_DEPTH</a>) {
<a name="l00284"></a>00284                 fprintf (stderr, <span class="stringliteral">"maximum depth of goto exceeded\n"</span>);
<a name="l00285"></a>00285                 exit (1);
<a name="l00286"></a>00286             }
<a name="l00287"></a>00287             strncpy (goLabel[goDepth], name, 32);
<a name="l00288"></a>00288             goLabel[goDepth][32] = 0;
<a name="l00289"></a>00289             goIndex[goDepth++] = num;
<a name="l00290"></a>00290         }
<a name="l00291"></a>00291         name = va_arg (arg, <span class="keywordtype">char</span> *);
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293     va_end (arg);
<a name="l00294"></a>00294     goto_node();
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 <span class="comment">/*=======================================================================*/</span>
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 <span class="keyword">static</span> <span class="keywordtype">int</span> check_node (<span class="keywordtype">char</span> *<a class="code" href="_a_d_f__internals_8h.html#363d93fb13f0f235ae88ade1b5d17180">label</a>) {
<a name="l00300"></a>00300     <span class="keywordtype">int</span> nchild;
<a name="l00301"></a>00301     <span class="keywordtype">double</span> pid, *ids;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303     <span class="keywordflow">if</span> (<a class="code" href="cgns__header_8h.html#dfcc6b9f463371c7fbfb6a9e7307f39a">cgi_posit_id</a> (&amp;pid)) <span class="keywordflow">return</span> <a class="code" href="cgns_keywords_8h.html#f34da5a9fd67b522360a8306b019df34">CG_ERROR</a>;
<a name="l00304"></a>00304     <span class="keywordflow">if</span> (<a class="code" href="cgns__header_8h.html#cfe07fe84e10d6657edf3bad58a71787">cgi_get_nodes</a> (pid, label, &amp;nchild, &amp;ids)) <span class="keywordflow">return</span> <a class="code" href="cgns_keywords_8h.html#f34da5a9fd67b522360a8306b019df34">CG_ERROR</a>;
<a name="l00305"></a>00305     <span class="keywordflow">if</span> (nchild) {
<a name="l00306"></a>00306         <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (ids);
<a name="l00307"></a>00307         <span class="keywordflow">return</span> <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>;
<a name="l00308"></a>00308     }
<a name="l00309"></a>00309     <span class="keywordflow">return</span> <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>;
<a name="l00310"></a>00310 }
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="keyword">static</span> <span class="keywordtype">int</span> read_gridlocation (<a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> *location)
<a name="l00315"></a>00315 {
<a name="l00316"></a>00316     <span class="keywordtype">int</span> ierr = check_node (<span class="stringliteral">"GridLocation_t"</span>);
<a name="l00317"></a>00317     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>)
<a name="l00318"></a>00318         <span class="keywordflow">return</span> <a class="code" href="cgnslib_8c.html#924d62e01c9e8c11e0f45a1e2b2cfdba">cg_gridlocation_read</a> (location);
<a name="l00319"></a>00319     <span class="keywordflow">return</span> ierr;
<a name="l00320"></a>00320 }
<a name="l00321"></a>00321 
<a name="l00322"></a>00322 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00323"></a>00323 
<a name="l00324"></a>00324 <span class="keyword">static</span> <span class="keywordtype">int</span> read_ordinal (<span class="keywordtype">int</span> *ordinal)
<a name="l00325"></a>00325 {
<a name="l00326"></a>00326     <span class="keywordtype">int</span> ierr = check_node (<span class="stringliteral">"Ordinal_t"</span>);
<a name="l00327"></a>00327     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>)
<a name="l00328"></a>00328         <span class="keywordflow">return</span> <a class="code" href="cgnslib_8c.html#663f6eaf3674e7545b12704558f5b259">cg_ordinal_read</a> (ordinal);
<a name="l00329"></a>00329     <span class="keywordflow">return</span> ierr;
<a name="l00330"></a>00330 }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 <span class="keyword">static</span> <span class="keywordtype">int</span> read_rind (<span class="keywordtype">int</span> *<a class="code" href="write__rind_8c.html#2566aacf797b3ab4ba9a41d425d41551">rind</a>)
<a name="l00335"></a>00335 {
<a name="l00336"></a>00336     <span class="keywordtype">int</span> ierr = check_node (<span class="stringliteral">"Rind_t"</span>);
<a name="l00337"></a>00337     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>)
<a name="l00338"></a>00338         <span class="keywordflow">return</span> <a class="code" href="cgnslib_8c.html#80b999f7443d66926f8bee6666c6fb3c">cg_rind_read</a> (rind);
<a name="l00339"></a>00339     <span class="keywordflow">return</span> ierr;
<a name="l00340"></a>00340 }
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 <span class="keyword">static</span> <span class="keywordtype">int</span> check_interpolants (<span class="keywordtype">void</span>)
<a name="l00345"></a>00345 {
<a name="l00346"></a>00346     <span class="keywordtype">int</span> n, na, ndim, <a class="code" href="_a_d_f__internals_8h.html#c51040a8258f439eeb44220688762801">dims</a>[12];
<a name="l00347"></a>00347     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> dtype;
<a name="l00348"></a>00348     <span class="keywordtype">char</span> name[33];
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;na)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_narrays"</span>);
<a name="l00351"></a>00351     <span class="keywordflow">for</span> (n = 1; n &lt;= na; n++) {
<a name="l00352"></a>00352         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;dtype, &amp;ndim, dims))
<a name="l00353"></a>00353             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_array_info"</span>);
<a name="l00354"></a>00354         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"InterpolantsDonor"</span>)) <span class="keywordflow">return</span> 1;
<a name="l00355"></a>00355     }
<a name="l00356"></a>00356     <span class="keywordflow">return</span> 0;
<a name="l00357"></a>00357 }
<a name="l00358"></a>00358 
<a name="l00359"></a>00359 <span class="comment">/*=======================================================================*/</span>
<a name="l00360"></a>00360 
<a name="l00361"></a>00361 <span class="keyword">static</span> <span class="keywordtype">char</span> *temporary_file (<span class="keywordtype">char</span> *basename)
<a name="l00362"></a>00362 {
<a name="l00363"></a>00363     <span class="keywordtype">char</span> *p, *temp;
<a name="l00364"></a>00364     <span class="keywordtype">int</span> n;
<a name="l00365"></a>00365 
<a name="l00366"></a>00366     <span class="keywordflow">if</span> (basename == NULL || !*basename)
<a name="l00367"></a>00367         basename = <span class="stringliteral">"cgnstmpfile"</span>;
<a name="l00368"></a>00368     n = strlen (basename);
<a name="l00369"></a>00369     temp = (<span class="keywordtype">char</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (n + 10);
<a name="l00370"></a>00370     <span class="keywordflow">if</span> (temp == NULL) {
<a name="l00371"></a>00371         fprintf (stderr, <span class="stringliteral">"malloc failed for temp filename\n"</span>);
<a name="l00372"></a>00372         exit (1);
<a name="l00373"></a>00373     }
<a name="l00374"></a>00374     sprintf (temp, <span class="stringliteral">"%s.tmp"</span>, basename);
<a name="l00375"></a>00375     p = temp + strlen(temp);
<a name="l00376"></a>00376     <span class="keywordflow">for</span> (n = 0; n &lt; 1000; n++) {
<a name="l00377"></a>00377         sprintf (p, <span class="stringliteral">"%3.3d~"</span>, n);
<a name="l00378"></a>00378         <span class="keywordflow">if</span> (access (temp, 0)) <span class="keywordflow">return</span> temp;
<a name="l00379"></a>00379     }
<a name="l00380"></a>00380     fprintf (stderr, <span class="stringliteral">"failed to create temporary filename\n"</span>);
<a name="l00381"></a>00381     exit (1);
<a name="l00382"></a>00382 }
<a name="l00383"></a>00383 
<a name="l00384"></a>00384 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 <span class="keyword">static</span> <span class="keywordtype">void</span> copy_file (<span class="keywordtype">char</span> *oldfile, <span class="keywordtype">char</span> *newfile)
<a name="l00387"></a>00387 {
<a name="l00388"></a>00388     <span class="keywordtype">int</span> c;
<a name="l00389"></a>00389     FILE *oldfp, *newfp;
<a name="l00390"></a>00390 
<a name="l00391"></a>00391     <span class="keywordflow">if</span> (NULL == (oldfp = fopen (oldfile, <span class="stringliteral">"rb"</span>))) {
<a name="l00392"></a>00392         fprintf (stderr, <span class="stringliteral">"error opening input file for reading\n"</span>);
<a name="l00393"></a>00393         exit (1);
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395     <span class="keywordflow">if</span> (NULL == (newfp = fopen (newfile, <span class="stringliteral">"w+b"</span>))) {
<a name="l00396"></a>00396         fclose (oldfp);
<a name="l00397"></a>00397         fprintf (stderr, <span class="stringliteral">"error opening output file for writing\n"</span>);
<a name="l00398"></a>00398         exit (1);
<a name="l00399"></a>00399     }
<a name="l00400"></a>00400     <span class="keywordflow">while</span> (EOF != (c = getc (oldfp)))
<a name="l00401"></a>00401         putc (c, newfp);
<a name="l00402"></a>00402     fclose (oldfp);
<a name="l00403"></a>00403     fclose (newfp);
<a name="l00404"></a>00404 }
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00407"></a>00407 
<a name="l00408"></a>00408 <span class="keyword">static</span> <span class="keywordtype">char</span> *update_version (<span class="keywordtype">char</span> *cgnsfile, <span class="keywordtype">char</span> *outfile)
<a name="l00409"></a>00409 {
<a name="l00410"></a>00410     <span class="keywordtype">char</span> *tempfile;
<a name="l00411"></a>00411     <span class="keywordtype">float</span> file_version;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     <span class="keywordflow">if</span> (verbose) {
<a name="l00414"></a>00414         puts (<span class="stringliteral">"checking file version"</span>);
<a name="l00415"></a>00415         fflush (stdout);
<a name="l00416"></a>00416     }
<a name="l00417"></a>00417     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2955a491a7a66eeba1892453e3d95466">cg_open</a> (cgnsfile, <a class="code" href="cgns_keywords_8h.html#eca03512ad78c691a2015799ba394b46">CG_MODE_READ</a>, &amp;cgnsfn) ||
<a name="l00418"></a>00418         <a class="code" href="cgnslib_8c.html#0f6ad489630fca6ed6e0057cc7699d4b">cg_version</a> (cgnsfn, &amp;file_version) ||
<a name="l00419"></a>00419         <a class="code" href="cgnslib_8c.html#6ddf0a34d741c920b84d52e341ffc533">cg_close</a> (cgnsfn))
<a name="l00420"></a>00420         <a class="code" href="cgns__error_8c.html#e2f6b1f2d14633ad0450a23b2883b86a">cg_error_exit</a> ();
<a name="l00421"></a>00421     <span class="keywordflow">if</span> (LibraryVersion &lt;= (<span class="keywordtype">int</span>)(file_version * 1000.0 + 0.5)) {
<a name="l00422"></a>00422         puts (<span class="stringliteral">"file version is current"</span>);
<a name="l00423"></a>00423         <span class="keywordflow">return</span> cgnsfile;
<a name="l00424"></a>00424     }
<a name="l00425"></a>00425     <span class="keywordflow">if</span> (verbose) {
<a name="l00426"></a>00426         printf (<span class="stringliteral">"creating a working copy of %s\n"</span>, cgnsfile);
<a name="l00427"></a>00427         fflush (stdout);
<a name="l00428"></a>00428     }
<a name="l00429"></a>00429     tempfile = temporary_file (cgnsfile);
<a name="l00430"></a>00430     copy_file (cgnsfile, tempfile);
<a name="l00431"></a>00431     <span class="keywordflow">if</span> (verbose) {
<a name="l00432"></a>00432         printf (<span class="stringliteral">"updating version number for %s\n"</span>, tempfile);
<a name="l00433"></a>00433         fflush (stdout);
<a name="l00434"></a>00434     }
<a name="l00435"></a>00435     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2955a491a7a66eeba1892453e3d95466">cg_open</a> (tempfile, <a class="code" href="cgns_keywords_8h.html#a3eda4df29cceb4ed9a9c5d5d8f663d7">CG_MODE_MODIFY</a>, &amp;cgnsfn) || <a class="code" href="cgnslib_8c.html#6ddf0a34d741c920b84d52e341ffc533">cg_close</a> (cgnsfn)) {
<a name="l00436"></a>00436         unlink (tempfile);
<a name="l00437"></a>00437         <a class="code" href="cgns__error_8c.html#e2f6b1f2d14633ad0450a23b2883b86a">cg_error_exit</a> ();
<a name="l00438"></a>00438     }
<a name="l00439"></a>00439     <span class="keywordflow">if</span> (NULL == outfile || !*outfile) outfile = cgnsfile;
<a name="l00440"></a>00440     <span class="keywordflow">if</span> (verbose) {
<a name="l00441"></a>00441         printf (<span class="stringliteral">"renaming %s -&gt; %s\n"</span>, tempfile, outfile);
<a name="l00442"></a>00442         fflush (stdout);
<a name="l00443"></a>00443     }
<a name="l00444"></a>00444     unlink (outfile);
<a name="l00445"></a>00445     <span class="keywordflow">if</span> (rename (tempfile, outfile)) {
<a name="l00446"></a>00446         fprintf (stderr, <span class="stringliteral">"rename %s -&gt; %s failed\n"</span>, tempfile, outfile);
<a name="l00447"></a>00447         exit (1);
<a name="l00448"></a>00448     }
<a name="l00449"></a>00449     <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (tempfile);
<a name="l00450"></a>00450     <span class="keywordflow">return</span> outfile;
<a name="l00451"></a>00451 }
<a name="l00452"></a>00452 
<a name="l00453"></a>00453 <span class="comment">/*===================================================================*/</span>
<a name="l00454"></a>00454 
<a name="l00455"></a>00455 <span class="keyword">static</span> <span class="keywordtype">int</span> sort_nodes (<span class="keyword">const</span> <span class="keywordtype">void</span> *n1, <span class="keyword">const</span> <span class="keywordtype">void</span> *n2)
<a name="l00456"></a>00456 {
<a name="l00457"></a>00457     <span class="keywordflow">return</span> (*((<span class="keywordtype">int</span> *)n1) - *((<span class="keywordtype">int</span> *)n2));
<a name="l00458"></a>00458 }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 <span class="comment">/*-------------------------------------------------------------------*/</span>
<a name="l00461"></a>00461 
<a name="l00462"></a>00462 <span class="keyword">static</span> <span class="keywordtype">int</span> compare_faces (<span class="keywordtype">void</span> *v1, <span class="keywordtype">void</span> *v2)
<a name="l00463"></a>00463 {
<a name="l00464"></a>00464     <span class="keywordtype">int</span> <a class="code" href="namespacefmain.html#c6f559daa4a4864f2449315176500469">i</a>;
<a name="l00465"></a>00465     <a class="code" href="struct_f_a_c_e.html">FACE</a> *f1 = (<a class="code" href="struct_f_a_c_e.html">FACE</a> *)v1;
<a name="l00466"></a>00466     <a class="code" href="struct_f_a_c_e.html">FACE</a> *f2 = (<a class="code" href="struct_f_a_c_e.html">FACE</a> *)v2;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468     <span class="keywordflow">if</span> (f1-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a> != f2-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>)
<a name="l00469"></a>00469         <span class="keywordflow">return</span> (f1-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a> - f2-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>);
<a name="l00470"></a>00470     <span class="keywordflow">for</span> (i = 0; i &lt; f1-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>; i++) {
<a name="l00471"></a>00471         <span class="keywordflow">if</span> (f1-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a>[i] != f2-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a>[i])
<a name="l00472"></a>00472             <span class="keywordflow">return</span> (f1-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a>[i] - f2-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a>[i]);
<a name="l00473"></a>00473     }
<a name="l00474"></a>00474     <span class="keywordflow">return</span> (0);
<a name="l00475"></a>00475 }
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 <span class="comment">/*-------------------------------------------------------------------*/</span>
<a name="l00478"></a>00478 
<a name="l00479"></a>00479 <span class="keyword">static</span> <span class="keywordtype">unsigned</span> hash_face (<span class="keywordtype">void</span> *v)
<a name="l00480"></a>00480 {
<a name="l00481"></a>00481     <a class="code" href="struct_f_a_c_e.html">FACE</a> *f = (<a class="code" href="struct_f_a_c_e.html">FACE</a> *)v;
<a name="l00482"></a>00482     <span class="keywordtype">int</span> n;
<a name="l00483"></a>00483     <span class="keywordtype">unsigned</span> hash = 0;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485     <span class="keywordflow">for</span> (n = 0; n &lt; f-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>; n++)
<a name="l00486"></a>00486         hash += (<span class="keywordtype">unsigned</span>)f-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a>[n];
<a name="l00487"></a>00487     <span class="keywordflow">return</span> (hash);
<a name="l00488"></a>00488 }
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 <span class="keyword">static</span> <span class="keywordtype">int</span> find_extnode (<a class="code" href="struct_z_o_n_e.html">ZONE</a> *z, <span class="keywordtype">int</span> node)
<a name="l00493"></a>00493 {
<a name="l00494"></a>00494     <span class="keywordtype">int</span> lo = 0, hi = z-&gt;<a class="code" href="struct_z_o_n_e.html#316acbd53e045949fbce31ae6f7366f1">nextnodes</a> - 1, mid;
<a name="l00495"></a>00495 
<a name="l00496"></a>00496     <span class="keywordflow">if</span> (node == z-&gt;<a class="code" href="struct_z_o_n_e.html#862b1a443066be8463b7b0c2bca06856">extnodes</a>[lo]) <span class="keywordflow">return</span> node;
<a name="l00497"></a>00497     <span class="keywordflow">if</span> (node == z-&gt;<a class="code" href="struct_z_o_n_e.html#862b1a443066be8463b7b0c2bca06856">extnodes</a>[hi]) <span class="keywordflow">return</span> node;
<a name="l00498"></a>00498     <span class="keywordflow">while</span> (lo &lt;= hi) {
<a name="l00499"></a>00499         mid = (lo + hi) &gt;&gt; 1;
<a name="l00500"></a>00500         <span class="keywordflow">if</span> (node == z-&gt;<a class="code" href="struct_z_o_n_e.html#862b1a443066be8463b7b0c2bca06856">extnodes</a>[mid]) <span class="keywordflow">return</span> node;
<a name="l00501"></a>00501         <span class="keywordflow">if</span> (node &lt; z-&gt;extnodes[mid])
<a name="l00502"></a>00502             hi = mid - 1;
<a name="l00503"></a>00503         <span class="keywordflow">else</span>
<a name="l00504"></a>00504             lo = mid + 1;
<a name="l00505"></a>00505     }
<a name="l00506"></a>00506 
<a name="l00507"></a>00507     <span class="keywordflow">return</span> 0;
<a name="l00508"></a>00508 }
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00511"></a>00511 
<a name="l00512"></a>00512 <span class="keyword">static</span> <span class="keywordtype">int</span> get_maxnode (<span class="keywordtype">void</span> *vface, <span class="keywordtype">void</span> *vmaxnode)
<a name="l00513"></a>00513 {
<a name="l00514"></a>00514     <a class="code" href="struct_f_a_c_e.html">FACE</a> *face = (<a class="code" href="struct_f_a_c_e.html">FACE</a> *)vface;
<a name="l00515"></a>00515     <span class="keywordtype">int</span> n, *maxnode = (<span class="keywordtype">int</span> *)vmaxnode;
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     <span class="keywordflow">for</span> (n = 0; n &lt; face-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>; n++) {
<a name="l00518"></a>00518         <span class="keywordflow">if</span> (*maxnode &lt; face-&gt;nodes[n]) *maxnode = face-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a>[n];
<a name="l00519"></a>00519     }
<a name="l00520"></a>00520     <span class="keywordflow">return</span> 0;
<a name="l00521"></a>00521 }
<a name="l00522"></a>00522 
<a name="l00523"></a>00523 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 <span class="keyword">static</span> <span class="keywordtype">int</span> get_extnodes (<span class="keywordtype">void</span> *vface, <span class="keywordtype">void</span> *vnodes)
<a name="l00526"></a>00526 {
<a name="l00527"></a>00527     <a class="code" href="struct_f_a_c_e.html">FACE</a> *face = (<a class="code" href="struct_f_a_c_e.html">FACE</a> *)vface;
<a name="l00528"></a>00528 
<a name="l00529"></a>00529     <span class="keywordflow">if</span> (face-&gt;<a class="code" href="struct_f_a_c_e.html#be2d58850d42470d1973f25924c00c47">e2</a> == 0) {
<a name="l00530"></a>00530         <span class="keywordtype">int</span> n, *nodes = (<span class="keywordtype">int</span> *)vnodes;
<a name="l00531"></a>00531         <span class="keywordflow">for</span> (n = 0; n &lt; face-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>; n++)
<a name="l00532"></a>00532             nodes[face-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a>[n]-1] = 1;
<a name="l00533"></a>00533     }
<a name="l00534"></a>00534     <span class="keywordflow">return</span> 0;
<a name="l00535"></a>00535 }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00538"></a>00538 
<a name="l00539"></a>00539 <span class="keyword">static</span> <span class="keywordtype">int</span> valid_face (<a class="code" href="struct_z_o_n_e.html">ZONE</a> *z, <span class="keywordtype">int</span> elem)
<a name="l00540"></a>00540 {
<a name="l00541"></a>00541     <span class="keywordtype">int</span> n, ns, nn, ne, *pe;
<a name="l00542"></a>00542     <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0">ElementType_t</a> type;
<a name="l00543"></a>00543 
<a name="l00544"></a>00544     <span class="keywordflow">for</span> (ns = 0; ns &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#dbfb774fafdb2da3e35a7de16db65c3c">nsets</a>; ns++) {
<a name="l00545"></a>00545         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> || z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a> == 0) <span class="keywordflow">continue</span>;
<a name="l00546"></a>00546         <span class="keywordflow">if</span> (elem &gt;= z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> &amp;&amp; elem &lt;= z-&gt;sets[ns].ie) {
<a name="l00547"></a>00547             type = z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a>;
<a name="l00548"></a>00548             pe = z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a>;
<a name="l00549"></a>00549             ne = elem - z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a>;
<a name="l00550"></a>00550 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000</span>
<a name="l00551"></a>00551 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac01f3d58ce15426b3793432128bf0332e1">NGON_n</a>) {
<a name="l00552"></a>00552                 <span class="keywordflow">for</span> (n = 0; n &lt; ne; n++) {
<a name="l00553"></a>00553                     nn = *pe++;
<a name="l00554"></a>00554                     pe += nn;
<a name="l00555"></a>00555                 }
<a name="l00556"></a>00556                 <span class="keywordflow">return</span> (*pe &lt; 3 ? 0 : 1);
<a name="l00557"></a>00557             }
<a name="l00558"></a>00558 <span class="preprocessor">#endif</span>
<a name="l00559"></a>00559 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac055c2b4d0f7ac387d0c7216f597dfacd3">MIXED</a>) {
<a name="l00560"></a>00560                 <span class="keywordflow">for</span> (n = 0; n &lt; ne; n++) {
<a name="l00561"></a>00561                     type = (<a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0">ElementType_t</a>)*pe++;
<a name="l00562"></a>00562                     <span class="keywordflow">if</span> (type &gt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac01f3d58ce15426b3793432128bf0332e1">NGON_n</a>) {
<a name="l00563"></a>00563                         nn = (int)(type - <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac01f3d58ce15426b3793432128bf0332e1">NGON_n</a>);
<a name="l00564"></a>00564                     }
<a name="l00565"></a>00565                     <span class="keywordflow">else</span> {
<a name="l00566"></a>00566                         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#e7291fb6c47f4ff621c022dc5522f48b">cg_npe</a> (type, &amp;nn) || nn &lt;= 0) <span class="keywordflow">return</span> 0;
<a name="l00567"></a>00567                     }
<a name="l00568"></a>00568                     pe += nn;
<a name="l00569"></a>00569                 }
<a name="l00570"></a>00570                 type = (<a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0">ElementType_t</a>)*pe;
<a name="l00571"></a>00571                 <span class="keywordflow">if</span> (type &gt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac01f3d58ce15426b3793432128bf0332e1">NGON_n</a>+3) <span class="keywordflow">return</span> 1;
<a name="l00572"></a>00572             }
<a name="l00573"></a>00573             <span class="keywordflow">if</span> (type &gt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0a0e5d91e4ed7ef55d759173086df2382">TRI_3</a> &amp;&amp; type &lt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0f38a9dc0e0d293d1293cdb706729aac4">QUAD_9</a>) <span class="keywordflow">return</span> 1;
<a name="l00574"></a>00574             <span class="keywordflow">return</span> 0;
<a name="l00575"></a>00575         }
<a name="l00576"></a>00576     }
<a name="l00577"></a>00577     <span class="keywordflow">return</span> 0;            
<a name="l00578"></a>00578 }
<a name="l00579"></a>00579 
<a name="l00580"></a>00580 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 <span class="keyword">static</span> <span class="keywordtype">int</span> *find_element (<a class="code" href="struct_z_o_n_e.html">ZONE</a> *z, <span class="keywordtype">int</span> elem, <span class="keywordtype">int</span> *dim, <span class="keywordtype">int</span> *nnodes)
<a name="l00583"></a>00583 {
<a name="l00584"></a>00584     <span class="keywordtype">int</span> ns, nn, ne, *nodes;
<a name="l00585"></a>00585     <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0">ElementType_t</a> type;
<a name="l00586"></a>00586 
<a name="l00587"></a>00587     <span class="keywordflow">for</span> (ns = 0; ns &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#dbfb774fafdb2da3e35a7de16db65c3c">nsets</a>; ns++) {
<a name="l00588"></a>00588         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a>) <span class="keywordflow">continue</span>;
<a name="l00589"></a>00589         <span class="keywordflow">if</span> (elem &gt;= z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> &amp;&amp; elem &lt;= z-&gt;sets[ns].ie) {
<a name="l00590"></a>00590             ne = elem - z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a>;
<a name="l00591"></a>00591             nodes = z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a>;
<a name="l00592"></a>00592             type = z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a>;
<a name="l00593"></a>00593 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000</span>
<a name="l00594"></a>00594 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac01f3d58ce15426b3793432128bf0332e1">NGON_n</a>) {
<a name="l00595"></a>00595                 <span class="keywordflow">while</span> (ne-- &gt; 0) {
<a name="l00596"></a>00596                     nn = *nodes++;
<a name="l00597"></a>00597                     nodes += nn;
<a name="l00598"></a>00598                 }
<a name="l00599"></a>00599                 *dim = 2;
<a name="l00600"></a>00600                 *nnodes = *nodes++;
<a name="l00601"></a>00601                 <span class="keywordflow">return</span> nodes;
<a name="l00602"></a>00602             }
<a name="l00603"></a>00603             <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0e0679c83d873c5c154531805e030a0f2">NFACE_n</a>) {
<a name="l00604"></a>00604                 <span class="keywordflow">while</span> (ne-- &gt; 0) {
<a name="l00605"></a>00605                     nn = *nodes++;
<a name="l00606"></a>00606                     nodes += nn;
<a name="l00607"></a>00607                 }
<a name="l00608"></a>00608                 *dim = 3;
<a name="l00609"></a>00609                 *nnodes = *nodes++;
<a name="l00610"></a>00610                 <span class="keywordflow">return</span> nodes;
<a name="l00611"></a>00611             }
<a name="l00612"></a>00612 <span class="preprocessor">#endif                </span>
<a name="l00613"></a>00613 <span class="preprocessor"></span>            <a class="code" href="cgnslib_8c.html#e7291fb6c47f4ff621c022dc5522f48b">cg_npe</a> (type, &amp;nn);
<a name="l00614"></a>00614             <span class="keywordflow">if</span> (nn) {
<a name="l00615"></a>00615                 nodes += (nn * ne);
<a name="l00616"></a>00616             }
<a name="l00617"></a>00617             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac055c2b4d0f7ac387d0c7216f597dfacd3">MIXED</a>) {
<a name="l00618"></a>00618                 type = *nodes++;
<a name="l00619"></a>00619                 <span class="keywordflow">while</span> (ne-- &gt; 0) {
<a name="l00620"></a>00620                     <span class="keywordflow">if</span> (type &gt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac01f3d58ce15426b3793432128bf0332e1">NGON_n</a>)
<a name="l00621"></a>00621                         nn = (int)(type - <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac01f3d58ce15426b3793432128bf0332e1">NGON_n</a>);
<a name="l00622"></a>00622                     <span class="keywordflow">else</span> {
<a name="l00623"></a>00623                         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#e7291fb6c47f4ff621c022dc5522f48b">cg_npe</a> (type, &amp;nn) || nn &lt;= 0)
<a name="l00624"></a>00624                             <span class="keywordflow">return</span> NULL;
<a name="l00625"></a>00625                     }
<a name="l00626"></a>00626                     nodes += nn;
<a name="l00627"></a>00627                     type = *nodes++;
<a name="l00628"></a>00628                 }
<a name="l00629"></a>00629             }
<a name="l00630"></a>00630             <span class="keywordflow">else</span> {
<a name="l00631"></a>00631                 <span class="keywordflow">return</span> NULL;
<a name="l00632"></a>00632             }
<a name="l00633"></a>00633             <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac059a889456a2d742fdca191dccb3e871d">NODE</a>)
<a name="l00634"></a>00634                 *dim = 0;
<a name="l00635"></a>00635             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type &lt; <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0a0e5d91e4ed7ef55d759173086df2382">TRI_3</a>)
<a name="l00636"></a>00636                 *dim = 1;
<a name="l00637"></a>00637             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type &lt; TETRA_4 || type &gt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac01f3d58ce15426b3793432128bf0332e1">NGON_n</a>)
<a name="l00638"></a>00638                 *dim = 2;
<a name="l00639"></a>00639             <span class="keywordflow">else</span> {
<a name="l00640"></a>00640                 *dim = 3;
<a name="l00641"></a>00641                 <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac06b670c8639798ee64f15ad1149162ac3">HEXA_27</a>) nn--;
<a name="l00642"></a>00642             }
<a name="l00643"></a>00643 <span class="preprocessor">#ifndef USE_MID_NODES</span>
<a name="l00644"></a>00644 <span class="preprocessor"></span>            <span class="keywordflow">switch</span> (type) {
<a name="l00645"></a>00645                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0f38a9dc0e0d293d1293cdb706729aac4">QUAD_9</a>:
<a name="l00646"></a>00646                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac02178b3d7df13f84dbc8002ac3a935772">PYRA_14</a>:
<a name="l00647"></a>00647                     nn--;
<a name="l00648"></a>00648                     <span class="keywordflow">break</span>;
<a name="l00649"></a>00649                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac050e8effdf2651e2c2894a300e5c5573d">PENTA_18</a>:
<a name="l00650"></a>00650                     nn -= 3;
<a name="l00651"></a>00651                     <span class="keywordflow">break</span>;
<a name="l00652"></a>00652                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac06b670c8639798ee64f15ad1149162ac3">HEXA_27</a>:
<a name="l00653"></a>00653                     nn -= 6;
<a name="l00654"></a>00654                     <span class="keywordflow">break</span>;
<a name="l00655"></a>00655             }
<a name="l00656"></a>00656 <span class="preprocessor">#endif            </span>
<a name="l00657"></a>00657 <span class="preprocessor"></span>            *nnodes = nn;
<a name="l00658"></a>00658             <span class="keywordflow">return</span> nodes;
<a name="l00659"></a>00659         }
<a name="l00660"></a>00660     }
<a name="l00661"></a>00661     <span class="keywordflow">return</span> NULL;
<a name="l00662"></a>00662 }
<a name="l00663"></a>00663 
<a name="l00664"></a>00664 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00665"></a>00665 
<a name="l00666"></a>00666 <span class="keyword">static</span> <a class="code" href="struct_f_a_c_e.html">FACE</a> *new_face (<span class="keywordtype">int</span> nnodes, <span class="keywordtype">int</span> *nodes)
<a name="l00667"></a>00667 {
<a name="l00668"></a>00668     <a class="code" href="struct_f_a_c_e.html">FACE</a> *f = (<a class="code" href="struct_f_a_c_e.html">FACE</a> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (<span class="keyword">sizeof</span>(<a class="code" href="struct_f_a_c_e.html">FACE</a>) + nnodes * <span class="keyword">sizeof</span>(int));
<a name="l00669"></a>00669     <span class="keywordflow">if</span> (f == NULL) {
<a name="l00670"></a>00670         fprintf (stderr, <span class="stringliteral">"malloc failed for a new face\n"</span>);
<a name="l00671"></a>00671         exit (1);
<a name="l00672"></a>00672     }
<a name="l00673"></a>00673     f-&gt;<a class="code" href="struct_f_a_c_e.html#31466fc672991029a5d7a12c53b6ad5f">e1</a> = f-&gt;<a class="code" href="struct_f_a_c_e.html#be2d58850d42470d1973f25924c00c47">e2</a> = f-&gt;<a class="code" href="struct_f_a_c_e.html#a75d52109f3f1fa6e40768b15db2814f">f1</a> = f-&gt;<a class="code" href="struct_f_a_c_e.html#4a0019706837babe79e30464d98c3575">f2</a> = 0;
<a name="l00674"></a>00674     f-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a> = nnodes;
<a name="l00675"></a>00675     f-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a> = (<span class="keywordtype">int</span> *)(f + 1);
<a name="l00676"></a>00676     <span class="keywordflow">if</span> (nodes != NULL) {
<a name="l00677"></a>00677         <span class="keywordtype">int</span> n;
<a name="l00678"></a>00678         <span class="keywordflow">for</span> (n = 0; n &lt; nnodes; n++)
<a name="l00679"></a>00679             f-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a>[n] = nodes[n];
<a name="l00680"></a>00680         qsort (f-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a>, f-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), sort_nodes);
<a name="l00681"></a>00681     }
<a name="l00682"></a>00682     <span class="keywordflow">return</span> f;
<a name="l00683"></a>00683 }
<a name="l00684"></a>00684 
<a name="l00685"></a>00685 <span class="comment">/*-------------------------------------------------------------------*/</span>
<a name="l00686"></a>00686 
<a name="l00687"></a>00687 <span class="keyword">static</span> <span class="keywordtype">int</span> tetra_4[4][4] = {
<a name="l00688"></a>00688     {3, 0, 2, 1},
<a name="l00689"></a>00689     {3, 0, 1, 3},
<a name="l00690"></a>00690     {3, 1, 2, 3},
<a name="l00691"></a>00691     {3, 2, 0, 3}
<a name="l00692"></a>00692 };
<a name="l00693"></a>00693 <span class="keyword">static</span> <span class="keywordtype">int</span> tetra_10[4][7] = {
<a name="l00694"></a>00694     {6, 0, 6, 2, 5, 1, 4},
<a name="l00695"></a>00695     {6, 0, 4, 1, 8, 3, 7},
<a name="l00696"></a>00696     {6, 1, 5, 2, 9, 3, 8},
<a name="l00697"></a>00697     {6, 2, 6, 0, 7, 3, 9}
<a name="l00698"></a>00698 };
<a name="l00699"></a>00699 <span class="keyword">static</span> <span class="keywordtype">int</span> pyra_5[5][5] = {
<a name="l00700"></a>00700     {4, 0, 3, 2, 1},
<a name="l00701"></a>00701     {3, 0, 1, 4, 0},
<a name="l00702"></a>00702     {3, 1, 2, 4, 0},
<a name="l00703"></a>00703     {3, 2, 3, 4, 0},
<a name="l00704"></a>00704     {3, 3, 0, 4, 0}
<a name="l00705"></a>00705 };
<a name="l00706"></a>00706 <span class="keyword">static</span> <span class="keywordtype">int</span> pyra_13[5][9] = {
<a name="l00707"></a>00707     {8, 0, 8, 3, 7, 2, 6, 1, 5},
<a name="l00708"></a>00708     {6, 0, 5, 1, 10, 4, 9, 0, 0},
<a name="l00709"></a>00709     {6, 1, 6, 2, 11, 4, 10, 0, 0},
<a name="l00710"></a>00710     {6, 2, 7, 3, 12, 4, 11, 0, 0},
<a name="l00711"></a>00711     {6, 3, 8, 0, 9, 4, 12, 0, 0}
<a name="l00712"></a>00712 };
<a name="l00713"></a>00713 <span class="keyword">static</span> <span class="keywordtype">int</span> pyra_14[5][10] = {
<a name="l00714"></a>00714     {9, 0, 8, 3, 7, 2, 6, 1, 5, 13},
<a name="l00715"></a>00715     {6, 0, 5, 1, 10, 4, 9, 0, 0, 0},
<a name="l00716"></a>00716     {6, 1, 6, 2, 11, 4, 10, 0, 0, 0},
<a name="l00717"></a>00717     {6, 2, 7, 3, 12, 4, 11, 0, 0, 0},
<a name="l00718"></a>00718     {6, 3, 8, 0, 9, 4, 12, 0, 0, 0}
<a name="l00719"></a>00719 };
<a name="l00720"></a>00720 <span class="keyword">static</span> <span class="keywordtype">int</span> penta_6[5][5] = {
<a name="l00721"></a>00721     {4, 0, 1, 4, 3},
<a name="l00722"></a>00722     {4, 1, 2, 5, 4},
<a name="l00723"></a>00723     {4, 2, 0, 3, 5},
<a name="l00724"></a>00724     {3, 0, 2, 1, 0},
<a name="l00725"></a>00725     {3, 3, 4, 5, 0},
<a name="l00726"></a>00726 };
<a name="l00727"></a>00727 <span class="keyword">static</span> <span class="keywordtype">int</span> penta_15[5][9] = {
<a name="l00728"></a>00728     {8, 0, 6, 1, 10, 4, 12, 3, 9},
<a name="l00729"></a>00729     {8, 1, 7, 2, 11, 5, 13, 4, 10},
<a name="l00730"></a>00730     {8, 2, 8, 0, 9, 3, 14, 5, 11},
<a name="l00731"></a>00731     {6, 0, 8, 2, 7, 1, 6, 0, 0},
<a name="l00732"></a>00732     {6, 3, 12, 4, 13, 5, 14, 0, 0},
<a name="l00733"></a>00733 };
<a name="l00734"></a>00734 <span class="keyword">static</span> <span class="keywordtype">int</span> penta_18[5][10] = {
<a name="l00735"></a>00735     {9, 0, 6, 1, 10, 4, 12, 3, 9, 15},
<a name="l00736"></a>00736     {9, 1, 7, 2, 11, 5, 13, 4, 10, 16},
<a name="l00737"></a>00737     {9, 2, 8, 0, 9, 3, 14, 5, 11, 17},
<a name="l00738"></a>00738     {6, 0, 8, 2, 7, 1, 6, 0, 0, 0},
<a name="l00739"></a>00739     {6, 3, 12, 4, 13, 5, 14, 0, 0, 0},
<a name="l00740"></a>00740 };
<a name="l00741"></a>00741 <span class="keyword">static</span> <span class="keywordtype">int</span> hexa_8[6][5] = {
<a name="l00742"></a>00742     {4, 0, 3, 2, 1},
<a name="l00743"></a>00743     {4, 0, 1, 5, 4},
<a name="l00744"></a>00744     {4, 1, 2, 6, 5},
<a name="l00745"></a>00745     {4, 2, 3, 7, 6},
<a name="l00746"></a>00746     {4, 0, 4, 7, 3},
<a name="l00747"></a>00747     {4, 4, 5, 6, 7}
<a name="l00748"></a>00748 };
<a name="l00749"></a>00749 <span class="keyword">static</span> <span class="keywordtype">int</span> hexa_20[6][9] = {
<a name="l00750"></a>00750     {8, 0, 11, 3, 10, 2, 9, 1, 8},
<a name="l00751"></a>00751     {8, 0, 8, 1, 13, 5, 16, 4, 12},
<a name="l00752"></a>00752     {8, 1, 9, 2, 14, 6, 17, 5, 13},
<a name="l00753"></a>00753     {8, 2, 10, 3, 15, 7, 18, 6, 14},
<a name="l00754"></a>00754     {8, 0, 12, 4, 19, 7, 15, 3, 11},
<a name="l00755"></a>00755     {8, 4, 16, 5, 17, 6, 18, 7, 19}
<a name="l00756"></a>00756 };
<a name="l00757"></a>00757 <span class="keyword">static</span> <span class="keywordtype">int</span> hexa_27[6][10] = {
<a name="l00758"></a>00758     {9, 0, 11, 3, 10, 2, 9, 1, 8, 20},
<a name="l00759"></a>00759     {9, 0, 8, 1, 13, 5, 16, 4, 12, 21},
<a name="l00760"></a>00760     {9, 1, 9, 2, 14, 6, 17, 5, 13, 22},
<a name="l00761"></a>00761     {9, 2, 10, 3, 15, 7, 18, 6, 14, 23},
<a name="l00762"></a>00762     {9, 0, 12, 4, 19, 7, 15, 3, 11, 24},
<a name="l00763"></a>00763     {9, 4, 16, 5, 17, 6, 18, 7, 19, 25}
<a name="l00764"></a>00764 };
<a name="l00765"></a>00765 
<a name="l00766"></a>00766 <span class="keyword">static</span> <a class="code" href="struct_f_a_c_e.html">FACE</a> *element_face (<a class="code" href="struct_z_o_n_e.html">ZONE</a> *z, <span class="keywordtype">int</span> fnum, <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0">ElementType_t</a> type, <span class="keywordtype">int</span> *nodes)
<a name="l00767"></a>00767 {
<a name="l00768"></a>00768     <span class="keywordtype">int</span> n, *nodemap;
<a name="l00769"></a>00769     <a class="code" href="struct_f_a_c_e.html">FACE</a> *face;
<a name="l00770"></a>00770 
<a name="l00771"></a>00771 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000</span>
<a name="l00772"></a>00772 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0e0679c83d873c5c154531805e030a0f2">NFACE_n</a>) {
<a name="l00773"></a>00773         <span class="keywordtype">int</span> dim;
<a name="l00774"></a>00774         nodemap = find_element (z, nodes[fnum], &amp;dim, &amp;n);
<a name="l00775"></a>00775         <span class="keywordflow">if</span> (nodemap == NULL || dim != 2) {
<a name="l00776"></a>00776             fprintf (stderr, <span class="stringliteral">"INTERNAL:find_element returned invalid face\n"</span>);
<a name="l00777"></a>00777             exit (1);
<a name="l00778"></a>00778         }
<a name="l00779"></a>00779         <span class="keywordflow">return</span> new_face (n, nodemap);
<a name="l00780"></a>00780     }
<a name="l00781"></a>00781 <span class="preprocessor">#endif        </span>
<a name="l00782"></a>00782 <span class="preprocessor"></span>    <span class="keywordflow">switch</span> (type) {
<a name="l00783"></a>00783         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0b16b907138ae88e28d55fe2c22e5cac1">TETRA_4</a>:
<a name="l00784"></a>00784             nodemap = tetra_4[fnum];
<a name="l00785"></a>00785             <span class="keywordflow">break</span>;
<a name="l00786"></a>00786         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac054a46a21a53a01d088adb91926421d22">TETRA_10</a>:
<a name="l00787"></a>00787             nodemap = tetra_10[fnum];
<a name="l00788"></a>00788             <span class="keywordflow">break</span>;
<a name="l00789"></a>00789         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac08537f8dc3d6cd80c33664691d7ad372d">PYRA_5</a>:
<a name="l00790"></a>00790             nodemap = pyra_5[fnum];
<a name="l00791"></a>00791             <span class="keywordflow">break</span>;
<a name="l00792"></a>00792 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000</span>
<a name="l00793"></a>00793 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0ccf89d85716a35617b1d5e916a174671">PYRA_13</a>:
<a name="l00794"></a>00794             nodemap = pyra_13[fnum];
<a name="l00795"></a>00795             <span class="keywordflow">break</span>;
<a name="l00796"></a>00796 <span class="preprocessor">#endif                                </span>
<a name="l00797"></a>00797 <span class="preprocessor"></span>        <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac02178b3d7df13f84dbc8002ac3a935772">PYRA_14</a>:
<a name="l00798"></a>00798 <span class="preprocessor">#ifdef USE_MID_NODES</span>
<a name="l00799"></a>00799 <span class="preprocessor"></span>            nodemap = pyra_14[fnum];
<a name="l00800"></a>00800 <span class="preprocessor">#else</span>
<a name="l00801"></a>00801 <span class="preprocessor"></span>            nodemap = pyra_13[fnum];
<a name="l00802"></a>00802 <span class="preprocessor">#endif            </span>
<a name="l00803"></a>00803 <span class="preprocessor"></span>            <span class="keywordflow">break</span>;
<a name="l00804"></a>00804         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0bbb25bee7fa377ff218ee8bf316a2df3">PENTA_6</a>:
<a name="l00805"></a>00805             nodemap = penta_6[fnum];
<a name="l00806"></a>00806             <span class="keywordflow">break</span>;
<a name="l00807"></a>00807         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac060d3e37e1cbac08456510a2eabaf1071">PENTA_15</a>:
<a name="l00808"></a>00808             nodemap = penta_15[fnum];
<a name="l00809"></a>00809             <span class="keywordflow">break</span>;
<a name="l00810"></a>00810         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac050e8effdf2651e2c2894a300e5c5573d">PENTA_18</a>:
<a name="l00811"></a>00811 <span class="preprocessor">#ifdef USE_MID_NODES</span>
<a name="l00812"></a>00812 <span class="preprocessor"></span>            nodemap = penta_18[fnum];
<a name="l00813"></a>00813 <span class="preprocessor">#else</span>
<a name="l00814"></a>00814 <span class="preprocessor"></span>            nodemap = penta_15[fnum];
<a name="l00815"></a>00815 <span class="preprocessor">#endif            </span>
<a name="l00816"></a>00816 <span class="preprocessor"></span>            <span class="keywordflow">break</span>;
<a name="l00817"></a>00817         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac025f49e976a1bbc5dd2392ec2f07a8d5e">HEXA_8</a>:
<a name="l00818"></a>00818             nodemap = hexa_8[fnum];
<a name="l00819"></a>00819             <span class="keywordflow">break</span>;
<a name="l00820"></a>00820         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac031f92ed3834465899b4a02c158aae2a8">HEXA_20</a>:
<a name="l00821"></a>00821             nodemap = hexa_20[fnum];
<a name="l00822"></a>00822             <span class="keywordflow">break</span>;
<a name="l00823"></a>00823         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac06b670c8639798ee64f15ad1149162ac3">HEXA_27</a>:
<a name="l00824"></a>00824 <span class="preprocessor">#ifdef USE_MID_NODES        </span>
<a name="l00825"></a>00825 <span class="preprocessor"></span>            nodemap = hexa_27[fnum];
<a name="l00826"></a>00826 <span class="preprocessor">#else</span>
<a name="l00827"></a>00827 <span class="preprocessor"></span>            nodemap = hexa_20[fnum];
<a name="l00828"></a>00828 <span class="preprocessor">#endif            </span>
<a name="l00829"></a>00829 <span class="preprocessor"></span>            <span class="keywordflow">break</span>;
<a name="l00830"></a>00830         <span class="keywordflow">default</span>:
<a name="l00831"></a>00831             fprintf (stderr, <span class="stringliteral">"INTERNAL:invalid element type in element_face\n"</span>);
<a name="l00832"></a>00832             exit (1);
<a name="l00833"></a>00833     }
<a name="l00834"></a>00834     face = new_face (*nodemap++, NULL);
<a name="l00835"></a>00835     <span class="keywordflow">for</span> (n = 0; n &lt; face-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>; n++)
<a name="l00836"></a>00836         face-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a>[n] = nodes[nodemap[n]];
<a name="l00837"></a>00837     qsort (face-&gt;<a class="code" href="struct_f_a_c_e.html#3baa70ec5aa9904400db2d0d171965d1">nodes</a>, face-&gt;<a class="code" href="struct_f_a_c_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), sort_nodes);
<a name="l00838"></a>00838     <span class="keywordflow">return</span> face;        
<a name="l00839"></a>00839 }
<a name="l00840"></a>00840 
<a name="l00841"></a>00841 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00842"></a>00842 
<a name="l00843"></a>00843 <span class="keyword">static</span> <span class="keywordtype">int</span> compare_elemsets (<span class="keyword">const</span> <span class="keywordtype">void</span> *e1, <span class="keyword">const</span> <span class="keywordtype">void</span> *e2)
<a name="l00844"></a>00844 {
<a name="l00845"></a>00845     <span class="keywordflow">return</span> (((<a class="code" href="struct_e_l_e_m_s_e_t.html">ELEMSET</a> *)e1)-&gt;is - ((<a class="code" href="struct_e_l_e_m_s_e_t.html">ELEMSET</a> *)e2)-&gt;is);
<a name="l00846"></a>00846 }
<a name="l00847"></a>00847 
<a name="l00848"></a>00848 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l00849"></a>00849 
<a name="l00850"></a>00850 <span class="comment">/* FINISH - allow for CellDim = 2. May also want to read and save</span>
<a name="l00851"></a>00851 <span class="comment">   coordinates to check connectivities */</span>
<a name="l00852"></a>00852 
<a name="l00853"></a>00853 <span class="keyword">static</span> <span class="keywordtype">void</span> read_zone (<span class="keywordtype">int</span> nz)
<a name="l00854"></a>00854 {
<a name="l00855"></a>00855     <span class="keywordtype">char</span> name[33];
<a name="l00856"></a>00856     <span class="keywordtype">int</span> i, <a class="code" href="namespacefmain.html#3025f2b2bc0423c9a3a45cb7261e32eb">j</a>, n, <a class="code" href="write__bcdata_8c.html#a2950136f8c9d193ee20f9e64e5d3f43">size</a>[9];
<a name="l00857"></a>00857     <span class="keywordtype">int</span> ns, nsets, hasparent;
<a name="l00858"></a>00858     <span class="keywordtype">int</span> ne, nelem, *pe;
<a name="l00859"></a>00859     <span class="keywordtype">int</span> nn, nf, ip, type, ierr;
<a name="l00860"></a>00860     <span class="keywordtype">int</span> *nodes, maxnode;
<a name="l00861"></a>00861     <a class="code" href="struct_e_l_e_m_s_e_t.html">ELEMSET</a> *es;
<a name="l00862"></a>00862     <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe">ZoneType_t</a> zonetype;
<a name="l00863"></a>00863     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[nz++];
<a name="l00864"></a>00864     <a class="code" href="struct_f_a_c_e.html">FACE</a> *face, *pf;
<a name="l00865"></a>00865 
<a name="l00866"></a>00866     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#1c1bb65f85bc267b9dfeb71793f813ec">cg_zone_read</a> (cgnsfn, cgnsbase, nz, name, size))
<a name="l00867"></a>00867         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_zone_read"</span>);
<a name="l00868"></a>00868     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#ca913e5589d1d18ef8a8166d3afd01de">cg_zone_type</a> (cgnsfn, cgnsbase, nz, &amp;zonetype))
<a name="l00869"></a>00869         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_zone_type"</span>);
<a name="l00870"></a>00870 
<a name="l00871"></a>00871     printf (<span class="stringliteral">"reading zone \"%s\"\n"</span>, name);
<a name="l00872"></a>00872     fflush (stdout);
<a name="l00873"></a>00873 
<a name="l00874"></a>00874     strcpy (z-&gt;<a class="code" href="struct_z_o_n_e.html#7913ace0d483311647b8d88f795c6bfd">name</a>, name);
<a name="l00875"></a>00875     z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> = zonetype;
<a name="l00876"></a>00876     z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> = z-&gt;<a class="code" href="struct_z_o_n_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a> = 0;
<a name="l00877"></a>00877     z-&gt;<a class="code" href="struct_z_o_n_e.html#dbfb774fafdb2da3e35a7de16db65c3c">nsets</a> = z-&gt;<a class="code" href="struct_z_o_n_e.html#316acbd53e045949fbce31ae6f7366f1">nextnodes</a> = 0;
<a name="l00878"></a>00878     z-&gt;<a class="code" href="struct_z_o_n_e.html#ab6822646f9a53265acb577886434744">nv</a> = z-&gt;<a class="code" href="struct_z_o_n_e.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a> = z-&gt;<a class="code" href="struct_z_o_n_e.html#3bf1137663f19e5c361c845cf4dfb7db">ne</a> = z-&gt;<a class="code" href="struct_z_o_n_e.html#a440d0e525bda85d07f367d87d7dd86f">nn</a> = 0;
<a name="l00879"></a>00879     z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a> = NULL;
<a name="l00880"></a>00880 
<a name="l00881"></a>00881     <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)
<a name="l00882"></a>00882         <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
<a name="l00883"></a>00883             z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[j][i] = 0;
<a name="l00884"></a>00884 
<a name="l00885"></a>00885     if (zonetype == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a>) {
<a name="l00886"></a>00886         z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> = <a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a>;
<a name="l00887"></a>00887         <span class="keywordflow">for</span> (n = 0, j = 0; j &lt; 3; j++) {
<a name="l00888"></a>00888             <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a>; i++) {
<a name="l00889"></a>00889                 z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[j][i] = size[n++];
<a name="l00890"></a>00890             }
<a name="l00891"></a>00891         }
<a name="l00892"></a>00892     }
<a name="l00893"></a>00893     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (zonetype == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fedef7de5f4ce5345ffd8e2726df46e388">Unstructured</a>) {
<a name="l00894"></a>00894         z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> = 1;
<a name="l00895"></a>00895         <span class="keywordflow">for</span> (n = 0; n &lt; 3; n++)
<a name="l00896"></a>00896             z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[n][0] = size[n];
<a name="l00897"></a>00897     }
<a name="l00898"></a>00898     <span class="keywordflow">else</span> {
<a name="l00899"></a>00899         <span class="keywordflow">return</span>;
<a name="l00900"></a>00900     }
<a name="l00901"></a>00901 
<a name="l00902"></a>00902     <span class="keywordflow">for</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a> = 1, n = 0; n &lt; z-&gt;<a class="code" href="_a_d_f__internals_8h.html#f7e2cb66db87441e196776b2ae591e8b">idim</a>; n++)
<a name="l00903"></a>00903         z-&gt;<a class="code" href="struct_z_o_n_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a> *= z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][n];
<a name="l00904"></a>00904     z-&gt;<a class="code" href="struct_z_o_n_e.html#21d5307228ec77940b3f412681afeb68">maxnode</a> = z-&gt;<a class="code" href="struct_z_o_n_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>;
<a name="l00905"></a>00905 
<a name="l00906"></a>00906     <span class="comment">/* read element sets */</span>
<a name="l00907"></a>00907 
<a name="l00908"></a>00908     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#e550ccdd464166794b7ae8c68498f7c6">cg_nsections</a> (cgnsfn, cgnsbase, nz, &amp;nsets))
<a name="l00909"></a>00909         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_nsections"</span>);
<a name="l00910"></a>00910     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a>) {
<a name="l00911"></a>00911         <span class="keywordflow">if</span> (nsets)
<a name="l00912"></a>00912             warning (1, <span class="stringliteral">"element sets are not used with Structured grid"</span>);
<a name="l00913"></a>00913         <span class="keywordflow">return</span>;
<a name="l00914"></a>00914     }
<a name="l00915"></a>00915     <span class="keywordflow">if</span> (!nsets) {
<a name="l00916"></a>00916         <span class="keywordflow">if</span> (size[1]) error (<span class="stringliteral">"no element sets found"</span>);
<a name="l00917"></a>00917         <span class="keywordflow">return</span>;
<a name="l00918"></a>00918     }
<a name="l00919"></a>00919     z-&gt;<a class="code" href="struct_z_o_n_e.html#dbfb774fafdb2da3e35a7de16db65c3c">nsets</a> = nsets;
<a name="l00920"></a>00920     z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a> = (<a class="code" href="struct_e_l_e_m_s_e_t.html">ELEMSET</a> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (nsets * <span class="keyword">sizeof</span>(<a class="code" href="struct_e_l_e_m_s_e_t.html">ELEMSET</a>));
<a name="l00921"></a>00921     <span class="keywordflow">if</span> (NULL == z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>) {
<a name="l00922"></a>00922         fprintf (stderr, <span class="stringliteral">"malloc failed for element sets\n"</span>);
<a name="l00923"></a>00923         exit (1);
<a name="l00924"></a>00924     }
<a name="l00925"></a>00925 
<a name="l00926"></a>00926     <span class="comment">/* read element sets */</span>
<a name="l00927"></a>00927 
<a name="l00928"></a>00928     <span class="keywordflow">for</span> (es = z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>, ns = 1; ns &lt;= nsets; ns++, es++) {
<a name="l00929"></a>00929         es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> = 0;
<a name="l00930"></a>00930         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#c3fcb93fd744bd1715a203d4d5ac4165">cg_section_read</a> (cgnsfn, cgnsbase, nz, ns, es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7913ace0d483311647b8d88f795c6bfd">name</a>,
<a name="l00931"></a>00931                 &amp;es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a>, &amp;es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a>, &amp;es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#bc49be9d75acbce7b44e88a9d2a8f3cc">ie</a>, &amp;es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#264d7907938e52414f6007ea28c2d0c9">ib</a>, &amp;hasparent))
<a name="l00932"></a>00932             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_section_read"</span>);
<a name="l00933"></a>00933         printf (<span class="stringliteral">"  reading element set \"%s\"\n"</span>, es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7913ace0d483311647b8d88f795c6bfd">name</a>);
<a name="l00934"></a>00934         fflush (stdout);
<a name="l00935"></a>00935         nelem = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#bc49be9d75acbce7b44e88a9d2a8f3cc">ie</a> - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> + 1;
<a name="l00936"></a>00936         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#1dbd1441ae83c15a816de544a793a167">cg_ElementDataSize</a> (cgnsfn, cgnsbase, nz, ns, &amp;nn))
<a name="l00937"></a>00937             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_ElementDataSize"</span>);
<a name="l00938"></a>00938         <span class="keywordflow">if</span> (nn == 0) <span class="keywordflow">continue</span>;
<a name="l00939"></a>00939         es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a> = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (nn * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00940"></a>00940         <span class="keywordflow">if</span> (NULL == es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a>) {
<a name="l00941"></a>00941             fprintf (stderr, <span class="stringliteral">"malloc failed for elements\n"</span>);
<a name="l00942"></a>00942             exit (1);
<a name="l00943"></a>00943         }
<a name="l00944"></a>00944         es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a> = NULL;
<a name="l00945"></a>00945         <span class="keywordflow">if</span> (hasparent) {
<a name="l00946"></a>00946             es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a> = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (4 * nelem * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00947"></a>00947             <span class="keywordflow">if</span> (NULL == es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>) {
<a name="l00948"></a>00948                 fprintf (stderr, <span class="stringliteral">"malloc failed for elemset parent data\n"</span>);
<a name="l00949"></a>00949                 exit (1);
<a name="l00950"></a>00950             }
<a name="l00951"></a>00951         }
<a name="l00952"></a>00952         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#898fef85377c31c6ff996b83b9abd2fd">cg_elements_read</a> (cgnsfn, cgnsbase, nz, ns, es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a>,
<a name="l00953"></a>00953                 es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_elements_read"</span>);
<a name="l00954"></a>00954 
<a name="l00955"></a>00955         go_absolute (<span class="stringliteral">"Zone_t"</span>, nz, <span class="stringliteral">"Elements_t"</span>, ns, NULL);
<a name="l00956"></a>00956         ierr = read_rind (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>);
<a name="l00957"></a>00957         <span class="keywordflow">if</span> (ierr) {
<a name="l00958"></a>00958             <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_rind_read"</span>);
<a name="l00959"></a>00959             es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1] = 0;
<a name="l00960"></a>00960         }
<a name="l00961"></a>00961         <span class="keywordflow">else</span> {
<a name="l00962"></a>00962             <span class="keywordflow">if</span> (FileVersion &lt; 2400)
<a name="l00963"></a>00963                 error (<span class="stringliteral">"rind not valid for elements"</span>);
<a name="l00964"></a>00964         }
<a name="l00965"></a>00965 
<a name="l00966"></a>00966         es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#ab6822646f9a53265acb577886434744">nv</a> = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a> = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#3bf1137663f19e5c361c845cf4dfb7db">ne</a> = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#a440d0e525bda85d07f367d87d7dd86f">nn</a> = 0;
<a name="l00967"></a>00967 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000        </span>
<a name="l00968"></a>00968 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> &lt; <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac059a889456a2d742fdca191dccb3e871d">NODE</a>) {
<a name="l00969"></a>00969 <span class="preprocessor">#else        </span>
<a name="l00970"></a>00970 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> &lt; <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac059a889456a2d742fdca191dccb3e871d">NODE</a> || es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> &gt; <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac055c2b4d0f7ac387d0c7216f597dfacd3">MIXED</a>) {
<a name="l00971"></a>00971 <span class="preprocessor">#endif        </span>
<a name="l00972"></a>00972 <span class="preprocessor"></span>            es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> = -1;
<a name="l00973"></a>00973             <span class="keywordflow">continue</span>;
<a name="l00974"></a>00974         }
<a name="l00975"></a>00975         <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac055c2b4d0f7ac387d0c7216f597dfacd3">MIXED</a>) {
<a name="l00976"></a>00976             ip = ierr = 0;
<a name="l00977"></a>00977             <span class="keywordflow">for</span> (pe = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a>, ne = 0; ne &lt; nelem; ne++) {
<a name="l00978"></a>00978                 type = *pe++;
<a name="l00979"></a>00979                 <span class="keywordflow">if</span> (type &lt; <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac059a889456a2d742fdca191dccb3e871d">NODE</a> || type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac055c2b4d0f7ac387d0c7216f597dfacd3">MIXED</a>) {
<a name="l00980"></a>00980                     <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac055c2b4d0f7ac387d0c7216f597dfacd3">MIXED</a>)
<a name="l00981"></a>00981                         es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> = -2;
<a name="l00982"></a>00982                     <span class="keywordflow">else</span>
<a name="l00983"></a>00983                         es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> = -1;
<a name="l00984"></a>00984                     <span class="keywordflow">break</span>;
<a name="l00985"></a>00985                 }
<a name="l00986"></a>00986                 <span class="keywordflow">if</span> (type &gt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac01f3d58ce15426b3793432128bf0332e1">NGON_n</a>) {
<a name="l00987"></a>00987                     ip++;
<a name="l00988"></a>00988                     nn = type - <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac01f3d58ce15426b3793432128bf0332e1">NGON_n</a>;
<a name="l00989"></a>00989                     <span class="keywordflow">if</span> (nn &lt; 3) {
<a name="l00990"></a>00990                         ierr++;
<a name="l00991"></a>00991                     }
<a name="l00992"></a>00992                     <span class="keywordflow">else</span> {
<a name="l00993"></a>00993                         (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a>)++;
<a name="l00994"></a>00994                         <span class="keywordflow">if</span> (ne &gt;= es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] &amp;&amp; ne &lt; nelem - es-&gt;rind[1])
<a name="l00995"></a>00995                             (z-&gt;<a class="code" href="struct_z_o_n_e.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a>)++;
<a name="l00996"></a>00996                     }
<a name="l00997"></a>00997                     pe += nn;
<a name="l00998"></a>00998                     <span class="keywordflow">continue</span>;
<a name="l00999"></a>00999                 }
<a name="l01000"></a>01000                 <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac059a889456a2d742fdca191dccb3e871d">NODE</a>) {
<a name="l01001"></a>01001                     (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#a440d0e525bda85d07f367d87d7dd86f">nn</a>)++;
<a name="l01002"></a>01002                     <span class="keywordflow">if</span> (ne &gt;= es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] &amp;&amp; ne &lt; nelem - es-&gt;rind[1])
<a name="l01003"></a>01003                         (z-&gt;<a class="code" href="struct_z_o_n_e.html#a440d0e525bda85d07f367d87d7dd86f">nn</a>)++;
<a name="l01004"></a>01004                 }
<a name="l01005"></a>01005                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type &lt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0562a00059facc19331a3055b9ab21710">BAR_3</a>) {
<a name="l01006"></a>01006                     (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#3bf1137663f19e5c361c845cf4dfb7db">ne</a>)++;
<a name="l01007"></a>01007                     <span class="keywordflow">if</span> (ne &gt;= es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] &amp;&amp; ne &lt; nelem - es-&gt;rind[1])
<a name="l01008"></a>01008                         (z-&gt;<a class="code" href="struct_z_o_n_e.html#3bf1137663f19e5c361c845cf4dfb7db">ne</a>)++;
<a name="l01009"></a>01009                 }
<a name="l01010"></a>01010                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type &lt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0f38a9dc0e0d293d1293cdb706729aac4">QUAD_9</a>) {
<a name="l01011"></a>01011                     (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a>)++;
<a name="l01012"></a>01012                     <span class="keywordflow">if</span> (ne &gt;= es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] &amp;&amp; ne &lt; nelem - es-&gt;rind[1])
<a name="l01013"></a>01013                         (z-&gt;<a class="code" href="struct_z_o_n_e.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a>)++;
<a name="l01014"></a>01014                 }
<a name="l01015"></a>01015                 <span class="keywordflow">else</span> {
<a name="l01016"></a>01016                     (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#ab6822646f9a53265acb577886434744">nv</a>)++;
<a name="l01017"></a>01017                     <span class="keywordflow">if</span> (ne &gt;= es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] &amp;&amp; ne &lt; nelem - es-&gt;rind[1])
<a name="l01018"></a>01018                         (z-&gt;<a class="code" href="struct_z_o_n_e.html#ab6822646f9a53265acb577886434744">nv</a>)++;
<a name="l01019"></a>01019                 }
<a name="l01020"></a>01020                 <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#e7291fb6c47f4ff621c022dc5522f48b">cg_npe</a> (type, &amp;nn) || nn &lt;= 0) {
<a name="l01021"></a>01021                     es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> = -3;
<a name="l01022"></a>01022                     <span class="keywordflow">break</span>;
<a name="l01023"></a>01023                 }
<a name="l01024"></a>01024                 pe += nn;
<a name="l01025"></a>01025             }
<a name="l01026"></a>01026             <span class="keywordflow">if</span> (ierr)
<a name="l01027"></a>01027                 warning (2, <span class="stringliteral">"%d NGON_n element with &lt; 3 nodes in MIXED"</span>, ierr);
<a name="l01028"></a>01028             <span class="keywordflow">if</span> (ip) {
<a name="l01029"></a>01029                 <span class="keywordflow">if</span> (FileVersion &gt;= 3000)
<a name="l01030"></a>01030                     warning (2,
<a name="l01031"></a>01031                         <span class="stringliteral">"NGON_n in MIXED deprecated - use NGON_n element set"</span>);
<a name="l01032"></a>01032             }
<a name="l01033"></a>01033         }
<a name="l01034"></a>01034 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000        </span>
<a name="l01035"></a>01035 <span class="preprocessor"></span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> == NGON_n) {
<a name="l01036"></a>01036             es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a> = nelem;
<a name="l01037"></a>01037             z-&gt;<a class="code" href="struct_z_o_n_e.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a> += (nelem - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1]);
<a name="l01038"></a>01038         }
<a name="l01039"></a>01039         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0e0679c83d873c5c154531805e030a0f2">NFACE_n</a>) {
<a name="l01040"></a>01040             es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#ab6822646f9a53265acb577886434744">nv</a> = nelem;
<a name="l01041"></a>01041             z-&gt;<a class="code" href="struct_z_o_n_e.html#ab6822646f9a53265acb577886434744">nv</a> += (nelem - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1]);
<a name="l01042"></a>01042         }
<a name="l01043"></a>01043 <span class="preprocessor">#endif        </span>
<a name="l01044"></a>01044 <span class="preprocessor"></span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac059a889456a2d742fdca191dccb3e871d">NODE</a>) {
<a name="l01045"></a>01045             es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#a440d0e525bda85d07f367d87d7dd86f">nn</a> = nelem;
<a name="l01046"></a>01046             z-&gt;<a class="code" href="struct_z_o_n_e.html#a440d0e525bda85d07f367d87d7dd86f">nn</a> += (nelem - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1]);
<a name="l01047"></a>01047         }
<a name="l01048"></a>01048         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> &lt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0562a00059facc19331a3055b9ab21710">BAR_3</a>) {
<a name="l01049"></a>01049             es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#3bf1137663f19e5c361c845cf4dfb7db">ne</a> = nelem;
<a name="l01050"></a>01050             z-&gt;<a class="code" href="struct_z_o_n_e.html#3bf1137663f19e5c361c845cf4dfb7db">ne</a> += (nelem - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1]);
<a name="l01051"></a>01051         }
<a name="l01052"></a>01052         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> &lt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0f38a9dc0e0d293d1293cdb706729aac4">QUAD_9</a>) {
<a name="l01053"></a>01053             es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a> = nelem;
<a name="l01054"></a>01054             z-&gt;<a class="code" href="struct_z_o_n_e.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a> += (nelem - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1]);
<a name="l01055"></a>01055         }
<a name="l01056"></a>01056         <span class="keywordflow">else</span> {
<a name="l01057"></a>01057             es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#ab6822646f9a53265acb577886434744">nv</a> = nelem;
<a name="l01058"></a>01058             z-&gt;<a class="code" href="struct_z_o_n_e.html#ab6822646f9a53265acb577886434744">nv</a> += (nelem - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1]);
<a name="l01059"></a>01059         }
<a name="l01060"></a>01060     }
<a name="l01061"></a>01061 
<a name="l01062"></a>01062     <span class="comment">/* sort element sets by element range */</span>
<a name="l01063"></a>01063 
<a name="l01064"></a>01064     <span class="keywordflow">if</span> (nsets &gt; 1)
<a name="l01065"></a>01065         qsort (z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>, nsets, <span class="keyword">sizeof</span>(<a class="code" href="struct_e_l_e_m_s_e_t.html">ELEMSET</a>), compare_elemsets);
<a name="l01066"></a>01066 
<a name="l01067"></a>01067     <span class="keywordflow">if</span> (!z-&gt;<a class="code" href="struct_z_o_n_e.html#ab6822646f9a53265acb577886434744">nv</a>) <span class="keywordflow">return</span>;
<a name="l01068"></a>01068 
<a name="l01069"></a>01069     <span class="comment">/* check element indices for volume face hash table */</span>
<a name="l01070"></a>01070 
<a name="l01071"></a>01071     ierr = 0;
<a name="l01072"></a>01072     <span class="keywordflow">for</span> (es = z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>, ns = 0; ns &lt; nsets; ns++, es++) {
<a name="l01073"></a>01073         <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> || es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#ab6822646f9a53265acb577886434744">nv</a> == 0) <span class="keywordflow">continue</span>;
<a name="l01074"></a>01074         nelem = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#bc49be9d75acbce7b44e88a9d2a8f3cc">ie</a> - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> + 1 - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1];
<a name="l01075"></a>01075         pe = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a>;
<a name="l01076"></a>01076         <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac055c2b4d0f7ac387d0c7216f597dfacd3">MIXED</a>) {
<a name="l01077"></a>01077             <span class="keywordflow">for</span> (ne = 0; ne &lt; nelem; ne++) {
<a name="l01078"></a>01078                 type = *pe++;
<a name="l01079"></a>01079                 <span class="keywordflow">if</span> (type &gt;= NGON_n)
<a name="l01080"></a>01080                     nn = (int)(type - NGON_n);
<a name="l01081"></a>01081                 <span class="keywordflow">else</span>
<a name="l01082"></a>01082                     <a class="code" href="cgnslib_8c.html#e7291fb6c47f4ff621c022dc5522f48b">cg_npe</a> (type, &amp;nn);
<a name="l01083"></a>01083                 <span class="keywordflow">if</span> (nn &lt;= 0) {
<a name="l01084"></a>01084                     es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> = -3;
<a name="l01085"></a>01085                     <span class="keywordflow">break</span>;
<a name="l01086"></a>01086                 }
<a name="l01087"></a>01087                 <span class="keywordflow">if</span> (ne &gt;= es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0]) {
<a name="l01088"></a>01088                     <span class="keywordflow">for</span> (i = 0; i &lt; nn; i++) {
<a name="l01089"></a>01089                         <span class="keywordflow">if</span> (pe[i] &lt; 1 || pe[i] &gt; z-&gt;<a class="code" href="struct_z_o_n_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>) {
<a name="l01090"></a>01090                             ierr++;
<a name="l01091"></a>01091                             (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a>)++;
<a name="l01092"></a>01092                         }
<a name="l01093"></a>01093                     }
<a name="l01094"></a>01094                 }
<a name="l01095"></a>01095                 pe += nn;
<a name="l01096"></a>01096             }
<a name="l01097"></a>01097         }
<a name="l01098"></a>01098 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000</span>
<a name="l01099"></a>01099 <span class="preprocessor"></span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> == NGON_n) {
<a name="l01100"></a>01100             <span class="keywordflow">for</span> (ne = 0; ne &lt; nelem; ne++) {
<a name="l01101"></a>01101                 nn = *pe++;
<a name="l01102"></a>01102                 <span class="keywordflow">if</span> (ne &gt;= es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0]) {
<a name="l01103"></a>01103                     <span class="keywordflow">for</span> (i = 0; i &lt; nn; i++) {
<a name="l01104"></a>01104                         <span class="keywordflow">if</span> (pe[i] &lt; 1 || pe[i] &gt; z-&gt;<a class="code" href="struct_z_o_n_e.html#21d5307228ec77940b3f412681afeb68">maxnode</a>) {
<a name="l01105"></a>01105                             ierr++;
<a name="l01106"></a>01106                             (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a>)++;
<a name="l01107"></a>01107                         }
<a name="l01108"></a>01108                     }
<a name="l01109"></a>01109                 }
<a name="l01110"></a>01110                 pe += nn;
<a name="l01111"></a>01111             }
<a name="l01112"></a>01112         }
<a name="l01113"></a>01113         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0e0679c83d873c5c154531805e030a0f2">NFACE_n</a>) {
<a name="l01114"></a>01114             <span class="keywordflow">for</span> (ne = 0; ne &lt; nelem; ne++) {
<a name="l01115"></a>01115                 nn = *pe++;
<a name="l01116"></a>01116                 <span class="keywordflow">if</span> (ne &gt;= es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0]) {
<a name="l01117"></a>01117                     <span class="keywordflow">for</span> (i = 0; i &lt; nn; i++) {
<a name="l01118"></a>01118                         <span class="keywordflow">if</span> (!valid_face (z, pe[i])) {
<a name="l01119"></a>01119                             ierr++;
<a name="l01120"></a>01120                             (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a>)++;
<a name="l01121"></a>01121                         }
<a name="l01122"></a>01122                     }
<a name="l01123"></a>01123                 }
<a name="l01124"></a>01124                 pe += nn;
<a name="l01125"></a>01125             }
<a name="l01126"></a>01126         }
<a name="l01127"></a>01127 <span class="preprocessor">#endif</span>
<a name="l01128"></a>01128 <span class="preprocessor"></span>        <span class="keywordflow">else</span> {
<a name="l01129"></a>01129             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#e7291fb6c47f4ff621c022dc5522f48b">cg_npe</a> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a>, &amp;nn) || nn &lt;= 0) {
<a name="l01130"></a>01130                 es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> = -3;
<a name="l01131"></a>01131                 <span class="keywordflow">continue</span>;
<a name="l01132"></a>01132             }
<a name="l01133"></a>01133             <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] &gt; 0) {
<a name="l01134"></a>01134                 nelem -= es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0];
<a name="l01135"></a>01135                 pe += (nn * es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0]);
<a name="l01136"></a>01136             }
<a name="l01137"></a>01137             nn *= nelem;
<a name="l01138"></a>01138             <span class="keywordflow">for</span> (i = 0; i &lt; nn; i++) {
<a name="l01139"></a>01139                 <span class="keywordflow">if</span> (pe[i] &lt; 1 || pe[i] &gt; z-&gt;<a class="code" href="struct_z_o_n_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>) {
<a name="l01140"></a>01140                     ierr++;
<a name="l01141"></a>01141                     (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a>)++;
<a name="l01142"></a>01142                 }
<a name="l01143"></a>01143             }
<a name="l01144"></a>01144         }
<a name="l01145"></a>01145     }
<a name="l01146"></a>01146 
<a name="l01147"></a>01147     <span class="comment">/* build face hash table from volume elements */</span>
<a name="l01148"></a>01148 
<a name="l01149"></a>01149     <span class="keywordflow">if</span> (ierr) {
<a name="l01150"></a>01150         printf(<span class="stringliteral">"  skipping volume face checking since there were %d errors\n"</span>,
<a name="l01151"></a>01151             ierr);
<a name="l01152"></a>01152         <span class="keywordflow">return</span>;
<a name="l01153"></a>01153     }
<a name="l01154"></a>01154     puts (<span class="stringliteral">"  building volume faces hash table..."</span>);
<a name="l01155"></a>01155     fflush (stdout);
<a name="l01156"></a>01156     nn = (z-&gt;<a class="code" href="struct_z_o_n_e.html#ab6822646f9a53265acb577886434744">nv</a> &gt;&gt; 2) + 1;
<a name="l01157"></a>01157     z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a> = <a class="code" href="hash_8c.html#a041acdd30d85bc6fbea519e2de144e4">HashCreate</a> (nn, compare_faces, hash_face);
<a name="l01158"></a>01158     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a> == NULL) {
<a name="l01159"></a>01159         fprintf (stderr, <span class="stringliteral">"malloc failed for face hash table\n"</span>);
<a name="l01160"></a>01160         exit (1);
<a name="l01161"></a>01161     }
<a name="l01162"></a>01162 
<a name="l01163"></a>01163     ierr = 0;
<a name="l01164"></a>01164     <span class="keywordflow">for</span> (es = z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>, ns = 0; ns &lt; nsets; ns++, es++) {
<a name="l01165"></a>01165         <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> || es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#ab6822646f9a53265acb577886434744">nv</a> == 0 || es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> &lt; <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0b16b907138ae88e28d55fe2c22e5cac1">TETRA_4</a>) <span class="keywordflow">continue</span>;
<a name="l01166"></a>01166         <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> &gt; <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac055c2b4d0f7ac387d0c7216f597dfacd3">MIXED</a>) {
<a name="l01167"></a>01167 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000</span>
<a name="l01168"></a>01168 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> != <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0e0679c83d873c5c154531805e030a0f2">NFACE_n</a>)
<a name="l01169"></a>01169 <span class="preprocessor">#endif</span>
<a name="l01170"></a>01170 <span class="preprocessor"></span>            <span class="keywordflow">continue</span>;
<a name="l01171"></a>01171         }
<a name="l01172"></a>01172         nelem = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#bc49be9d75acbce7b44e88a9d2a8f3cc">ie</a> - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> + 1 - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1];
<a name="l01173"></a>01173         type = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a>;
<a name="l01174"></a>01174         pe = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a>;
<a name="l01175"></a>01175         <a class="code" href="cgnslib_8c.html#e7291fb6c47f4ff621c022dc5522f48b">cg_npe</a> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a>, &amp;nn);
<a name="l01176"></a>01176 
<a name="l01177"></a>01177         <span class="keywordflow">for</span> (ne = 0; ne &lt; nelem; ne++) {
<a name="l01178"></a>01178             <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac055c2b4d0f7ac387d0c7216f597dfacd3">MIXED</a>) {
<a name="l01179"></a>01179                 type = *pe++;
<a name="l01180"></a>01180                 <span class="keywordflow">if</span> (type &gt;= NGON_n)
<a name="l01181"></a>01181                     nn = (int)(type - NGON_n);
<a name="l01182"></a>01182                 <span class="keywordflow">else</span>
<a name="l01183"></a>01183                     <a class="code" href="cgnslib_8c.html#e7291fb6c47f4ff621c022dc5522f48b">cg_npe</a> (type, &amp;nn);
<a name="l01184"></a>01184             }
<a name="l01185"></a>01185             <span class="keywordflow">switch</span> (type) {
<a name="l01186"></a>01186                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0b16b907138ae88e28d55fe2c22e5cac1">TETRA_4</a>:
<a name="l01187"></a>01187                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac054a46a21a53a01d088adb91926421d22">TETRA_10</a>:
<a name="l01188"></a>01188                     nf = 4;
<a name="l01189"></a>01189                     <span class="keywordflow">break</span>;
<a name="l01190"></a>01190                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac08537f8dc3d6cd80c33664691d7ad372d">PYRA_5</a>:
<a name="l01191"></a>01191 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000</span>
<a name="l01192"></a>01192 <span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0ccf89d85716a35617b1d5e916a174671">PYRA_13</a>:
<a name="l01193"></a>01193 <span class="preprocessor">#endif                                </span>
<a name="l01194"></a>01194 <span class="preprocessor"></span>                <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac02178b3d7df13f84dbc8002ac3a935772">PYRA_14</a>:
<a name="l01195"></a>01195                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0bbb25bee7fa377ff218ee8bf316a2df3">PENTA_6</a>:
<a name="l01196"></a>01196                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac060d3e37e1cbac08456510a2eabaf1071">PENTA_15</a>:
<a name="l01197"></a>01197                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac050e8effdf2651e2c2894a300e5c5573d">PENTA_18</a>:
<a name="l01198"></a>01198                     nf = 5;
<a name="l01199"></a>01199                     <span class="keywordflow">break</span>;
<a name="l01200"></a>01200                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac025f49e976a1bbc5dd2392ec2f07a8d5e">HEXA_8</a>:
<a name="l01201"></a>01201                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac031f92ed3834465899b4a02c158aae2a8">HEXA_20</a>:
<a name="l01202"></a>01202                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac06b670c8639798ee64f15ad1149162ac3">HEXA_27</a>:
<a name="l01203"></a>01203                     nf = 6;
<a name="l01204"></a>01204                     <span class="keywordflow">break</span>;
<a name="l01205"></a>01205                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0e0679c83d873c5c154531805e030a0f2">NFACE_n</a>:
<a name="l01206"></a>01206                     nf = *pe++;
<a name="l01207"></a>01207                     nn = nf;
<a name="l01208"></a>01208                     <span class="keywordflow">break</span>;
<a name="l01209"></a>01209                 <span class="keywordflow">default</span>:
<a name="l01210"></a>01210                     nf = 0;
<a name="l01211"></a>01211                     <span class="keywordflow">break</span>;
<a name="l01212"></a>01212             }
<a name="l01213"></a>01213             <span class="keywordflow">if</span> (nf &gt; 0 &amp;&amp; ne &gt;= es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0]) {
<a name="l01214"></a>01214                 <span class="keywordflow">for</span> (j = 0; j &lt; nf; j++) {
<a name="l01215"></a>01215                     face = element_face (z, j, type, pe);
<a name="l01216"></a>01216                     pf = (<a class="code" href="struct_f_a_c_e.html">FACE</a> *) <a class="code" href="hash_8c.html#3067efda339f6d8987b72e7712864cd5">HashFind</a> (z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a>, face);
<a name="l01217"></a>01217                     <span class="keywordflow">if</span> (pf == NULL) {
<a name="l01218"></a>01218                         face-&gt;<a class="code" href="struct_f_a_c_e.html#31466fc672991029a5d7a12c53b6ad5f">e1</a> = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> + ne;
<a name="l01219"></a>01219                         face-&gt;<a class="code" href="struct_f_a_c_e.html#a75d52109f3f1fa6e40768b15db2814f">f1</a> = j + 1;
<a name="l01220"></a>01220                         (void) <a class="code" href="hash_8c.html#32c64366201524f36d8e7131d3419ed5">HashAdd</a> (z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a>, face);
<a name="l01221"></a>01221                     }
<a name="l01222"></a>01222                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pf-&gt;<a class="code" href="struct_f_a_c_e.html#be2d58850d42470d1973f25924c00c47">e2</a>) {
<a name="l01223"></a>01223                         ierr++;
<a name="l01224"></a>01224                     }
<a name="l01225"></a>01225                     <span class="keywordflow">else</span> {
<a name="l01226"></a>01226                         pf-&gt;<a class="code" href="struct_f_a_c_e.html#be2d58850d42470d1973f25924c00c47">e2</a> = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> + ne;
<a name="l01227"></a>01227                         pf-&gt;<a class="code" href="struct_f_a_c_e.html#4a0019706837babe79e30464d98c3575">f2</a> = j + 1;
<a name="l01228"></a>01228                     }
<a name="l01229"></a>01229                 }
<a name="l01230"></a>01230             }
<a name="l01231"></a>01231             pe += nn;
<a name="l01232"></a>01232         }
<a name="l01233"></a>01233     }
<a name="l01234"></a>01234     
<a name="l01235"></a>01235     <span class="keywordflow">if</span> (ierr)
<a name="l01236"></a>01236         warning (1, <span class="stringliteral">"%d faces are shared by more than 2 volumes"</span>, ierr);
<a name="l01237"></a>01237 
<a name="l01238"></a>01238     <span class="comment">/* get the list of exterior nodes */</span>
<a name="l01239"></a>01239 
<a name="l01240"></a>01240     puts (<span class="stringliteral">"  finding exterior nodes..."</span>);
<a name="l01241"></a>01241     fflush (stdout);
<a name="l01242"></a>01242     maxnode = 0;
<a name="l01243"></a>01243     <a class="code" href="hash_8c.html#e9f60604cf936773a9679becc54f01a0">HashList</a> (z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a>, get_maxnode, &amp;maxnode);
<a name="l01244"></a>01244     nodes = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#c07b71d27b6b37e81ac3a4c230f5794e">calloc</a> (maxnode, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01245"></a>01245     <span class="keywordflow">if</span> (nodes == NULL) {
<a name="l01246"></a>01246         fprintf (stderr, <span class="stringliteral">"malloc failed for zone nodes\n"</span>);
<a name="l01247"></a>01247         exit (1);
<a name="l01248"></a>01248     }
<a name="l01249"></a>01249     <a class="code" href="hash_8c.html#e9f60604cf936773a9679becc54f01a0">HashList</a> (z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a>, get_extnodes, nodes);
<a name="l01250"></a>01250     <span class="keywordflow">for</span> (nn = 0, n = 0; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>; n++) {
<a name="l01251"></a>01251         <span class="keywordflow">if</span> (nodes[n]) nn++;
<a name="l01252"></a>01252     }
<a name="l01253"></a>01253     z-&gt;<a class="code" href="struct_z_o_n_e.html#316acbd53e045949fbce31ae6f7366f1">nextnodes</a> = nn;
<a name="l01254"></a>01254     z-&gt;<a class="code" href="struct_z_o_n_e.html#862b1a443066be8463b7b0c2bca06856">extnodes</a> = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (nn * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l01255"></a>01255     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#862b1a443066be8463b7b0c2bca06856">extnodes</a> == NULL) {
<a name="l01256"></a>01256         fprintf (stderr, <span class="stringliteral">"malloc failed for zone exterior nodes\n"</span>);
<a name="l01257"></a>01257         exit (1);
<a name="l01258"></a>01258     }
<a name="l01259"></a>01259     <span class="keywordflow">for</span> (nn = 0, n = 0; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>; n++) {
<a name="l01260"></a>01260         <span class="keywordflow">if</span> (nodes[n]) z-&gt;<a class="code" href="struct_z_o_n_e.html#862b1a443066be8463b7b0c2bca06856">extnodes</a>[nn++] = n + 1;
<a name="l01261"></a>01261     }
<a name="l01262"></a>01262     <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (nodes);
<a name="l01263"></a>01263 }
<a name="l01264"></a>01264 
<a name="l01265"></a>01265 <span class="comment">/*=======================================================================*/</span>
<a name="l01266"></a>01266 
<a name="l01267"></a>01267 <span class="keyword">static</span> <span class="keywordtype">int</span> get_data_size (<a class="code" href="struct_z_o_n_e.html">ZONE</a> *z, <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> location, <span class="keywordtype">int</span> *rind)
<a name="l01268"></a>01268 {
<a name="l01269"></a>01269     <span class="keywordtype">int</span> n, i, datasize = 1;
<a name="l01270"></a>01270 
<a name="l01271"></a>01271     <span class="keywordflow">if</span> (location == <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>) {
<a name="l01272"></a>01272         <span class="keywordflow">for</span> (n = 0, i = 0; i &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; i++) {
<a name="l01273"></a>01273             datasize *= (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][i] + rind[n] + rind[n+1]);
<a name="l01274"></a>01274             n += 2;
<a name="l01275"></a>01275         }
<a name="l01276"></a>01276         <span class="keywordflow">return</span> datasize;
<a name="l01277"></a>01277     }
<a name="l01278"></a>01278 
<a name="l01279"></a>01279     <span class="keywordflow">if</span> (location == <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13af82b5a2366c89873ca45b75f6e6ac36">CellCenter</a>) {
<a name="l01280"></a>01280         <span class="keywordflow">for</span> (n = 0, i = 0; i &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; i++) {
<a name="l01281"></a>01281             datasize *= (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][i] + rind[n] + rind[n+1]);
<a name="l01282"></a>01282             n += 2;
<a name="l01283"></a>01283         }
<a name="l01284"></a>01284         <span class="keywordflow">return</span> datasize;
<a name="l01285"></a>01285     }
<a name="l01286"></a>01286 
<a name="l01287"></a>01287     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fedef7de5f4ce5345ffd8e2726df46e388">Unstructured</a>) {
<a name="l01288"></a>01288         error (<span class="stringliteral">"grid location %s not valid for unstructured zone"</span>,
<a name="l01289"></a>01289             <a class="code" href="cgnslib_8c.html#7af88bef6535742b3a0bb04f976ff747">cg_GridLocationName</a> (location));
<a name="l01290"></a>01290         <span class="keywordflow">return</span> 0;
<a name="l01291"></a>01291     }
<a name="l01292"></a>01292 
<a name="l01293"></a>01293     <span class="keywordflow">if</span> (location == <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1345f1c1cdb99ea61bfdddc570c6a02bf2">FaceCenter</a>) {
<a name="l01294"></a>01294         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> &gt; 2) {
<a name="l01295"></a>01295             error (<span class="stringliteral">"location is FaceCenter but index dimension &gt; 2"</span>);
<a name="l01296"></a>01296             <span class="keywordflow">return</span> 0;
<a name="l01297"></a>01297         }
<a name="l01298"></a>01298         <span class="keywordflow">for</span> (n = 0, i = 0; i &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; i++) {
<a name="l01299"></a>01299             datasize *= (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][i] + rind[n] + rind[n+1]);
<a name="l01300"></a>01300             n += 2;
<a name="l01301"></a>01301         }
<a name="l01302"></a>01302         <span class="keywordflow">return</span> datasize;
<a name="l01303"></a>01303     }
<a name="l01304"></a>01304 
<a name="l01305"></a>01305     <span class="keywordflow">if</span> (location == <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1320321805f8609b15483a7cd6e15e2d87">EdgeCenter</a>) {
<a name="l01306"></a>01306         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> &gt; 1) {
<a name="l01307"></a>01307             error (<span class="stringliteral">"location is EdgeCenter but index dimension &gt; 1"</span>);
<a name="l01308"></a>01308             <span class="keywordflow">return</span> 0;
<a name="l01309"></a>01309         }
<a name="l01310"></a>01310         datasize = z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][0] + rind[0] + rind[1];
<a name="l01311"></a>01311         <span class="keywordflow">return</span> datasize;
<a name="l01312"></a>01312     }
<a name="l01313"></a>01313 
<a name="l01314"></a>01314     <span class="keywordflow">if</span> (location == <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13b4cea34ab6a3c3533f2422f66bf8dc3d">IFaceCenter</a>) {
<a name="l01315"></a>01315         <span class="keywordflow">for</span> (n = 0, i = 1; i &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; i++) {
<a name="l01316"></a>01316             <span class="keywordflow">if</span> (i == 0)
<a name="l01317"></a>01317                 datasize *= (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][i] + rind[n] + rind[n+1]);
<a name="l01318"></a>01318             <span class="keywordflow">else</span>
<a name="l01319"></a>01319                 datasize *= (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][i] + rind[n] + rind[n+1]);
<a name="l01320"></a>01320             n += 2;
<a name="l01321"></a>01321         }
<a name="l01322"></a>01322         <span class="keywordflow">return</span> datasize;
<a name="l01323"></a>01323     }
<a name="l01324"></a>01324 
<a name="l01325"></a>01325     <span class="keywordflow">if</span> (location == <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e133f9cfc26e3953b1a7f7b8826e119a5d5">JFaceCenter</a>) {
<a name="l01326"></a>01326         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> &lt; 2) {
<a name="l01327"></a>01327             error (<span class="stringliteral">"location is JFaceCenter but index dimension &lt; 2"</span>);
<a name="l01328"></a>01328             <span class="keywordflow">return</span> 0;
<a name="l01329"></a>01329         }
<a name="l01330"></a>01330         <span class="keywordflow">for</span> (n = 0, i = 1; i &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; i++) {
<a name="l01331"></a>01331             <span class="keywordflow">if</span> (i == 1)
<a name="l01332"></a>01332                 datasize *= (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][i] + rind[n] + rind[n+1]);
<a name="l01333"></a>01333             <span class="keywordflow">else</span>
<a name="l01334"></a>01334                 datasize *= (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][i] + rind[n] + rind[n+1]);
<a name="l01335"></a>01335             n += 2;
<a name="l01336"></a>01336         }
<a name="l01337"></a>01337         <span class="keywordflow">return</span> datasize;
<a name="l01338"></a>01338     }
<a name="l01339"></a>01339 
<a name="l01340"></a>01340     <span class="keywordflow">if</span> (location == <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1387cfa4bdd4bc3bd768c3f0bab84f2143">KFaceCenter</a>) {
<a name="l01341"></a>01341         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> &lt; 3) {
<a name="l01342"></a>01342             error (<span class="stringliteral">"location is KFaceCenter but index dimension &lt; 3"</span>);
<a name="l01343"></a>01343             <span class="keywordflow">return</span> 0;
<a name="l01344"></a>01344         }
<a name="l01345"></a>01345         <span class="keywordflow">for</span> (n = 0, i = 1; i &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; i++) {
<a name="l01346"></a>01346             <span class="keywordflow">if</span> (i == 2)
<a name="l01347"></a>01347                 datasize *= (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][i] + rind[n] + rind[n+1]);
<a name="l01348"></a>01348             <span class="keywordflow">else</span>
<a name="l01349"></a>01349                 datasize *= (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][i] + rind[n] + rind[n+1]);
<a name="l01350"></a>01350             n += 2;
<a name="l01351"></a>01351         }
<a name="l01352"></a>01352         <span class="keywordflow">return</span> datasize;
<a name="l01353"></a>01353     }
<a name="l01354"></a>01354 
<a name="l01355"></a>01355     error (<span class="stringliteral">"grid location %s is invalid"</span>, <a class="code" href="cgnslib_8c.html#7af88bef6535742b3a0bb04f976ff747">cg_GridLocationName</a>(location));
<a name="l01356"></a>01356     <span class="keywordflow">return</span> 0;
<a name="l01357"></a>01357 }
<a name="l01358"></a>01358 
<a name="l01359"></a>01359 <span class="comment">/*=======================================================================*/</span>
<a name="l01360"></a>01360 
<a name="l01361"></a>01361 <span class="keyword">static</span> <span class="keywordtype">int</span> read_dataclass (<span class="keywordtype">void</span>)
<a name="l01362"></a>01362 {
<a name="l01363"></a>01363     <span class="keywordtype">int</span> ierr;
<a name="l01364"></a>01364     <a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca0">DataClass_t</a> dataclass;
<a name="l01365"></a>01365 
<a name="l01366"></a>01366     ierr = <a class="code" href="cgnslib_8c.html#f9a464c0028aed42cfa4ac8ddccf1bdd">cg_dataclass_read</a> (&amp;dataclass);
<a name="l01367"></a>01367     <span class="keywordflow">if</span> (ierr) {
<a name="l01368"></a>01368         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_dataclass_read"</span>);
<a name="l01369"></a>01369         <span class="keywordflow">return</span> -1;
<a name="l01370"></a>01370     }
<a name="l01371"></a>01371     <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)dataclass;
<a name="l01372"></a>01372 }
<a name="l01373"></a>01373 
<a name="l01374"></a>01374 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01375"></a>01375 
<a name="l01376"></a>01376 <span class="keyword">static</span> <span class="keywordtype">int</span> *read_units (<span class="keywordtype">int</span> units[9])
<a name="l01377"></a>01377 {
<a name="l01378"></a>01378     <span class="keywordtype">int</span> n, ierr;
<a name="l01379"></a>01379     <a class="code" href="cgns_keywords_8h.html#8f0a5167b1d8319a0e481666e57ceca0">MassUnits_t</a> mass;
<a name="l01380"></a>01380     <a class="code" href="cgns_keywords_8h.html#92ba99c00037b87031c19ec440a4a3ca">LengthUnits_t</a> length;
<a name="l01381"></a>01381     <a class="code" href="cgns_keywords_8h.html#b5fe9a7cbb1e8e49cf4649eeee249cb8">TimeUnits_t</a> time;
<a name="l01382"></a>01382     <a class="code" href="cgns_keywords_8h.html#2d4e2b4a0daece6b3e91b47fafd82ff5">TemperatureUnits_t</a> temp;
<a name="l01383"></a>01383     <a class="code" href="cgns_keywords_8h.html#9fe6a2bd66677cb82aa84a64f0e7882d">AngleUnits_t</a> angle;
<a name="l01384"></a>01384 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01385"></a>01385 <span class="preprocessor"></span>    <a class="code" href="cgns_keywords_8h.html#5d4973c6d234c38906f05d7e95adb91b">ElectricCurrentUnits_t</a> current;
<a name="l01386"></a>01386     <a class="code" href="cgns_keywords_8h.html#cab7dbd0387c45e43fa52b67b1728a83">SubstanceAmountUnits_t</a> amount;
<a name="l01387"></a>01387     <a class="code" href="cgns_keywords_8h.html#2bfd9ba0eb7f7edef0ed7241ca258983">LuminousIntensityUnits_t</a> intensity;
<a name="l01388"></a>01388 <span class="preprocessor">#endif</span>
<a name="l01389"></a>01389 <span class="preprocessor"></span>
<a name="l01390"></a>01390     <span class="keywordflow">for</span> (n = 0; n &lt; 9; n++)
<a name="l01391"></a>01391         units[n] = 0;
<a name="l01392"></a>01392 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01393"></a>01393 <span class="preprocessor"></span>    ierr = <a class="code" href="cgnslib_8c.html#f760a0bf9be3fbecd11d5c617ac222d7">cg_unitsfull_read</a> (&amp;mass, &amp;length, &amp;time, &amp;temp, &amp;angle,
<a name="l01394"></a>01394                               &amp;current, &amp;amount, &amp;intensity);
<a name="l01395"></a>01395     <span class="keywordflow">if</span> (ierr) {
<a name="l01396"></a>01396         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_unitsfull_read"</span>);
<a name="l01397"></a>01397         <span class="keywordflow">return</span> NULL;
<a name="l01398"></a>01398     }
<a name="l01399"></a>01399     <a class="code" href="cgnslib_8c.html#6d68b153cfb8ef3bc2e1873cc5faa895">cg_nunits</a> (&amp;n);
<a name="l01400"></a>01400     units[8] = n;
<a name="l01401"></a>01401     units[5] = current;
<a name="l01402"></a>01402     units[6] = amount;
<a name="l01403"></a>01403     units[7] = intensity;
<a name="l01404"></a>01404 <span class="preprocessor">#else</span>
<a name="l01405"></a>01405 <span class="preprocessor"></span>    ierr = <a class="code" href="cgnslib_8c.html#b5fe0e097ea1804cab4d28dd679993a0">cg_units_read</a> (&amp;mass, &amp;length, &amp;time, &amp;temp, &amp;angle);
<a name="l01406"></a>01406     <span class="keywordflow">if</span> (ierr) {
<a name="l01407"></a>01407         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_units_read"</span>);
<a name="l01408"></a>01408         <span class="keywordflow">return</span> NULL;
<a name="l01409"></a>01409     }
<a name="l01410"></a>01410     units[8] = 5;
<a name="l01411"></a>01411 <span class="preprocessor">#endif</span>
<a name="l01412"></a>01412 <span class="preprocessor"></span>    units[0] = mass;
<a name="l01413"></a>01413     units[1] = length;
<a name="l01414"></a>01414     units[2] = time;
<a name="l01415"></a>01415     units[3] = temp;
<a name="l01416"></a>01416     units[4] = angle;
<a name="l01417"></a>01417     <span class="keywordflow">return</span> units;
<a name="l01418"></a>01418 }
<a name="l01419"></a>01419 
<a name="l01420"></a>01420 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01421"></a>01421 
<a name="l01422"></a>01422 <span class="keyword">static</span> <span class="keywordtype">int</span> read_exponents (<span class="keywordtype">float</span> exps[9])
<a name="l01423"></a>01423 {
<a name="l01424"></a>01424     <span class="keywordtype">int</span> n, ierr;
<a name="l01425"></a>01425     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> type;
<a name="l01426"></a>01426 
<a name="l01427"></a>01427     <span class="keywordflow">for</span> (n = 0; n &lt; 9; n++)
<a name="l01428"></a>01428         exps[n] = 0;
<a name="l01429"></a>01429     ierr = <a class="code" href="cgnslib_8c.html#5902d9ca0d5d4a97414ad34235e84cb2">cg_exponents_info</a> (&amp;type);
<a name="l01430"></a>01430     <span class="keywordflow">if</span> (ierr) {
<a name="l01431"></a>01431         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_exponents_info"</span>);
<a name="l01432"></a>01432         <span class="keywordflow">return</span> 0;
<a name="l01433"></a>01433     }
<a name="l01434"></a>01434     <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1ca5e5244f4627fd3bf71c72015c2060">RealSingle</a>)
<a name="l01435"></a>01435 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01436"></a>01436 <span class="preprocessor"></span>        ierr = <a class="code" href="cgnslib_8c.html#1230aef75b8d89e689e6331453450dfc">cg_expfull_read</a> (exps);
<a name="l01437"></a>01437 <span class="preprocessor">#else</span>
<a name="l01438"></a>01438 <span class="preprocessor"></span>        ierr = <a class="code" href="cgnslib_8c.html#a33117721a0ed457c84fe6dd0ca11174">cg_exponents_read</a> (exps);
<a name="l01439"></a>01439 <span class="preprocessor">#endif</span>
<a name="l01440"></a>01440 <span class="preprocessor"></span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae5f954e649a6da0e65898e0faf7724549">RealDouble</a>) {
<a name="l01441"></a>01441 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01442"></a>01442 <span class="preprocessor"></span>        <span class="keywordtype">double</span> <a class="code" href="_a_d_f__internals_8h.html#1c4032c79398d15869ce0828a58de11f">data</a>[8];
<a name="l01443"></a>01443         ierr = <a class="code" href="cgnslib_8c.html#1230aef75b8d89e689e6331453450dfc">cg_expfull_read</a> (data);
<a name="l01444"></a>01444         <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l01445"></a>01445             <span class="keywordflow">for</span> (n = 0; n &lt; 8; n++)
<a name="l01446"></a>01446                 exps[n] = (<span class="keywordtype">float</span>)data[n];
<a name="l01447"></a>01447         }
<a name="l01448"></a>01448 <span class="preprocessor">#else</span>
<a name="l01449"></a>01449 <span class="preprocessor"></span>        <span class="keywordtype">double</span> data[5];
<a name="l01450"></a>01450         ierr = <a class="code" href="cgnslib_8c.html#a33117721a0ed457c84fe6dd0ca11174">cg_exponents_read</a> (data);
<a name="l01451"></a>01451         <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l01452"></a>01452             <span class="keywordflow">for</span> (n = 0; n &lt; 5; n++)
<a name="l01453"></a>01453                 exps[n] = (<span class="keywordtype">float</span>)data[n];
<a name="l01454"></a>01454         }
<a name="l01455"></a>01455 <span class="preprocessor">#endif</span>
<a name="l01456"></a>01456 <span class="preprocessor"></span>    }
<a name="l01457"></a>01457     <span class="keywordflow">else</span> {
<a name="l01458"></a>01458         fprintf (stderr, <span class="stringliteral">"invalid data type for exponents\n"</span>);
<a name="l01459"></a>01459         exit (1);
<a name="l01460"></a>01460     }
<a name="l01461"></a>01461     <span class="keywordflow">if</span> (ierr) {
<a name="l01462"></a>01462         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l01463"></a>01463 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01464"></a>01464 <span class="preprocessor"></span>            <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_expfull_read"</span>);
<a name="l01465"></a>01465 <span class="preprocessor">#else</span>
<a name="l01466"></a>01466 <span class="preprocessor"></span>            <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_exponents_read"</span>);
<a name="l01467"></a>01467 <span class="preprocessor">#endif</span>
<a name="l01468"></a>01468 <span class="preprocessor"></span>        <span class="keywordflow">return</span> 0;
<a name="l01469"></a>01469     }
<a name="l01470"></a>01470 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01471"></a>01471 <span class="preprocessor"></span>    <a class="code" href="cgnslib_8c.html#24b74ca653870e53ac94d00ed5063ad8">cg_nexponents</a> (&amp;n);
<a name="l01472"></a>01472     exps[8] = n;
<a name="l01473"></a>01473 <span class="preprocessor">#else</span>
<a name="l01474"></a>01474 <span class="preprocessor"></span>    exps[8] = 5;
<a name="l01475"></a>01475 <span class="preprocessor">#endif</span>
<a name="l01476"></a>01476 <span class="preprocessor"></span>    <span class="keywordflow">return</span> 1;
<a name="l01477"></a>01477 }
<a name="l01478"></a>01478 
<a name="l01479"></a>01479 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01480"></a>01480 
<a name="l01481"></a>01481 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (<span class="keywordtype">int</span> indent)
<a name="l01482"></a>01482 {
<a name="l01483"></a>01483     <span class="keywordflow">while</span> (indent-- &gt; 0) putchar (<span class="charliteral">' '</span>);
<a name="l01484"></a>01484 }
<a name="l01485"></a>01485 
<a name="l01486"></a>01486 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01487"></a>01487 
<a name="l01488"></a>01488 <span class="keyword">static</span> <span class="keywordtype">void</span> print_dataclass (<span class="keywordtype">int</span> dataclass, <span class="keywordtype">int</span> indent)
<a name="l01489"></a>01489 {
<a name="l01490"></a>01490     <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01491"></a>01491     printf (<span class="stringliteral">"Data Class="</span>);
<a name="l01492"></a>01492     <span class="keywordflow">if</span> (dataclass &lt; 0)
<a name="l01493"></a>01493         puts (<span class="stringliteral">"&lt;not specified&gt;"</span>);
<a name="l01494"></a>01494     <span class="keywordflow">else</span>
<a name="l01495"></a>01495         puts (<a class="code" href="cgnslib_8c.html#763494a8fec5c73f46e65c861fcebb58">cg_DataClassName</a>(dataclass));
<a name="l01496"></a>01496 }
<a name="l01497"></a>01497 
<a name="l01498"></a>01498 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01499"></a>01499 
<a name="l01500"></a>01500 <span class="keyword">static</span> <span class="keywordtype">void</span> print_units (<span class="keywordtype">int</span> *units, <span class="keywordtype">int</span> indent)
<a name="l01501"></a>01501 {
<a name="l01502"></a>01502     <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01503"></a>01503 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01504"></a>01504 <span class="preprocessor"></span>    printf (<span class="stringliteral">"Units=[%s,%s,%s,%s,%s"</span>,
<a name="l01505"></a>01505         <a class="code" href="cgnslib_8c.html#bf2005eabb40eb9de0f9d64a4a978eb1">cg_MassUnitsName</a>(units[0]),
<a name="l01506"></a>01506         <a class="code" href="cgnslib_8c.html#9b3bd755c31e2d3607cef41a6301a136">cg_LengthUnitsName</a>(units[1]),
<a name="l01507"></a>01507         <a class="code" href="cgnslib_8c.html#75967dc4b9fc9c39ee30771717906a0e">cg_TimeUnitsName</a>(units[2]),
<a name="l01508"></a>01508         <a class="code" href="cgnslib_8c.html#3be5195635f3d870334f29ffad861678">cg_TemperatureUnitsName</a>(units[4]),
<a name="l01509"></a>01509         <a class="code" href="cgnslib_8c.html#45ed805c797a8d4726d1cc9df843adc9">cg_AngleUnitsName</a>(units[4]));
<a name="l01510"></a>01510     <span class="keywordflow">if</span> (units[8] &gt; 5)
<a name="l01511"></a>01511         printf (<span class="stringliteral">",%s,%s,%s"</span>,
<a name="l01512"></a>01512             <a class="code" href="cgnslib_8c.html#eba3d08d342e4e92e1f9169a43a78a33">cg_ElectricCurrentUnitsName</a>(units[5]),
<a name="l01513"></a>01513             <a class="code" href="cgnslib_8c.html#70475a80009f0769cc139719988b7474">cg_SubstanceAmountUnitsName</a>(units[6]),
<a name="l01514"></a>01514             <a class="code" href="cgnslib_8c.html#405c73e63176b62fb36138c5f4a1fd21">cg_LuminousIntensityUnitsName</a>(units[7]));
<a name="l01515"></a>01515     puts (<span class="stringliteral">"]"</span>);
<a name="l01516"></a>01516 <span class="preprocessor">#else</span>
<a name="l01517"></a>01517 <span class="preprocessor"></span>    printf (<span class="stringliteral">"Units=[%s,%s,%s,%s,%s]\n"</span>,
<a name="l01518"></a>01518         <a class="code" href="cgnslib_8c.html#bf2005eabb40eb9de0f9d64a4a978eb1">cg_MassUnitsName</a>(units[0]),
<a name="l01519"></a>01519         <a class="code" href="cgnslib_8c.html#9b3bd755c31e2d3607cef41a6301a136">cg_LengthUnitsName</a>(units[1]),
<a name="l01520"></a>01520         <a class="code" href="cgnslib_8c.html#75967dc4b9fc9c39ee30771717906a0e">cg_TimeUnitsName</a>(units[2]),
<a name="l01521"></a>01521         <a class="code" href="cgnslib_8c.html#3be5195635f3d870334f29ffad861678">cg_TemperatureUnitsName</a>(units[4]),
<a name="l01522"></a>01522         <a class="code" href="cgnslib_8c.html#45ed805c797a8d4726d1cc9df843adc9">cg_AngleUnitsName</a>(units[4]));
<a name="l01523"></a>01523 <span class="preprocessor">#endif</span>
<a name="l01524"></a>01524 <span class="preprocessor"></span>}
<a name="l01525"></a>01525 
<a name="l01526"></a>01526 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01527"></a>01527 
<a name="l01528"></a>01528 <span class="keyword">static</span> <span class="keywordtype">void</span> print_exponents (<span class="keywordtype">float</span> *exps, <span class="keywordtype">int</span> indent)
<a name="l01529"></a>01529 {
<a name="l01530"></a>01530     <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01531"></a>01531 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01532"></a>01532 <span class="preprocessor"></span>    printf (<span class="stringliteral">"Exponents=[%g,%g,%g,%g,%g"</span>, exps[0], exps[1],
<a name="l01533"></a>01533         exps[2], exps[3], exps[4]);
<a name="l01534"></a>01534     <span class="keywordflow">if</span> (exps[8] &gt; 5.0)
<a name="l01535"></a>01535         printf (<span class="stringliteral">",%g,%g,%g"</span>, exps[5], exps[6], exps[7]);
<a name="l01536"></a>01536     puts (<span class="stringliteral">"]"</span>);
<a name="l01537"></a>01537 <span class="preprocessor">#else</span>
<a name="l01538"></a>01538 <span class="preprocessor"></span>    printf (<span class="stringliteral">"Exponents=[%g,%g,%g,%g,%g]\n"</span>, exps[0], exps[1],
<a name="l01539"></a>01539         exps[2], exps[3], exps[4]);
<a name="l01540"></a>01540 <span class="preprocessor">#endif</span>
<a name="l01541"></a>01541 <span class="preprocessor"></span>}
<a name="l01542"></a>01542 
<a name="l01543"></a>01543 <span class="comment">/*=======================================================================*/</span>
<a name="l01544"></a>01544 
<a name="l01545"></a>01545 <span class="keyword">static</span> <span class="keywordtype">void</span> check_quantity (<span class="keywordtype">int</span> dnum, <span class="keywordtype">char</span> *name,
<a name="l01546"></a>01546     <span class="keywordtype">int</span> parclass, <span class="keywordtype">int</span> *parunits, <span class="keywordtype">int</span> isref, <span class="keywordtype">int</span> indent)
<a name="l01547"></a>01547 {
<a name="l01548"></a>01548     <span class="keywordtype">int</span> n, ne, dclass, *punits, hasexps, units[9];
<a name="l01549"></a>01549     <span class="keywordtype">float</span> defexps[8], exps[9];
<a name="l01550"></a>01550 
<a name="l01551"></a>01551     go_relative (<span class="stringliteral">"DataArray_t"</span>, dnum, NULL);
<a name="l01552"></a>01552     dclass = read_dataclass ();
<a name="l01553"></a>01553     punits = read_units (units);
<a name="l01554"></a>01554     hasexps = read_exponents (exps);
<a name="l01555"></a>01555     go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l01556"></a>01556 
<a name="l01557"></a>01557     <span class="keywordflow">if</span> (verbose) {
<a name="l01558"></a>01558         <span class="keywordflow">if</span> (dclass &gt;= 0) print_dataclass (dclass, indent);
<a name="l01559"></a>01559         <span class="keywordflow">if</span> (punits != NULL) print_units (punits, indent);
<a name="l01560"></a>01560         <span class="keywordflow">if</span> (hasexps) print_exponents (exps, indent);
<a name="l01561"></a>01561     }
<a name="l01562"></a>01562     <span class="keywordflow">if</span> (dclass &lt; 0) dclass = parclass;
<a name="l01563"></a>01563 
<a name="l01564"></a>01564     <span class="keywordflow">if</span> (<a class="code" href="cgnames_8c.html#362a01c886e0a87ef132b73ceebea785">cg_get_identifier</a> (name, &amp;ne, defexps)) {
<a name="l01565"></a>01565         <span class="keywordflow">if</span> (isref &gt; 0)
<a name="l01566"></a>01566             warning (3, <span class="stringliteral">"not a CGNS data-name identifier"</span>);
<a name="l01567"></a>01567         <span class="keywordflow">if</span> (dclass &lt; 0)
<a name="l01568"></a>01568             warning (3, <span class="stringliteral">"dataclass is not given"</span>);
<a name="l01569"></a>01569         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca0">DataClass_t</a>)dclass == <a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca07d2c4cee62e93aa8492b81554ac9f6c1">Dimensional</a>) {
<a name="l01570"></a>01570             <span class="keywordflow">if</span> (punits == NULL &amp;&amp; parunits == NULL)
<a name="l01571"></a>01571                 warning (2, <span class="stringliteral">"units not given"</span>);
<a name="l01572"></a>01572             <span class="keywordflow">if</span> (!hasexps)
<a name="l01573"></a>01573                 warning (2, <span class="stringliteral">"exponents not given"</span>);
<a name="l01574"></a>01574         }
<a name="l01575"></a>01575         <span class="keywordflow">else</span> {
<a name="l01576"></a>01576             <span class="keywordflow">if</span> (punits != NULL || hasexps)
<a name="l01577"></a>01577                 warning (2, <span class="stringliteral">"dataclass is %s, but units and/or exponents"</span>
<a name="l01578"></a>01578                     <span class="stringliteral">" are given"</span>, <a class="code" href="cgnslib_8c.html#763494a8fec5c73f46e65c861fcebb58">cg_DataClassName</a>(dclass));
<a name="l01579"></a>01579         }
<a name="l01580"></a>01580         <span class="keywordflow">return</span>;
<a name="l01581"></a>01581     }
<a name="l01582"></a>01582 
<a name="l01583"></a>01583     <span class="keywordflow">if</span> (isref &lt; 0) <span class="keywordflow">return</span>;
<a name="l01584"></a>01584 
<a name="l01585"></a>01585     <span class="keywordflow">if</span> (dclass &lt; 0)
<a name="l01586"></a>01586         warning (2, <span class="stringliteral">"dataclass not given"</span>);
<a name="l01587"></a>01587     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca0">DataClass_t</a>)dclass == <a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca07d2c4cee62e93aa8492b81554ac9f6c1">Dimensional</a> ||
<a name="l01588"></a>01588              (<a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca0">DataClass_t</a>)dclass == <a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca0cf97c8ddc427fdd4feb12f6f3d5712cf">NormalizedByDimensional</a> ||
<a name="l01589"></a>01589              (<a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca0">DataClass_t</a>)dclass == <a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca03cdb346f00ea0fda5a464eb6e19244a6">NormalizedByUnknownDimensional</a>) {
<a name="l01590"></a>01590         <span class="keywordflow">if</span> (!ne)
<a name="l01591"></a>01591             warning (2, <span class="stringliteral">"dataclass does not match CGNS specification"</span>);
<a name="l01592"></a>01592         <span class="keywordflow">if</span> ((<a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca0">DataClass_t</a>)dclass == <a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca07d2c4cee62e93aa8492b81554ac9f6c1">Dimensional</a> &amp;&amp;
<a name="l01593"></a>01593             punits == NULL &amp;&amp; parunits == NULL)
<a name="l01594"></a>01594             warning (2, <span class="stringliteral">"units not given for dimensional quantity"</span>);
<a name="l01595"></a>01595         <span class="keywordflow">if</span> (hasexps &amp;&amp; ne &gt; 0) {
<a name="l01596"></a>01596             <span class="keywordflow">for</span> (n = 0; n &lt; ne; n++) {
<a name="l01597"></a>01597                 <span class="keywordflow">if</span> (exps[n] != defexps[n]) <span class="keywordflow">break</span>;
<a name="l01598"></a>01598             }
<a name="l01599"></a>01599             <span class="keywordflow">if</span> (n &lt; ne)
<a name="l01600"></a>01600                 warning (2, <span class="stringliteral">"exponents do not match CGNS specification"</span>);
<a name="l01601"></a>01601         }
<a name="l01602"></a>01602     }
<a name="l01603"></a>01603     <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca0">DataClass_t</a>)dclass == <a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca066300750c694e64983eaacbd458f215e">NondimensionalParameter</a> ||
<a name="l01604"></a>01604              (<a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca0">DataClass_t</a>)dclass == <a class="code" href="cgns_keywords_8h.html#6e3a45166e6780b756fef5c427279ca073d8c0ede9ab0d58cef704e5a2f98ae8">DimensionlessConstant</a>) {
<a name="l01605"></a>01605         <span class="keywordflow">if</span> (ne)
<a name="l01606"></a>01606             warning (2, <span class="stringliteral">"dataclass does not match CGNS specification"</span>);
<a name="l01607"></a>01607         <span class="keywordflow">if</span> (punits != NULL)
<a name="l01608"></a>01608             warning (2, <span class="stringliteral">"units given for nondimensional quantity"</span>);
<a name="l01609"></a>01609         <span class="keywordflow">if</span> (hasexps)
<a name="l01610"></a>01610             warning (2, <span class="stringliteral">"exponents given for nondimensional quantity"</span>);
<a name="l01611"></a>01611     }
<a name="l01612"></a>01612     <span class="keywordflow">else</span>
<a name="l01613"></a>01613         error (<span class="stringliteral">"invalid dataclass"</span>);
<a name="l01614"></a>01614 }
<a name="l01615"></a>01615 
<a name="l01616"></a>01616 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01617"></a>01617 
<a name="l01618"></a>01618 <span class="keyword">static</span> <span class="keywordtype">void</span> check_arrays (<span class="keywordtype">int</span> parclass, <span class="keywordtype">int</span> *parunits, <span class="keywordtype">int</span> isref,
<a name="l01619"></a>01619     <span class="keywordtype">int</span> length, <span class="keywordtype">int</span> indent)
<a name="l01620"></a>01620 {
<a name="l01621"></a>01621     <span class="keywordtype">int</span> n, narrays, na, ndim, dims[12];
<a name="l01622"></a>01622     <span class="keywordtype">int</span> dataclass, *punits, units[9], size;
<a name="l01623"></a>01623     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l01624"></a>01624     <span class="keywordtype">char</span> name[33];
<a name="l01625"></a>01625 
<a name="l01626"></a>01626     dataclass = read_dataclass ();
<a name="l01627"></a>01627     punits = read_units (units);
<a name="l01628"></a>01628     <span class="keywordflow">if</span> (verbose) {
<a name="l01629"></a>01629         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, indent);
<a name="l01630"></a>01630         <span class="keywordflow">if</span> (punits) print_units (punits, indent);
<a name="l01631"></a>01631     }
<a name="l01632"></a>01632     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = parclass;
<a name="l01633"></a>01633     <span class="keywordflow">if</span> (!punits) punits = parunits;
<a name="l01634"></a>01634 
<a name="l01635"></a>01635     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;narrays)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_narrays"</span>);
<a name="l01636"></a>01636 
<a name="l01637"></a>01637     <span class="keywordflow">for</span> (na = 1; na &lt;= narrays; na++) {
<a name="l01638"></a>01638         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (na, name, &amp;datatype, &amp;ndim, dims))
<a name="l01639"></a>01639             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_array_info"</span>);
<a name="l01640"></a>01640         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01641"></a>01641         printf (<span class="stringliteral">"checking quantity \"%s\"\n"</span>, name);
<a name="l01642"></a>01642         fflush (stdout);
<a name="l01643"></a>01643         <span class="keywordflow">for</span> (size = 1, n = 0; n &lt; ndim; n++)
<a name="l01644"></a>01644             size *= dims[n];
<a name="l01645"></a>01645         <span class="keywordflow">if</span> (ndim &lt; 1 || size &lt; 1)
<a name="l01646"></a>01646             error (<span class="stringliteral">"invalid dimensions"</span>);
<a name="l01647"></a>01647         <span class="keywordflow">if</span> (length &lt; 0 &amp;&amp; size != 1 &amp;&amp; size != -length)
<a name="l01648"></a>01648             error (<span class="stringliteral">"array size not 1 or %d"</span>, -length);
<a name="l01649"></a>01649         <span class="keywordflow">if</span> (length &gt; 0 &amp;&amp; size != length)
<a name="l01650"></a>01650             error (<span class="stringliteral">"array size not %d"</span>, length);
<a name="l01651"></a>01651         check_quantity (na, name, dataclass, punits, isref, indent+2);
<a name="l01652"></a>01652     }
<a name="l01653"></a>01653 }
<a name="l01654"></a>01654 
<a name="l01655"></a>01655 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01656"></a>01656 
<a name="l01657"></a>01657 <span class="keyword">static</span> <span class="keywordtype">void</span> check_user_data (<span class="keywordtype">int</span> parclass, <span class="keywordtype">int</span> *parunits, <span class="keywordtype">int</span> indent)
<a name="l01658"></a>01658 {
<a name="l01659"></a>01659     <span class="keywordtype">int</span> n, nd, nu, nuser, na, ndim, dims[12];
<a name="l01660"></a>01660     <span class="keywordtype">int</span> dataclass, *punits, units[9];
<a name="l01661"></a>01661     <span class="keywordtype">char</span> name[33], *desc;
<a name="l01662"></a>01662     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l01663"></a>01663 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01664"></a>01664 <span class="preprocessor"></span>    <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> location;
<a name="l01665"></a>01665     <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5">PointSetType_t</a> ptype;
<a name="l01666"></a>01666     <span class="keywordtype">int</span> hasf, haso, hasl, hasp, <a class="code" href="write__bcdata_8c.html#5444c4f4b8152e0b11ea6acae6b6de2a">npnts</a>, ordinal;
<a name="l01667"></a>01667 <span class="preprocessor">#endif</span>
<a name="l01668"></a>01668 <span class="preprocessor"></span>
<a name="l01669"></a>01669     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#be14f289bd1323164998af33752e068c">cg_nuser_data</a> (&amp;nuser)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_nuser_data"</span>);
<a name="l01670"></a>01670     <span class="keywordflow">if</span> (nuser &lt;= 0) <span class="keywordflow">return</span>;
<a name="l01671"></a>01671 
<a name="l01672"></a>01672     <span class="keywordflow">for</span> (nu = 1; nu &lt;= nuser; nu++) {
<a name="l01673"></a>01673         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#8c43aaaa6425aa382e84e3ebd5c58bfd">cg_user_data_read</a> (nu, name)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_user_data_read"</span>);
<a name="l01674"></a>01674         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01675"></a>01675         printf (<span class="stringliteral">"checking user data \"%s\"\n"</span>, name);
<a name="l01676"></a>01676         fflush (stdout);
<a name="l01677"></a>01677         go_relative (<span class="stringliteral">"UserDefinedData_t"</span>, nu, NULL);
<a name="l01678"></a>01678 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01679"></a>01679 <span class="preprocessor"></span>        hasf = <a class="code" href="cgnslib_8c.html#7bc0fed09c8e3e4152fcbd1ceb2e053d">cg_famname_read</a> (name);
<a name="l01680"></a>01680         <span class="keywordflow">if</span> (hasf &amp;&amp; hasf != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l01681"></a>01681             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_famname_read"</span>);
<a name="l01682"></a>01682         haso = read_ordinal (&amp;ordinal);
<a name="l01683"></a>01683         <span class="keywordflow">if</span> (haso &amp;&amp; haso != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l01684"></a>01684             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ordinal_read"</span>);
<a name="l01685"></a>01685         hasl = read_gridlocation (&amp;location);
<a name="l01686"></a>01686         <span class="keywordflow">if</span> (hasl &amp;&amp; hasl != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l01687"></a>01687             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_gridlocation_read"</span>);
<a name="l01688"></a>01688         <span class="comment">/* ptset is only allowed below a zone */</span>
<a name="l01689"></a>01689         <span class="keywordflow">if</span> (cgnszone == 0)
<a name="l01690"></a>01690             hasp = <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>;
<a name="l01691"></a>01691         <span class="keywordflow">else</span> {
<a name="l01692"></a>01692             hasp = <a class="code" href="cgnslib_8c.html#6dc17b4e61dc1c11b7350d8720b52fce">cg_ptset_info</a> (&amp;ptype, &amp;npnts);
<a name="l01693"></a>01693             <span class="keywordflow">if</span> (hasp &amp;&amp; hasp != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l01694"></a>01694                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ptset_info"</span>);
<a name="l01695"></a>01695         }
<a name="l01696"></a>01696         <span class="keywordflow">if</span> (verbose) {
<a name="l01697"></a>01697             <span class="keywordflow">if</span> (hasf == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l01698"></a>01698                 <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent+2);
<a name="l01699"></a>01699                 printf (<span class="stringliteral">"Family Name=\"%s\"\n"</span>, name);
<a name="l01700"></a>01700             }
<a name="l01701"></a>01701             <span class="keywordflow">if</span> (haso == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l01702"></a>01702                 <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent+2);
<a name="l01703"></a>01703                 printf (<span class="stringliteral">"Ordinal=%d\n"</span>, ordinal);
<a name="l01704"></a>01704             }
<a name="l01705"></a>01705             <span class="keywordflow">if</span> (hasl == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l01706"></a>01706                 <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent+2);
<a name="l01707"></a>01707                 printf (<span class="stringliteral">"Grid Location=%s\n"</span>, <a class="code" href="cgnslib_8c.html#7af88bef6535742b3a0bb04f976ff747">cg_GridLocationName</a>(location));
<a name="l01708"></a>01708             }
<a name="l01709"></a>01709             <span class="keywordflow">if</span> (hasp == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l01710"></a>01710                 <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent+2);
<a name="l01711"></a>01711                 printf (<span class="stringliteral">"Point Set Type=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6f8fbf63d32639cbaecf055db223423f">cg_PointSetTypeName</a>(ptype));
<a name="l01712"></a>01712                 <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent+2);
<a name="l01713"></a>01713                 printf (<span class="stringliteral">"Number Points=%d\n"</span>, npnts);
<a name="l01714"></a>01714             }
<a name="l01715"></a>01715         }
<a name="l01716"></a>01716         <span class="keywordflow">if</span> (hasf == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l01717"></a>01717             <span class="keywordflow">for</span> (n = 0; n &lt; NumFamily; n++) {
<a name="l01718"></a>01718                 <span class="keywordflow">if</span> (0 == strcmp (name, Family[n])) <span class="keywordflow">break</span>;
<a name="l01719"></a>01719             }
<a name="l01720"></a>01720             <span class="keywordflow">if</span> (n == NumFamily)
<a name="l01721"></a>01721                 warning (1, <span class="stringliteral">"family name \"%s\" not found"</span>, name);
<a name="l01722"></a>01722         }
<a name="l01723"></a>01723 <span class="preprocessor">#endif</span>
<a name="l01724"></a>01724 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l01725"></a>01725             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l01726"></a>01726             <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l01727"></a>01727                 <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l01728"></a>01728                     <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l01729"></a>01729                 <span class="keywordflow">if</span> (desc != NULL) {
<a name="l01730"></a>01730                     <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent + 2);
<a name="l01731"></a>01731                     printf (<span class="stringliteral">"Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l01732"></a>01732                     <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l01733"></a>01733                 }
<a name="l01734"></a>01734             }
<a name="l01735"></a>01735         }
<a name="l01736"></a>01736 
<a name="l01737"></a>01737         dataclass = read_dataclass ();
<a name="l01738"></a>01738         punits = read_units (units);
<a name="l01739"></a>01739         <span class="keywordflow">if</span> (verbose) {
<a name="l01740"></a>01740             <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, indent + 2);
<a name="l01741"></a>01741             <span class="keywordflow">if</span> (punits) print_units (punits, indent + 2);
<a name="l01742"></a>01742         }
<a name="l01743"></a>01743         <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = parclass;
<a name="l01744"></a>01744         <span class="keywordflow">if</span> (!punits) punits = parunits;
<a name="l01745"></a>01745 
<a name="l01746"></a>01746         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;na)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_narrays"</span>);
<a name="l01747"></a>01747         <span class="keywordflow">for</span> (n = 1; n &lt;= na; n++) {
<a name="l01748"></a>01748             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l01749"></a>01749                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_array_info"</span>);
<a name="l01750"></a>01750             <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent + 2);
<a name="l01751"></a>01751             printf (<span class="stringliteral">"checking quantity \"%s\"\n"</span>, name);
<a name="l01752"></a>01752             fflush (stdout);
<a name="l01753"></a>01753             check_quantity (n, name, dataclass, punits, 0, indent+4);
<a name="l01754"></a>01754         }
<a name="l01755"></a>01755 
<a name="l01756"></a>01756 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01757"></a>01757 <span class="preprocessor"></span>        check_user_data (dataclass, punits, indent + 2);
<a name="l01758"></a>01758 <span class="preprocessor">#endif</span>
<a name="l01759"></a>01759 <span class="preprocessor"></span>        go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l01760"></a>01760     }
<a name="l01761"></a>01761 }
<a name="l01762"></a>01762 
<a name="l01763"></a>01763 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01764"></a>01764 
<a name="l01765"></a>01765 <span class="keyword">static</span> <span class="keywordtype">void</span> check_integral (<span class="keywordtype">int</span> parclass, <span class="keywordtype">int</span> *parunits, <span class="keywordtype">int</span> indent)
<a name="l01766"></a>01766 {
<a name="l01767"></a>01767     <span class="keywordtype">char</span> *desc, name[33];
<a name="l01768"></a>01768     <span class="keywordtype">int</span> n, ni, nint, na, nd, ndim, dims[12];
<a name="l01769"></a>01769     <span class="keywordtype">int</span> dataclass, *punits, units[9];
<a name="l01770"></a>01770     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l01771"></a>01771 
<a name="l01772"></a>01772     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#d11a2fa7c91d703369f94933754749fd">cg_nintegrals</a> (&amp;nint)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_nintegrals"</span>);
<a name="l01773"></a>01773     <span class="keywordflow">if</span> (nint &lt;= 0) <span class="keywordflow">return</span>;
<a name="l01774"></a>01774     <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01775"></a>01775     puts (<span class="stringliteral">"checking integral data"</span>);
<a name="l01776"></a>01776     fflush (stdout);
<a name="l01777"></a>01777 
<a name="l01778"></a>01778     <span class="keywordflow">for</span> (ni = 1; ni &lt;= nint; ni++) {
<a name="l01779"></a>01779         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#39491a892a14b8fbfacb7781fd36433a">cg_integral_read</a> (ni, name)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_integral_read"</span>);
<a name="l01780"></a>01780         go_relative (<span class="stringliteral">"IntegralData_t"</span>, ni, NULL);
<a name="l01781"></a>01781         <span class="keywordflow">if</span> (verbose) {
<a name="l01782"></a>01782             <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent + 2);
<a name="l01783"></a>01783             printf (<span class="stringliteral">"integral data \"%s\"\n"</span>, name);
<a name="l01784"></a>01784             <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l01785"></a>01785                 <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l01786"></a>01786                 <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l01787"></a>01787                     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l01788"></a>01788                         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l01789"></a>01789                     <span class="keywordflow">if</span> (desc != NULL) {
<a name="l01790"></a>01790                         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent + 4);
<a name="l01791"></a>01791                         printf (<span class="stringliteral">"Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l01792"></a>01792                         <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l01793"></a>01793                     }
<a name="l01794"></a>01794                 }
<a name="l01795"></a>01795             }
<a name="l01796"></a>01796         }
<a name="l01797"></a>01797 
<a name="l01798"></a>01798         dataclass = read_dataclass ();
<a name="l01799"></a>01799         punits = read_units (units);
<a name="l01800"></a>01800         <span class="keywordflow">if</span> (verbose) {
<a name="l01801"></a>01801             <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, indent + 4);
<a name="l01802"></a>01802             <span class="keywordflow">if</span> (punits) print_units (punits, indent + 4);
<a name="l01803"></a>01803         }
<a name="l01804"></a>01804         <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = parclass;
<a name="l01805"></a>01805         <span class="keywordflow">if</span> (!punits) punits = parunits;
<a name="l01806"></a>01806 
<a name="l01807"></a>01807         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;na)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_narrays"</span>);
<a name="l01808"></a>01808         <span class="keywordflow">for</span> (n = 1; n &lt;= na; n++) {
<a name="l01809"></a>01809             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l01810"></a>01810                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_array_info"</span>);
<a name="l01811"></a>01811             <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent + 4);
<a name="l01812"></a>01812             printf (<span class="stringliteral">"checking quantity \"%s\"\n"</span>, name);
<a name="l01813"></a>01813             fflush (stdout);
<a name="l01814"></a>01814             <span class="keywordflow">if</span> (ndim != 1 || dims[0] != 1)
<a name="l01815"></a>01815                 error (<span class="stringliteral">"dimension is not 1"</span>);
<a name="l01816"></a>01816             check_quantity (n, name, dataclass, punits, 0, indent+6);
<a name="l01817"></a>01817         }
<a name="l01818"></a>01818 
<a name="l01819"></a>01819         check_user_data (dataclass, punits, indent + 4);
<a name="l01820"></a>01820         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l01821"></a>01821     }
<a name="l01822"></a>01822 }
<a name="l01823"></a>01823 
<a name="l01824"></a>01824 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01825"></a>01825 
<a name="l01826"></a>01826 <span class="keyword">static</span> <span class="keywordtype">void</span> check_rotating (<span class="keywordtype">float</span> *point, <span class="keywordtype">float</span> *vector,
<a name="l01827"></a>01827     <span class="keywordtype">int</span> parclass, <span class="keywordtype">int</span> *parunits, <span class="keywordtype">int</span> indent)
<a name="l01828"></a>01828 {
<a name="l01829"></a>01829     <span class="keywordtype">char</span> *desc, name[33];
<a name="l01830"></a>01830     <span class="keywordtype">int</span> n, na, nd, ndim, dims[12];
<a name="l01831"></a>01831     <span class="keywordtype">int</span> dataclass, *punits, units[9];
<a name="l01832"></a>01832     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l01833"></a>01833 
<a name="l01834"></a>01834     go_relative (<span class="stringliteral">"RotatingCoordinates_t"</span>, 1, NULL);
<a name="l01835"></a>01835 
<a name="l01836"></a>01836     <span class="keywordflow">if</span> (verbose) {
<a name="l01837"></a>01837         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01838"></a>01838         printf (<span class="stringliteral">"Center=[%g"</span>, point[0]);
<a name="l01839"></a>01839         <span class="keywordflow">for</span> (nd = 1; nd &lt; <a class="code" href="write__rind_8c.html#00f223876113d78f6e69408dd20f1a5d">PhyDim</a>; nd++)
<a name="l01840"></a>01840             printf (<span class="stringliteral">",%g"</span>, point[nd]);
<a name="l01841"></a>01841         puts (<span class="stringliteral">"]"</span>);
<a name="l01842"></a>01842         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01843"></a>01843         printf (<span class="stringliteral">"Rate Vector=[%g"</span>, vector[0]);
<a name="l01844"></a>01844         <span class="keywordflow">for</span> (nd = 1; nd &lt; PhyDim; nd++)
<a name="l01845"></a>01845             printf (<span class="stringliteral">",%g"</span>, vector[nd]);
<a name="l01846"></a>01846         puts (<span class="stringliteral">"]"</span>);
<a name="l01847"></a>01847     }
<a name="l01848"></a>01848 
<a name="l01849"></a>01849     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l01850"></a>01850         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l01851"></a>01851         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l01852"></a>01852             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l01853"></a>01853                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l01854"></a>01854             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l01855"></a>01855                 <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01856"></a>01856                 printf (<span class="stringliteral">"Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l01857"></a>01857                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l01858"></a>01858             }
<a name="l01859"></a>01859         }
<a name="l01860"></a>01860     }
<a name="l01861"></a>01861 
<a name="l01862"></a>01862     dataclass = read_dataclass ();
<a name="l01863"></a>01863     punits = read_units (units);
<a name="l01864"></a>01864     <span class="keywordflow">if</span> (verbose) {
<a name="l01865"></a>01865         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, indent);
<a name="l01866"></a>01866         <span class="keywordflow">if</span> (punits) print_units (punits, indent);
<a name="l01867"></a>01867     }
<a name="l01868"></a>01868     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = parclass;
<a name="l01869"></a>01869     <span class="keywordflow">if</span> (!punits) punits = parunits;
<a name="l01870"></a>01870 
<a name="l01871"></a>01871     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;na)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_narrays"</span>);
<a name="l01872"></a>01872     <span class="keywordflow">for</span> (n = 1; n &lt;= na; n++) {
<a name="l01873"></a>01873         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l01874"></a>01874             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l01875"></a>01875         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01876"></a>01876         printf (<span class="stringliteral">"checking rotating data \"%s\"\n"</span>, name);
<a name="l01877"></a>01877         fflush (stdout);
<a name="l01878"></a>01878         <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">"RotationCenter"</span>) &amp;&amp;
<a name="l01879"></a>01879             strcmp (name, <span class="stringliteral">"RotationRateVector"</span>))
<a name="l01880"></a>01880             warning (1, <span class="stringliteral">"not valid as child of RotatingCoordinates"</span>);
<a name="l01881"></a>01881         <span class="keywordflow">else</span>
<a name="l01882"></a>01882             check_quantity (n, name, dataclass, punits, 1, indent + 4);
<a name="l01883"></a>01883     }
<a name="l01884"></a>01884 
<a name="l01885"></a>01885     check_user_data (dataclass, punits, indent + 2);
<a name="l01886"></a>01886 
<a name="l01887"></a>01887     go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l01888"></a>01888 }
<a name="l01889"></a>01889 
<a name="l01890"></a>01890 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01891"></a>01891 
<a name="l01892"></a>01892 <span class="keyword">static</span> <span class="keywordtype">void</span> check_convergence (<span class="keywordtype">int</span> niter, <span class="keywordtype">char</span> *NormDefs,
<a name="l01893"></a>01893     <span class="keywordtype">int</span> parclass, <span class="keywordtype">int</span> *parunits, <span class="keywordtype">int</span> indent)
<a name="l01894"></a>01894 {
<a name="l01895"></a>01895     <span class="keywordtype">char</span> name[33];
<a name="l01896"></a>01896     <span class="keywordtype">int</span> n, na, ndim, dims[12];
<a name="l01897"></a>01897     <span class="keywordtype">int</span> dataclass, *punits, units[9];
<a name="l01898"></a>01898     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l01899"></a>01899 
<a name="l01900"></a>01900     <span class="keywordflow">if</span> (verbose) {
<a name="l01901"></a>01901         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01902"></a>01902         printf (<span class="stringliteral">"Number Iterations=%d\n"</span>, niter);
<a name="l01903"></a>01903         <span class="keywordflow">if</span> (NormDefs != NULL) {
<a name="l01904"></a>01904             <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01905"></a>01905             printf (<span class="stringliteral">"Norm Definitions=%s\n"</span>, NormDefs);
<a name="l01906"></a>01906         }
<a name="l01907"></a>01907     }
<a name="l01908"></a>01908     <span class="keywordflow">if</span> (niter &lt; 1)
<a name="l01909"></a>01909         warning (2, <span class="stringliteral">"number of iterations is not &gt; 0"</span>);
<a name="l01910"></a>01910 
<a name="l01911"></a>01911     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l01912"></a>01912         <span class="keywordtype">int</span> nd;
<a name="l01913"></a>01913         <span class="keywordtype">char</span> *desc;
<a name="l01914"></a>01914         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l01915"></a>01915         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l01916"></a>01916             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l01917"></a>01917                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l01918"></a>01918             <span class="keywordflow">if</span> (desc != NULL &amp;&amp; strcmp (name, <span class="stringliteral">"NormDefinitions"</span>)) {
<a name="l01919"></a>01919                 <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01920"></a>01920                 printf (<span class="stringliteral">"Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l01921"></a>01921             }
<a name="l01922"></a>01922             <span class="keywordflow">if</span> (desc != NULL) <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l01923"></a>01923         }
<a name="l01924"></a>01924     }
<a name="l01925"></a>01925 
<a name="l01926"></a>01926     dataclass = read_dataclass ();
<a name="l01927"></a>01927     punits = read_units (units);
<a name="l01928"></a>01928     <span class="keywordflow">if</span> (verbose) {
<a name="l01929"></a>01929         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, indent);
<a name="l01930"></a>01930         <span class="keywordflow">if</span> (punits) print_units (punits, indent);
<a name="l01931"></a>01931     }
<a name="l01932"></a>01932     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = parclass;
<a name="l01933"></a>01933     <span class="keywordflow">if</span> (!punits) punits = parunits;
<a name="l01934"></a>01934 
<a name="l01935"></a>01935     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;na)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_narrays"</span>);
<a name="l01936"></a>01936     <span class="keywordflow">for</span> (n = 1; n &lt;= na; n++) {
<a name="l01937"></a>01937         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l01938"></a>01938             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l01939"></a>01939         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01940"></a>01940         printf (<span class="stringliteral">"checking convergence data \"%s\"\n"</span>, name);
<a name="l01941"></a>01941         fflush (stdout);
<a name="l01942"></a>01942         <span class="keywordflow">if</span> (ndim != 1 || dims[0] != niter)
<a name="l01943"></a>01943             error (<span class="stringliteral">"length of array is not the number of iterations"</span>);
<a name="l01944"></a>01944         <span class="keywordflow">if</span> (0 == strncmp (name, <span class="stringliteral">"RSD"</span>, 3) ||
<a name="l01945"></a>01945             0 == strncmp (name, <span class="stringliteral">"CHG"</span>, 3))
<a name="l01946"></a>01946             check_quantity (n, NULL, dataclass, punits, -1, indent + 2);
<a name="l01947"></a>01947         <span class="keywordflow">else</span>
<a name="l01948"></a>01948             check_quantity (n, name, dataclass, punits, 1, indent + 2);
<a name="l01949"></a>01949     }
<a name="l01950"></a>01950 
<a name="l01951"></a>01951     check_user_data (dataclass, punits, indent);
<a name="l01952"></a>01952 }
<a name="l01953"></a>01953 
<a name="l01954"></a>01954 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l01955"></a>01955 
<a name="l01956"></a>01956 <span class="keyword">static</span> <span class="keywordtype">void</span> check_equation_set (<span class="keywordtype">int</span> *flags, <span class="keywordtype">int</span> parclass, <span class="keywordtype">int</span> *parunits,
<a name="l01957"></a>01957     <span class="keywordtype">int</span> indent)
<a name="l01958"></a>01958 {
<a name="l01959"></a>01959     <span class="keywordtype">char</span> *desc, name[33];
<a name="l01960"></a>01960     <span class="keywordtype">int</span> n, nd, dataclass, ierr, *punits, units[9], ndiff, diff[6];
<a name="l01961"></a>01961     <a class="code" href="cgns_keywords_8h.html#7a3f70ad41979f9879fdcb6707519cac">GoverningEquationsType_t</a> governing;
<a name="l01962"></a>01962     <a class="code" href="cgns_keywords_8h.html#e4dcb1e90f970848fe809fbe830319fb">ModelType_t</a> model;
<a name="l01963"></a>01963     <span class="keywordtype">int</span> thermrelax, chemkin;
<a name="l01964"></a>01964 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01965"></a>01965 <span class="preprocessor"></span>    <span class="keywordtype">int</span> emelec, emmagn, emcond;
<a name="l01966"></a>01966 <span class="preprocessor">#endif</span>
<a name="l01967"></a>01967 <span class="preprocessor"></span>
<a name="l01968"></a>01968     ierr = <a class="code" href="cgnslib_8c.html#18af3d6b4b362a04aa67a4f46ecb9931">cg_equationset_chemistry_read</a> (&amp;thermrelax, &amp;chemkin);
<a name="l01969"></a>01969     <span class="keywordflow">if</span> (ierr) {
<a name="l01970"></a>01970         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l01971"></a>01971             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_equationset_chemistry_read"</span>);
<a name="l01972"></a>01972         thermrelax = chemkin = 0;
<a name="l01973"></a>01973     }
<a name="l01974"></a>01974 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l01975"></a>01975 <span class="preprocessor"></span>    ierr = <a class="code" href="cgnslib_8c.html#cdf101f86c02b640eecf8fece6542cc2">cg_equationset_elecmagn_read</a> (&amp;emelec, &amp;emmagn, &amp;emcond);
<a name="l01976"></a>01976     <span class="keywordflow">if</span> (ierr) {
<a name="l01977"></a>01977         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>);
<a name="l01978"></a>01978             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_equationset_elecmagn_read"</span>);
<a name="l01979"></a>01979         emelec = emmagn = emcond = 0;
<a name="l01980"></a>01980     }
<a name="l01981"></a>01981 <span class="preprocessor">#endif</span>
<a name="l01982"></a>01982 <span class="preprocessor"></span>
<a name="l01983"></a>01983     go_relative (<span class="stringliteral">"FlowEquationSet_t"</span>, 1, NULL);
<a name="l01984"></a>01984 
<a name="l01985"></a>01985     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l01986"></a>01986         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l01987"></a>01987         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l01988"></a>01988             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l01989"></a>01989                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l01990"></a>01990             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l01991"></a>01991                 <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l01992"></a>01992                 printf (<span class="stringliteral">"Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l01993"></a>01993                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l01994"></a>01994             }
<a name="l01995"></a>01995         }
<a name="l01996"></a>01996     }
<a name="l01997"></a>01997 
<a name="l01998"></a>01998     <span class="keywordflow">if</span> (LibraryVersion &lt; 2000) {
<a name="l01999"></a>01999         dataclass = -1;
<a name="l02000"></a>02000         punits = NULL;
<a name="l02001"></a>02001     }
<a name="l02002"></a>02002     <span class="keywordflow">else</span> {
<a name="l02003"></a>02003         dataclass = read_dataclass ();
<a name="l02004"></a>02004         punits = read_units (units);
<a name="l02005"></a>02005     }
<a name="l02006"></a>02006     <span class="keywordflow">if</span> (verbose) {
<a name="l02007"></a>02007         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, indent);
<a name="l02008"></a>02008         <span class="keywordflow">if</span> (punits) print_units (punits, indent);
<a name="l02009"></a>02009         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02010"></a>02010         printf (<span class="stringliteral">"Equation Dimension=%d\n"</span>, flags[0]);
<a name="l02011"></a>02011     }
<a name="l02012"></a>02012     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = parclass;
<a name="l02013"></a>02013     <span class="keywordflow">if</span> (!punits) punits = parunits;
<a name="l02014"></a>02014     ndiff = (<a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a> * (<a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a> + 1)) / 2;
<a name="l02015"></a>02015 
<a name="l02016"></a>02016     <span class="keywordflow">if</span> (flags[0] &lt; 1)
<a name="l02017"></a>02017         error (<span class="stringliteral">"equation dimension &lt; 1"</span>);
<a name="l02018"></a>02018 
<a name="l02019"></a>02019     <span class="comment">/* governing equations */</span>
<a name="l02020"></a>02020 
<a name="l02021"></a>02021     <span class="keywordflow">if</span> (flags[1]) {
<a name="l02022"></a>02022         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#d83a15c7f36b0a0db9e45bb0f466a190">cg_governing_read</a> (&amp;governing))
<a name="l02023"></a>02023             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_governing_read"</span>);
<a name="l02024"></a>02024         go_relative (<span class="stringliteral">"GoverningEquations_t"</span>, 1, NULL);
<a name="l02025"></a>02025         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02026"></a>02026         printf (<span class="stringliteral">"Governing Equation=%s\n"</span>,
<a name="l02027"></a>02027             <a class="code" href="cgnslib_8c.html#e4fdb31e8138e008817c59f592586afd">cg_GoverningEquationsTypeName</a>(governing));
<a name="l02028"></a>02028         <span class="keywordflow">if</span> (LibraryVersion &lt; 2200 &amp;&amp; goDepth == 2) {
<a name="l02029"></a>02029             warning (3, <span class="stringliteral">"can't get Diffusion Model for FlowEquations"</span>
<a name="l02030"></a>02030                 <span class="stringliteral">" under CGNSBase_t\n        due to a bug in the CGNS"</span>
<a name="l02031"></a>02031                 <span class="stringliteral">" library for versions prior to 2.2"</span>);
<a name="l02032"></a>02032         }
<a name="l02033"></a>02033         <span class="keywordflow">else</span> {
<a name="l02034"></a>02034             ierr = <a class="code" href="cgnslib_8c.html#67e04d599a5e560fd425e47e16962dcd">cg_diffusion_read</a> (diff);
<a name="l02035"></a>02035             <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l02036"></a>02036                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_diffusion_read"</span>);
<a name="l02037"></a>02037             <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l02038"></a>02038                 <span class="keywordflow">if</span> (verbose) {
<a name="l02039"></a>02039                     <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent + 2);
<a name="l02040"></a>02040                     printf (<span class="stringliteral">"Diffusion Model=[%d"</span>, diff[0]);
<a name="l02041"></a>02041                     <span class="keywordflow">for</span> (n = 1; n &lt; ndiff; n++)
<a name="l02042"></a>02042                         printf (<span class="stringliteral">",%d"</span>, diff[n]);
<a name="l02043"></a>02043                     puts (<span class="stringliteral">"]"</span>);
<a name="l02044"></a>02044                 }
<a name="l02045"></a>02045                 <span class="keywordflow">for</span> (n = 0; n &lt; ndiff; n++) {
<a name="l02046"></a>02046                     <span class="keywordflow">if</span> (diff[n] &lt; 0 || diff[n] &gt; 1) <span class="keywordflow">break</span>;
<a name="l02047"></a>02047                 }
<a name="l02048"></a>02048                 <span class="keywordflow">if</span> (n &lt; ndiff)
<a name="l02049"></a>02049                     warning (1, <span class="stringliteral">"diffusion model terms not 0 or 1"</span>);
<a name="l02050"></a>02050             }
<a name="l02051"></a>02051         }
<a name="l02052"></a>02052         check_user_data (dataclass, punits, indent + 2);
<a name="l02053"></a>02053         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02054"></a>02054     }
<a name="l02055"></a>02055 
<a name="l02056"></a>02056     <span class="comment">/* gas model */</span>
<a name="l02057"></a>02057 
<a name="l02058"></a>02058     <span class="keywordflow">if</span> (flags[2]) {
<a name="l02059"></a>02059         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#16aeb1de858c4e339991a01b728d7105">cg_model_read</a> (<span class="stringliteral">"GasModel_t"</span>, &amp;model))
<a name="l02060"></a>02060             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_model_read"</span>);
<a name="l02061"></a>02061         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02062"></a>02062         printf (<span class="stringliteral">"Gas Model=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6bac93eb29d890ffa5b44f83b0cb4ffd">cg_ModelTypeName</a>(model));
<a name="l02063"></a>02063         go_relative (<span class="stringliteral">"GasModel_t"</span>, 1, NULL);
<a name="l02064"></a>02064         check_arrays (dataclass, punits, 1, 0, indent + 2);
<a name="l02065"></a>02065         check_user_data (dataclass, punits, indent + 2);
<a name="l02066"></a>02066         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02067"></a>02067     }
<a name="l02068"></a>02068 
<a name="l02069"></a>02069     <span class="comment">/* viscosity model */</span>
<a name="l02070"></a>02070 
<a name="l02071"></a>02071     <span class="keywordflow">if</span> (flags[3]) {
<a name="l02072"></a>02072         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#16aeb1de858c4e339991a01b728d7105">cg_model_read</a> (<span class="stringliteral">"ViscosityModel_t"</span>, &amp;model))
<a name="l02073"></a>02073             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_model_read"</span>);
<a name="l02074"></a>02074         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02075"></a>02075         printf (<span class="stringliteral">"Viscosity Model=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6bac93eb29d890ffa5b44f83b0cb4ffd">cg_ModelTypeName</a>(model));
<a name="l02076"></a>02076         go_relative (<span class="stringliteral">"ViscosityModel_t"</span>, 1, NULL);
<a name="l02077"></a>02077         check_arrays (dataclass, punits, 1, 0, indent + 2);
<a name="l02078"></a>02078         check_user_data (dataclass, punits, indent + 2);
<a name="l02079"></a>02079         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02080"></a>02080     }
<a name="l02081"></a>02081 
<a name="l02082"></a>02082     <span class="comment">/* thermal conductivity model */</span>
<a name="l02083"></a>02083 
<a name="l02084"></a>02084     <span class="keywordflow">if</span> (flags[4]) {
<a name="l02085"></a>02085         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#16aeb1de858c4e339991a01b728d7105">cg_model_read</a> (<span class="stringliteral">"ThermalConductivityModel_t"</span>, &amp;model))
<a name="l02086"></a>02086             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_model_read"</span>);
<a name="l02087"></a>02087         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02088"></a>02088         printf (<span class="stringliteral">"Thermal Conductivity Model=%s\n"</span>,
<a name="l02089"></a>02089             <a class="code" href="cgnslib_8c.html#6bac93eb29d890ffa5b44f83b0cb4ffd">cg_ModelTypeName</a>(model));
<a name="l02090"></a>02090         go_relative (<span class="stringliteral">"ThermalConductivityModel_t"</span>, 1, NULL);
<a name="l02091"></a>02091         check_arrays (dataclass, punits, 1, 0, indent + 2);
<a name="l02092"></a>02092         check_user_data (dataclass, punits, indent + 2);
<a name="l02093"></a>02093         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02094"></a>02094     }
<a name="l02095"></a>02095 
<a name="l02096"></a>02096     <span class="comment">/* turbulence closure model */</span>
<a name="l02097"></a>02097 
<a name="l02098"></a>02098     <span class="keywordflow">if</span> (flags[5]) {
<a name="l02099"></a>02099         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#16aeb1de858c4e339991a01b728d7105">cg_model_read</a> (<span class="stringliteral">"TurbulenceClosure_t"</span>, &amp;model))
<a name="l02100"></a>02100             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_model_read"</span>);
<a name="l02101"></a>02101         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02102"></a>02102         printf (<span class="stringliteral">"Turbulence Closure=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6bac93eb29d890ffa5b44f83b0cb4ffd">cg_ModelTypeName</a>(model));
<a name="l02103"></a>02103         go_relative (<span class="stringliteral">"TurbulenceClosure_t"</span>, 1, NULL);
<a name="l02104"></a>02104         check_arrays (dataclass, punits, 1, 0, indent + 2);
<a name="l02105"></a>02105         check_user_data (dataclass, punits, indent + 2);
<a name="l02106"></a>02106         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02107"></a>02107     }
<a name="l02108"></a>02108 
<a name="l02109"></a>02109     <span class="comment">/* turbulence model */</span>
<a name="l02110"></a>02110 
<a name="l02111"></a>02111     <span class="keywordflow">if</span> (flags[6]) {
<a name="l02112"></a>02112         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#16aeb1de858c4e339991a01b728d7105">cg_model_read</a> (<span class="stringliteral">"TurbulenceModel_t"</span>, &amp;model))
<a name="l02113"></a>02113             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_model_read"</span>);
<a name="l02114"></a>02114         go_relative (<span class="stringliteral">"TurbulenceModel_t"</span>, 1, NULL);
<a name="l02115"></a>02115         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02116"></a>02116         printf (<span class="stringliteral">"Turbulence Model=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6bac93eb29d890ffa5b44f83b0cb4ffd">cg_ModelTypeName</a>(model));
<a name="l02117"></a>02117         <span class="keywordflow">if</span> (LibraryVersion &lt; 2200 &amp;&amp; goDepth == 2) {
<a name="l02118"></a>02118             warning (3, <span class="stringliteral">"can't get Turbulent Diffusion Model for FlowEquations"</span>
<a name="l02119"></a>02119                 <span class="stringliteral">" under CGNSBase_t\n        due to a bug in the CGNS library"</span>
<a name="l02120"></a>02120                 <span class="stringliteral">" for versions prior to 2.2"</span>);
<a name="l02121"></a>02121         }
<a name="l02122"></a>02122         <span class="keywordflow">else</span> {
<a name="l02123"></a>02123             ierr = <a class="code" href="cgnslib_8c.html#67e04d599a5e560fd425e47e16962dcd">cg_diffusion_read</a> (diff);
<a name="l02124"></a>02124             <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l02125"></a>02125                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_diffusion_read"</span>);
<a name="l02126"></a>02126             <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l02127"></a>02127                 <span class="keywordflow">if</span> (verbose) {
<a name="l02128"></a>02128                     <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent + 2);
<a name="l02129"></a>02129                     printf (<span class="stringliteral">"Turbulent Diffusion Model=[%d"</span>, diff[0]);
<a name="l02130"></a>02130                     <span class="keywordflow">for</span> (n = 1; n &lt; ndiff; n++)
<a name="l02131"></a>02131                         printf (<span class="stringliteral">",%d"</span>, diff[n]);
<a name="l02132"></a>02132                     puts (<span class="stringliteral">"]"</span>);
<a name="l02133"></a>02133                 }
<a name="l02134"></a>02134                 <span class="keywordflow">for</span> (n = 0; n &lt; ndiff; n++) {
<a name="l02135"></a>02135                     <span class="keywordflow">if</span> (diff[n] &lt; 0 || diff[n] &gt; 1) <span class="keywordflow">break</span>;
<a name="l02136"></a>02136                 }
<a name="l02137"></a>02137                 <span class="keywordflow">if</span> (n &lt; ndiff)
<a name="l02138"></a>02138                     warning (1, <span class="stringliteral">"turbulent diffusion model terms not 0 or 1"</span>);
<a name="l02139"></a>02139             }
<a name="l02140"></a>02140         }
<a name="l02141"></a>02141         check_arrays (dataclass, punits, 1, 0, indent + 2);
<a name="l02142"></a>02142         check_user_data (dataclass, punits, indent + 2);
<a name="l02143"></a>02143         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02144"></a>02144     }
<a name="l02145"></a>02145 
<a name="l02146"></a>02146     <span class="comment">/* thermal relaxation model */</span>
<a name="l02147"></a>02147 
<a name="l02148"></a>02148     <span class="keywordflow">if</span> (thermrelax) {
<a name="l02149"></a>02149         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#16aeb1de858c4e339991a01b728d7105">cg_model_read</a> (<span class="stringliteral">"ThermalRelaxationModel_t"</span>, &amp;model))
<a name="l02150"></a>02150             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_model_read"</span>);
<a name="l02151"></a>02151         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02152"></a>02152         printf (<span class="stringliteral">"Thermal Relaxation Model=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6bac93eb29d890ffa5b44f83b0cb4ffd">cg_ModelTypeName</a>(model));
<a name="l02153"></a>02153         go_relative (<span class="stringliteral">"ThermalRelaxationModel_t"</span>, 1, NULL);
<a name="l02154"></a>02154         check_arrays (dataclass, punits, 1, 0, indent + 2);
<a name="l02155"></a>02155         check_user_data (dataclass, punits, indent + 2);
<a name="l02156"></a>02156         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02157"></a>02157     }
<a name="l02158"></a>02158 
<a name="l02159"></a>02159     <span class="comment">/* chemical kinetics model */</span>
<a name="l02160"></a>02160 
<a name="l02161"></a>02161 
<a name="l02162"></a>02162     <span class="keywordflow">if</span> (chemkin) {
<a name="l02163"></a>02163         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#16aeb1de858c4e339991a01b728d7105">cg_model_read</a> (<span class="stringliteral">"ChemicalKineticsModel_t"</span>, &amp;model))
<a name="l02164"></a>02164             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_model_read"</span>);
<a name="l02165"></a>02165         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02166"></a>02166         printf (<span class="stringliteral">"Chemical Kinetics Model=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6bac93eb29d890ffa5b44f83b0cb4ffd">cg_ModelTypeName</a>(model));
<a name="l02167"></a>02167         go_relative (<span class="stringliteral">"ChemicalKineticsModel_t"</span>, 1, NULL);
<a name="l02168"></a>02168         check_arrays (dataclass, punits, 1, 0, indent + 2);
<a name="l02169"></a>02169         check_user_data (dataclass, punits, indent + 2);
<a name="l02170"></a>02170         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02171"></a>02171     }
<a name="l02172"></a>02172 
<a name="l02173"></a>02173 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l02174"></a>02174 <span class="preprocessor"></span>
<a name="l02175"></a>02175     <span class="comment">/* EM electric field model */</span>
<a name="l02176"></a>02176 
<a name="l02177"></a>02177     <span class="keywordflow">if</span> (emelec) {
<a name="l02178"></a>02178         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#16aeb1de858c4e339991a01b728d7105">cg_model_read</a> (<span class="stringliteral">"EMElectricFieldModel_t"</span>, &amp;model))
<a name="l02179"></a>02179             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_model_read"</span>);
<a name="l02180"></a>02180         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02181"></a>02181         printf (<span class="stringliteral">"EM Electric Field Model=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6bac93eb29d890ffa5b44f83b0cb4ffd">cg_ModelTypeName</a>(model));
<a name="l02182"></a>02182         go_relative (<span class="stringliteral">"EMElectricFieldModel_t"</span>, 1, NULL);
<a name="l02183"></a>02183         check_arrays (dataclass, punits, 1, 0, indent + 2);
<a name="l02184"></a>02184         check_user_data (dataclass, punits, indent + 2);
<a name="l02185"></a>02185         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02186"></a>02186     }
<a name="l02187"></a>02187 
<a name="l02188"></a>02188     <span class="comment">/* EM magnetic field model */</span>
<a name="l02189"></a>02189 
<a name="l02190"></a>02190     <span class="keywordflow">if</span> (emmagn) {
<a name="l02191"></a>02191         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#16aeb1de858c4e339991a01b728d7105">cg_model_read</a> (<span class="stringliteral">"EMMagneticFieldModel_t"</span>, &amp;model))
<a name="l02192"></a>02192             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_model_read"</span>);
<a name="l02193"></a>02193         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02194"></a>02194         printf (<span class="stringliteral">"EM Magnetic Field Model=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6bac93eb29d890ffa5b44f83b0cb4ffd">cg_ModelTypeName</a>(model));
<a name="l02195"></a>02195         go_relative (<span class="stringliteral">"EMMagneticFieldModel_t"</span>, 1, NULL);
<a name="l02196"></a>02196         check_arrays (dataclass, punits, 1, 0, indent + 2);
<a name="l02197"></a>02197         check_user_data (dataclass, punits, indent + 2);
<a name="l02198"></a>02198         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02199"></a>02199     }
<a name="l02200"></a>02200 
<a name="l02201"></a>02201     <span class="comment">/* EM electric field model */</span>
<a name="l02202"></a>02202 
<a name="l02203"></a>02203     <span class="keywordflow">if</span> (emcond) {
<a name="l02204"></a>02204         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#16aeb1de858c4e339991a01b728d7105">cg_model_read</a> (<span class="stringliteral">"EMConductivityModel_t"</span>, &amp;model))
<a name="l02205"></a>02205             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a> (<span class="stringliteral">"cg_model_read"</span>);
<a name="l02206"></a>02206         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02207"></a>02207         printf (<span class="stringliteral">"EM Conductivity Model=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6bac93eb29d890ffa5b44f83b0cb4ffd">cg_ModelTypeName</a>(model));
<a name="l02208"></a>02208         go_relative (<span class="stringliteral">"EMConductivityModel_t"</span>, 1, NULL);
<a name="l02209"></a>02209         check_arrays (dataclass, punits, 1, 0, indent + 2);
<a name="l02210"></a>02210         check_user_data (dataclass, punits, indent + 2);
<a name="l02211"></a>02211         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02212"></a>02212     }
<a name="l02213"></a>02213 
<a name="l02214"></a>02214 <span class="preprocessor">#endif</span>
<a name="l02215"></a>02215 <span class="preprocessor"></span>
<a name="l02216"></a>02216     go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02217"></a>02217 }
<a name="l02218"></a>02218 
<a name="l02219"></a>02219 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l02220"></a>02220 
<a name="l02221"></a>02221 <span class="keyword">static</span> <span class="keywordtype">void</span> check_coordinates (<span class="keywordtype">int</span> ng)
<a name="l02222"></a>02222 {
<a name="l02223"></a>02223     <span class="keywordtype">char</span> name[33];
<a name="l02224"></a>02224     <span class="keywordtype">int</span> ierr, n, np, rind[6], rmin[3], rmax[3];
<a name="l02225"></a>02225     <span class="keywordtype">int</span> nc, ncoords, mask, coordset[4];
<a name="l02226"></a>02226     <span class="keywordtype">int</span> *punits, units[9], dataclass;
<a name="l02227"></a>02227     <span class="keywordtype">float</span> *<a class="code" href="test__exts_8c.html#b746fd2146196cc6771f0a754171181e">coord</a>, cmin, cmax;
<a name="l02228"></a>02228     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l02229"></a>02229     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1];
<a name="l02230"></a>02230 
<a name="l02231"></a>02231     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#fcbec3a6a381caa5d93df4c242c43769">cg_grid_read</a> (cgnsfn, cgnsbase, cgnszone, ng, name))
<a name="l02232"></a>02232         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_grid_read"</span>);
<a name="l02233"></a>02233     strcpy (GridCoordinate[ng-1], name);
<a name="l02234"></a>02234     printf (<span class="stringliteral">"  checking coordinates \"%s\"\n"</span>, name);
<a name="l02235"></a>02235     fflush (stdout);
<a name="l02236"></a>02236 
<a name="l02237"></a>02237     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"GridCoordinates_t"</span>, ng, NULL);
<a name="l02238"></a>02238 
<a name="l02239"></a>02239     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l02240"></a>02240         <span class="keywordtype">int</span> nd;
<a name="l02241"></a>02241         <span class="keywordtype">char</span> *desc;
<a name="l02242"></a>02242         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l02243"></a>02243         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l02244"></a>02244             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l02245"></a>02245                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l02246"></a>02246             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l02247"></a>02247                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l02248"></a>02248                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l02249"></a>02249             }
<a name="l02250"></a>02250         }
<a name="l02251"></a>02251     }
<a name="l02252"></a>02252 
<a name="l02253"></a>02253     dataclass = read_dataclass ();
<a name="l02254"></a>02254     punits = read_units (units);
<a name="l02255"></a>02255     <span class="keywordflow">if</span> (verbose) {
<a name="l02256"></a>02256         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 4);
<a name="l02257"></a>02257         <span class="keywordflow">if</span> (punits) print_units (punits, 4);
<a name="l02258"></a>02258     }
<a name="l02259"></a>02259     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>;
<a name="l02260"></a>02260     <span class="keywordflow">if</span> (!punits) punits = z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>;
<a name="l02261"></a>02261 
<a name="l02262"></a>02262     ierr = read_rind (rind);
<a name="l02263"></a>02263     <span class="keywordflow">if</span> (ierr) {
<a name="l02264"></a>02264         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_rind_read"</span>);
<a name="l02265"></a>02265         <span class="keywordflow">for</span> (n = 0; n &lt; 6; n++)
<a name="l02266"></a>02266             rind[n] = 0;
<a name="l02267"></a>02267     }
<a name="l02268"></a>02268     <span class="keywordflow">else</span> {
<a name="l02269"></a>02269         <span class="keywordflow">if</span> (verbose) {
<a name="l02270"></a>02270             printf (<span class="stringliteral">"    Rind=[%d"</span>, rind[0]);
<a name="l02271"></a>02271             <span class="keywordflow">for</span> (n = 1; n &lt; 2 * z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++)
<a name="l02272"></a>02272                 printf (<span class="stringliteral">",%d"</span>, rind[n]);
<a name="l02273"></a>02273             puts (<span class="stringliteral">"]"</span>);
<a name="l02274"></a>02274         }
<a name="l02275"></a>02275         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fedef7de5f4ce5345ffd8e2726df46e388">Unstructured</a> &amp;&amp; FileVersion &lt; 2400)
<a name="l02276"></a>02276             error (<span class="stringliteral">"rind not valid for unstructured zones"</span>);
<a name="l02277"></a>02277     }
<a name="l02278"></a>02278 
<a name="l02279"></a>02279     <span class="keywordflow">for</span> (n = 0, np = 1; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++) {
<a name="l02280"></a>02280         rmin[n] = 1;
<a name="l02281"></a>02281         rmax[n] = z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][n] + rind[2*n] + rind[2*n+1];
<a name="l02282"></a>02282         np *= rmax[n];
<a name="l02283"></a>02283     }
<a name="l02284"></a>02284     <span class="keywordflow">if</span> (NULL == (coord = (<span class="keywordtype">float</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (np * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)))) {
<a name="l02285"></a>02285         fprintf (stderr, <span class="stringliteral">"malloc failed for %d coordinate values\n"</span>, np);
<a name="l02286"></a>02286         exit (1);
<a name="l02287"></a>02287     }
<a name="l02288"></a>02288     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#21d5307228ec77940b3f412681afeb68">maxnode</a> &lt; np) z-&gt;<a class="code" href="struct_z_o_n_e.html#21d5307228ec77940b3f412681afeb68">maxnode</a> = np;
<a name="l02289"></a>02289 
<a name="l02290"></a>02290     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#b49be603b3ac68fd6862f2582a422e79">cg_ncoords</a> (cgnsfn, cgnsbase, cgnszone, &amp;ncoords))
<a name="l02291"></a>02291         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ncoords"</span>);
<a name="l02292"></a>02292     <span class="keywordflow">if</span> (ncoords &lt; PhyDim)
<a name="l02293"></a>02293         error (<span class="stringliteral">"number coordinates &lt; physical dimensions"</span>);
<a name="l02294"></a>02294     <span class="keywordflow">for</span> (n = 0; n &lt; 4; n++)
<a name="l02295"></a>02295         coordset[n] = 0;
<a name="l02296"></a>02296 
<a name="l02297"></a>02297     <span class="keywordflow">for</span> (nc = 1; nc &lt;= ncoords; nc++) {
<a name="l02298"></a>02298         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#cda3b530feeeb4ac97c7cfda688dc8ca">cg_coord_info</a> (cgnsfn, cgnsbase, cgnszone, nc, &amp;datatype, name))
<a name="l02299"></a>02299             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_coord_info"</span>);
<a name="l02300"></a>02300         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#552efda8397ec5445917bc02a64cbcb4">cg_coord_read</a> (cgnsfn, cgnsbase, cgnszone, name, <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1ca5e5244f4627fd3bf71c72015c2060">RealSingle</a>,
<a name="l02301"></a>02301                 rmin, rmax, coord))
<a name="l02302"></a>02302             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_coord_read"</span>);
<a name="l02303"></a>02303         printf (<span class="stringliteral">"    checking coordinate \"%s\"\n"</span>, name);
<a name="l02304"></a>02304         fflush (stdout);
<a name="l02305"></a>02305         cmin = cmax = coord[0];
<a name="l02306"></a>02306         <span class="keywordflow">for</span> (n = 1; n &lt; np; n++) {
<a name="l02307"></a>02307             <span class="keywordflow">if</span> (cmin &gt; coord[n]) cmin = coord[n];
<a name="l02308"></a>02308             <span class="keywordflow">if</span> (cmax &lt; coord[n]) cmax = coord[n];
<a name="l02309"></a>02309         }
<a name="l02310"></a>02310         <span class="keywordflow">if</span> (verbose)
<a name="l02311"></a>02311             printf(<span class="stringliteral">"      Coordinate Range=%g -&gt; %g (%g)\n"</span>,
<a name="l02312"></a>02312                 cmin, cmax, cmax-cmin);
<a name="l02313"></a>02313         <span class="keywordflow">if</span> (cmin == cmax)
<a name="l02314"></a>02314             warning(1, <span class="stringliteral">"coordinate range is 0"</span>);
<a name="l02315"></a>02315         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"CoordinateX"</span>))
<a name="l02316"></a>02316             coordset[0] |= 1;
<a name="l02317"></a>02317         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"CoordinateY"</span>))
<a name="l02318"></a>02318             coordset[0] |= 2;
<a name="l02319"></a>02319         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"CoordinateZ"</span>)) {
<a name="l02320"></a>02320             coordset[0] |= 4;
<a name="l02321"></a>02321             coordset[1] |= 4;
<a name="l02322"></a>02322         }
<a name="l02323"></a>02323         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"CoordinateR"</span>))
<a name="l02324"></a>02324             coordset[1] |= 1;
<a name="l02325"></a>02325         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"CoordinateTheta"</span>)) {
<a name="l02326"></a>02326             coordset[1] |= 2;
<a name="l02327"></a>02327             coordset[2] |= 2;
<a name="l02328"></a>02328         }
<a name="l02329"></a>02329         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"CoordinatePhi"</span>))
<a name="l02330"></a>02330             coordset[2] |= 4;
<a name="l02331"></a>02331         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"CoordinateXi"</span>))
<a name="l02332"></a>02332             coordset[3] |= 1;
<a name="l02333"></a>02333         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"CoordinateEta"</span>))
<a name="l02334"></a>02334             coordset[3] |= 2;
<a name="l02335"></a>02335         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"CoordinateZeta"</span>))
<a name="l02336"></a>02336             coordset[3] |= 4;
<a name="l02337"></a>02337         check_quantity (nc, name, dataclass, punits, 1, 6);
<a name="l02338"></a>02338     }
<a name="l02339"></a>02339     <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (coord);
<a name="l02340"></a>02340 
<a name="l02341"></a>02341     <span class="keywordflow">for</span> (mask = 0, n = 0; n &lt; PhyDim; n++)
<a name="l02342"></a>02342         mask |= (1 &lt;&lt; n);
<a name="l02343"></a>02343     <span class="keywordflow">for</span> (n = 0; n &lt; 4; n++) {
<a name="l02344"></a>02344         <span class="keywordflow">if</span> ((coordset[n] &amp; mask) == mask) <span class="keywordflow">break</span>;
<a name="l02345"></a>02345     }
<a name="l02346"></a>02346     <span class="keywordflow">if</span> (n == 4)
<a name="l02347"></a>02347         error (<span class="stringliteral">"a complete coordinate system was not found"</span>);
<a name="l02348"></a>02348 }
<a name="l02349"></a>02349 
<a name="l02350"></a>02350 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l02351"></a>02351 
<a name="l02352"></a>02352 <span class="keyword">static</span> <span class="keywordtype">void</span> check_elements (<span class="keywordtype">void</span>)
<a name="l02353"></a>02353 {
<a name="l02354"></a>02354     <span class="keywordtype">int</span> i, j, n, nn, ns, nelem, ne, *pe;
<a name="l02355"></a>02355     <span class="keywordtype">int</span> type, is, nf, np, nint, next;
<a name="l02356"></a>02356     <a class="code" href="struct_e_l_e_m_s_e_t.html">ELEMSET</a> *es;
<a name="l02357"></a>02357     <a class="code" href="struct_f_a_c_e.html">FACE</a> *face, *pf;
<a name="l02358"></a>02358     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1];
<a name="l02359"></a>02359 
<a name="l02360"></a>02360     puts (<span class="stringliteral">"  checking elements"</span>);
<a name="l02361"></a>02361     <span class="keywordflow">if</span> (verbose) {
<a name="l02362"></a>02362         printf (<span class="stringliteral">"    Number Element Sets=%d\n"</span>, z-&gt;<a class="code" href="struct_z_o_n_e.html#dbfb774fafdb2da3e35a7de16db65c3c">nsets</a>);
<a name="l02363"></a>02363         printf (<span class="stringliteral">"    [0D,1D,2D,3D] Elements=[%d,%d,%d,%d]\n"</span>,
<a name="l02364"></a>02364             z-&gt;<a class="code" href="struct_z_o_n_e.html#a440d0e525bda85d07f367d87d7dd86f">nn</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#3bf1137663f19e5c361c845cf4dfb7db">ne</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ab6822646f9a53265acb577886434744">nv</a>);
<a name="l02365"></a>02365         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a>)
<a name="l02366"></a>02366             printf (<span class="stringliteral">"    Number Volume Faces=%d\n"</span>, <a class="code" href="hash_8h.html#14844a4274e5559fed6059e3da31a819">HashSize</a>(z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a>));
<a name="l02367"></a>02367     }
<a name="l02368"></a>02368     fflush (stdout);
<a name="l02369"></a>02369 
<a name="l02370"></a>02370     nelem = <a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a> == 2 ? z-&gt;<a class="code" href="struct_z_o_n_e.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a> : z-&gt;<a class="code" href="struct_z_o_n_e.html#ab6822646f9a53265acb577886434744">nv</a>;
<a name="l02371"></a>02371     <span class="keywordflow">if</span> (nelem &lt; z-&gt;dims[1][0])
<a name="l02372"></a>02372         error (<span class="stringliteral">"number %dD elements &lt; specified in zone dimensions"</span>, <a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a>);
<a name="l02373"></a>02373     <span class="keywordflow">if</span> (nelem &gt; z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][0])
<a name="l02374"></a>02374         warning (1, <span class="stringliteral">"number %dD elements &gt; specified in zone dimensions"</span>,
<a name="l02375"></a>02375             <a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a>);
<a name="l02376"></a>02376     <span class="keywordflow">if</span> (<a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a> == 3 &amp;&amp; z-&gt;<a class="code" href="struct_z_o_n_e.html#ab6822646f9a53265acb577886434744">nv</a> == 0)
<a name="l02377"></a>02377         error (<span class="stringliteral">"no 3D elements exist and CellDim is 3"</span>);
<a name="l02378"></a>02378     <span class="keywordflow">if</span> (<a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a> == 2) {
<a name="l02379"></a>02379         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ab6822646f9a53265acb577886434744">nv</a>)
<a name="l02380"></a>02380             error (<span class="stringliteral">"3D elements exist and CellDim is 2"</span>);
<a name="l02381"></a>02381         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a> == 0)
<a name="l02382"></a>02382             error (<span class="stringliteral">"no 2D elements exist and CellDim is 2"</span>);
<a name="l02383"></a>02383     }
<a name="l02384"></a>02384 
<a name="l02385"></a>02385     is = z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a>;
<a name="l02386"></a>02386     <span class="keywordflow">if</span> (is != 1)
<a name="l02387"></a>02387         warning (1, <span class="stringliteral">"element numbering does not start at 1"</span>);
<a name="l02388"></a>02388 
<a name="l02389"></a>02389     <span class="comment">/* check element sets */</span>
<a name="l02390"></a>02390 
<a name="l02391"></a>02391     <span class="keywordflow">for</span> (es = z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>, ns = 0; ns &lt; z-&gt;nsets; ns++, es++) {
<a name="l02392"></a>02392         printf (<span class="stringliteral">"  checking element set \"%s\"\n"</span>, es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7913ace0d483311647b8d88f795c6bfd">name</a>);
<a name="l02393"></a>02393         <span class="keywordflow">if</span> (verbose) {
<a name="l02394"></a>02394             printf (<span class="stringliteral">"    Element Set Type=%s\n"</span>,
<a name="l02395"></a>02395                 <a class="code" href="cgnslib_8c.html#5cec8db897d2366775cd9d70aa95430d">cg_ElementTypeName</a>(es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a>));
<a name="l02396"></a>02396             printf (<span class="stringliteral">"    Element Range=[%d,%d]\n"</span>, es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a>, es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#bc49be9d75acbce7b44e88a9d2a8f3cc">ie</a>);
<a name="l02397"></a>02397             <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] || es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1])
<a name="l02398"></a>02398                 printf (<span class="stringliteral">"    Rind Elements=[%d,%d]\n"</span>,
<a name="l02399"></a>02399                     es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0], es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1]);
<a name="l02400"></a>02400             printf (<span class="stringliteral">"    [0D,1D,2D,3D] Elements=[%d,%d,%d,%d]\n"</span>,
<a name="l02401"></a>02401                 es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#a440d0e525bda85d07f367d87d7dd86f">nn</a>, es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#3bf1137663f19e5c361c845cf4dfb7db">ne</a>, es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a>, es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#ab6822646f9a53265acb577886434744">nv</a>);
<a name="l02402"></a>02402         }
<a name="l02403"></a>02403         <span class="keywordflow">if</span> (ns &amp;&amp; z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> != is)
<a name="l02404"></a>02404             warning (1, <span class="stringliteral">"element numbers are not consecutative with \"%s\""</span>,
<a name="l02405"></a>02405                 z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns-1].<a class="code" href="struct_e_l_e_m_s_e_t.html#7913ace0d483311647b8d88f795c6bfd">name</a>);
<a name="l02406"></a>02406         is = z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#bc49be9d75acbce7b44e88a9d2a8f3cc">ie</a> + 1;
<a name="l02407"></a>02407         <span class="keywordflow">for</span> (nn = 0; nn &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#dbfb774fafdb2da3e35a7de16db65c3c">nsets</a>; nn++) {
<a name="l02408"></a>02408             <span class="keywordflow">if</span> (nn != ns) {
<a name="l02409"></a>02409                 <span class="keywordflow">if</span> ((z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[nn].<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> &gt;= z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> &amp;&amp;
<a name="l02410"></a>02410                      z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[nn].<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> &lt;= z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#bc49be9d75acbce7b44e88a9d2a8f3cc">ie</a>) ||
<a name="l02411"></a>02411                     (z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[nn].<a class="code" href="struct_e_l_e_m_s_e_t.html#bc49be9d75acbce7b44e88a9d2a8f3cc">ie</a> &gt;= z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> &amp;&amp;
<a name="l02412"></a>02412                      z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[nn].<a class="code" href="struct_e_l_e_m_s_e_t.html#bc49be9d75acbce7b44e88a9d2a8f3cc">ie</a> &lt;= z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[ns].<a class="code" href="struct_e_l_e_m_s_e_t.html#bc49be9d75acbce7b44e88a9d2a8f3cc">ie</a>))
<a name="l02413"></a>02413                     error (<span class="stringliteral">"element numbers overlap those for \"%s\""</span>,
<a name="l02414"></a>02414                         z-&gt;<a class="code" href="struct_z_o_n_e.html#2c524f9a41bc61d94fa88f33f146fca8">sets</a>[nn].<a class="code" href="struct_e_l_e_m_s_e_t.html#7913ace0d483311647b8d88f795c6bfd">name</a>);
<a name="l02415"></a>02415             }
<a name="l02416"></a>02416         }
<a name="l02417"></a>02417 
<a name="l02418"></a>02418         <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> &lt; 0) {
<a name="l02419"></a>02419             <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> == -1)
<a name="l02420"></a>02420                 printf (<span class="stringliteral">"INTERNAL:can't handle %s element set\n"</span>,
<a name="l02421"></a>02421                     <a class="code" href="cgnslib_8c.html#5cec8db897d2366775cd9d70aa95430d">cg_ElementTypeName</a>(es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a>));
<a name="l02422"></a>02422             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> == -2)
<a name="l02423"></a>02423                 error (<span class="stringliteral">"MIXED elements not allowed in a MIXED element set"</span>);
<a name="l02424"></a>02424             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> == -3)
<a name="l02425"></a>02425                 printf(<span class="stringliteral">"INTERNAL: error with element size in MIXED\n"</span>);
<a name="l02426"></a>02426             <span class="keywordflow">else</span>
<a name="l02427"></a>02427                 printf(<span class="stringliteral">"INTERNAL: error processing element set\n"</span>);
<a name="l02428"></a>02428             <span class="keywordflow">continue</span>;
<a name="l02429"></a>02429         }
<a name="l02430"></a>02430         <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a> &gt; 0) {
<a name="l02431"></a>02431 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000        </span>
<a name="l02432"></a>02432 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0e0679c83d873c5c154531805e030a0f2">NFACE_n</a>) {
<a name="l02433"></a>02433                 error (<span class="stringliteral">"%d polyhedra faces are not valid face elements"</span>,
<a name="l02434"></a>02434                     es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a>);
<a name="l02435"></a>02435                 <span class="keywordflow">continue</span>;
<a name="l02436"></a>02436             }
<a name="l02437"></a>02437 <span class="preprocessor">#endif</span>
<a name="l02438"></a>02438 <span class="preprocessor"></span>            error (<span class="stringliteral">"%d element nodes are out of range"</span>, es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c49297f8e1f3b637e1353132b1e1fb76">invalid</a>);
<a name="l02439"></a>02439             <span class="keywordflow">continue</span>;
<a name="l02440"></a>02440         }
<a name="l02441"></a>02441         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a> == NULL || es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e83bd7735d1f2d707f5d341c8e61d1e">ns</a> == 0 || es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> &lt; <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0a0e5d91e4ed7ef55d759173086df2382">TRI_3</a>)
<a name="l02442"></a>02442             <span class="keywordflow">continue</span>;
<a name="l02443"></a>02443         <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> &gt; <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0f38a9dc0e0d293d1293cdb706729aac4">QUAD_9</a> &amp;&amp; es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> != <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac055c2b4d0f7ac387d0c7216f597dfacd3">MIXED</a>) {
<a name="l02444"></a>02444 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000</span>
<a name="l02445"></a>02445 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> != NGON_n)
<a name="l02446"></a>02446 <span class="preprocessor">#endif</span>
<a name="l02447"></a>02447 <span class="preprocessor"></span>            <span class="keywordflow">continue</span>;
<a name="l02448"></a>02448         }            
<a name="l02449"></a>02449 
<a name="l02450"></a>02450         nelem = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#bc49be9d75acbce7b44e88a9d2a8f3cc">ie</a> - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#c512c16608df2f12bbafd7be3caba52c">is</a> + 1 - es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[1];
<a name="l02451"></a>02451         type = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a>;
<a name="l02452"></a>02452         pe = es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a>;
<a name="l02453"></a>02453         nf = np = nint = next = 0;
<a name="l02454"></a>02454         <span class="keywordflow">for</span> (ne = 0; ne &lt; nelem; ne++) {
<a name="l02455"></a>02455             <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac055c2b4d0f7ac387d0c7216f597dfacd3">MIXED</a>) {
<a name="l02456"></a>02456                 type = (<a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0">ElementType_t</a>)*pe++;
<a name="l02457"></a>02457                 <span class="keywordflow">if</span> (type &gt;= NGON_n) {
<a name="l02458"></a>02458                     nn = (int)(type - NGON_n);
<a name="l02459"></a>02459                     type = NGON_n;
<a name="l02460"></a>02460                 }
<a name="l02461"></a>02461                 <span class="keywordflow">else</span> {
<a name="l02462"></a>02462                     <a class="code" href="cgnslib_8c.html#e7291fb6c47f4ff621c022dc5522f48b">cg_npe</a> (type, &amp;nn);
<a name="l02463"></a>02463                 }
<a name="l02464"></a>02464             }
<a name="l02465"></a>02465 <span class="preprocessor">#if CGNS_VERSION &gt;= 3000        </span>
<a name="l02466"></a>02466 <span class="preprocessor"></span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#68077f9f9dac7c90b4143c061781f12c">type</a> == NGON_n) {
<a name="l02467"></a>02467                 nn = *pe++;
<a name="l02468"></a>02468             }
<a name="l02469"></a>02469 <span class="preprocessor">#endif            </span>
<a name="l02470"></a>02470 <span class="preprocessor"></span>            <span class="keywordflow">else</span> {
<a name="l02471"></a>02471                 <a class="code" href="cgnslib_8c.html#e7291fb6c47f4ff621c022dc5522f48b">cg_npe</a> (type, &amp;nn);
<a name="l02472"></a>02472             }
<a name="l02473"></a>02473             <span class="keywordflow">if</span> (ne &gt;= es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#7f0a5feefdbda5632848ab0715c4c3dc">rind</a>[0] &amp;&amp; nn &gt;= 3 &amp;&amp; (type == NGON_n ||
<a name="l02474"></a>02474                (type &gt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0a0e5d91e4ed7ef55d759173086df2382">TRI_3</a> &amp;&amp; type &lt;= <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0f38a9dc0e0d293d1293cdb706729aac4">QUAD_9</a>))) {
<a name="l02475"></a>02475 <span class="preprocessor">#ifndef USE_MID_NODES</span>
<a name="l02476"></a>02476 <span class="preprocessor"></span>                <span class="keywordflow">if</span> (type == <a class="code" href="cgns_keywords_8h.html#4431a6cae8c3c9182a415851144aeac0f38a9dc0e0d293d1293cdb706729aac4">QUAD_9</a>)
<a name="l02477"></a>02477                     face = new_face (8, pe);
<a name="l02478"></a>02478                 <span class="keywordflow">else</span>
<a name="l02479"></a>02479 <span class="preprocessor">#endif                               </span>
<a name="l02480"></a>02480 <span class="preprocessor"></span>                face = new_face (nn, pe);
<a name="l02481"></a>02481                 pf = (<a class="code" href="struct_f_a_c_e.html">FACE</a> *) <a class="code" href="hash_8c.html#3067efda339f6d8987b72e7712864cd5">HashFind</a> (z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a>, face);
<a name="l02482"></a>02482                 <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (face);
<a name="l02483"></a>02483                 <span class="keywordflow">if</span> (pf == NULL)
<a name="l02484"></a>02484                     nf++;
<a name="l02485"></a>02485                 <span class="keywordflow">else</span> {
<a name="l02486"></a>02486                     <span class="keywordflow">if</span> (pf-&gt;<a class="code" href="struct_f_a_c_e.html#be2d58850d42470d1973f25924c00c47">e2</a>)
<a name="l02487"></a>02487                         nint++;
<a name="l02488"></a>02488                     <span class="keywordflow">else</span>
<a name="l02489"></a>02489                         next++;
<a name="l02490"></a>02490                     <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>) {
<a name="l02491"></a>02491                         n = ne + nelem;
<a name="l02492"></a>02492                         i = n + nelem;
<a name="l02493"></a>02493                         j = i + nelem;
<a name="l02494"></a>02494                         <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>[ne] == pf-&gt;<a class="code" href="struct_f_a_c_e.html#31466fc672991029a5d7a12c53b6ad5f">e1</a>) {
<a name="l02495"></a>02495                             <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>[i] != pf-&gt;<a class="code" href="struct_f_a_c_e.html#a75d52109f3f1fa6e40768b15db2814f">f1</a> ||
<a name="l02496"></a>02496                                 es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>[n] != pf-&gt;<a class="code" href="struct_f_a_c_e.html#be2d58850d42470d1973f25924c00c47">e2</a> ||
<a name="l02497"></a>02497                                 es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>[j] != pf-&gt;<a class="code" href="struct_f_a_c_e.html#4a0019706837babe79e30464d98c3575">f2</a>) np++;
<a name="l02498"></a>02498                         }
<a name="l02499"></a>02499                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>[ne] == pf-&gt;<a class="code" href="struct_f_a_c_e.html#be2d58850d42470d1973f25924c00c47">e2</a>) {
<a name="l02500"></a>02500                             <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>[i] != pf-&gt;<a class="code" href="struct_f_a_c_e.html#4a0019706837babe79e30464d98c3575">f2</a> ||
<a name="l02501"></a>02501                                 es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>[n] != pf-&gt;<a class="code" href="struct_f_a_c_e.html#31466fc672991029a5d7a12c53b6ad5f">e1</a> ||
<a name="l02502"></a>02502                                 es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>[j] != pf-&gt;<a class="code" href="struct_f_a_c_e.html#a75d52109f3f1fa6e40768b15db2814f">f1</a>) np++;
<a name="l02503"></a>02503                         }
<a name="l02504"></a>02504                         <span class="keywordflow">else</span>
<a name="l02505"></a>02505                             np++;
<a name="l02506"></a>02506                     }
<a name="l02507"></a>02507                 }
<a name="l02508"></a>02508             }
<a name="l02509"></a>02509             pe += nn;
<a name="l02510"></a>02510         }
<a name="l02511"></a>02511 
<a name="l02512"></a>02512         <span class="keywordflow">if</span> (verbose)
<a name="l02513"></a>02513             printf (<span class="stringliteral">"    [internal,external] Faces=[%d,%d]\n"</span>, nint, next);
<a name="l02514"></a>02514         <span class="keywordflow">if</span> (nf)
<a name="l02515"></a>02515             warning (1, <span class="stringliteral">"%d faces are not faces of the volume elements"</span>, nf);
<a name="l02516"></a>02516         <span class="keywordflow">if</span> (np)
<a name="l02517"></a>02517             error (<span class="stringliteral">"%d faces have invalid parent data"</span>, np);
<a name="l02518"></a>02518         <span class="keywordflow">if</span> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>) {
<a name="l02519"></a>02519             <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a>);
<a name="l02520"></a>02520             es-&gt;<a class="code" href="struct_e_l_e_m_s_e_t.html#8e99857563320b5d943128e5816b1d70">parent</a> = NULL;
<a name="l02521"></a>02521         }
<a name="l02522"></a>02522     }
<a name="l02523"></a>02523 }
<a name="l02524"></a>02524 
<a name="l02525"></a>02525 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l02526"></a>02526 
<a name="l02527"></a>02527 <span class="keyword">static</span> <span class="keywordtype">void</span> check_struct_interface (<a class="code" href="struct_z_o_n_e.html">ZONE</a> *z, <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5">PointSetType_t</a> ptype,
<a name="l02528"></a>02528     <span class="keywordtype">int</span> <a class="code" href="write__test_8c.html#0306378cd06415f84b10cb3d15516ec3">npts</a>, <span class="keywordtype">int</span> *<a class="code" href="write__test_8c.html#de210b89faf6a7c4fa772e5cd9946e41">pts</a>, <span class="keywordtype">int</span> bndry)
<a name="l02529"></a>02529 {
<a name="l02530"></a>02530     <span class="keywordtype">int</span> n, id, np, n1, n2, n3, nerr1, nerr2;
<a name="l02531"></a>02531 
<a name="l02532"></a>02532     nerr1 = nerr2 = 0;
<a name="l02533"></a>02533 
<a name="l02534"></a>02534     <span class="comment">/* vertices */</span>
<a name="l02535"></a>02535 
<a name="l02536"></a>02536     <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d9df12b6366abf1175abbfca72f5f43e">PointList</a>) {
<a name="l02537"></a>02537         <span class="keywordflow">for</span> (n = 0, np = 0; np &lt; npts; np++) {
<a name="l02538"></a>02538             n1 = n2 = 0;
<a name="l02539"></a>02539             <span class="keywordflow">for</span> (<span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; <span class="keywordtype">id</span>++) {
<a name="l02540"></a>02540                 <span class="keywordflow">if</span> (pts[n] &lt; 1 || pts[n] &gt; z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][<span class="keywordtype">id</span>])
<a name="l02541"></a>02541                     n1++;
<a name="l02542"></a>02542                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pts[n] == 1 || pts[n] == z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][<span class="keywordtype">id</span>])
<a name="l02543"></a>02543                     n2++;
<a name="l02544"></a>02544                 n++;
<a name="l02545"></a>02545             }
<a name="l02546"></a>02546             <span class="keywordflow">if</span> (n1) nerr1++;
<a name="l02547"></a>02547             <span class="keywordflow">if</span> (!n2) nerr2++;
<a name="l02548"></a>02548         }
<a name="l02549"></a>02549         <span class="keywordflow">if</span> (nerr1)
<a name="l02550"></a>02550             error (<span class="stringliteral">"%d points are out of range"</span>, nerr1);
<a name="l02551"></a>02551         <span class="keywordflow">if</span> (nerr2 &amp;&amp; bndry)
<a name="l02552"></a>02552             warning (2, <span class="stringliteral">"%d points are not boundary points"</span>, nerr2);
<a name="l02553"></a>02553         <span class="keywordflow">return</span>;
<a name="l02554"></a>02554     }
<a name="l02555"></a>02555 
<a name="l02556"></a>02556     <span class="comment">/* faces */</span>
<a name="l02557"></a>02557 
<a name="l02558"></a>02558     <span class="keywordflow">if</span> (bndry) {
<a name="l02559"></a>02559         <span class="keywordflow">for</span> (n = 0, np = 0; np &lt; npts; np++) {
<a name="l02560"></a>02560             n1 = n2 = n3 = 0;
<a name="l02561"></a>02561             <span class="keywordflow">for</span> (<span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; <span class="keywordtype">id</span>++) {
<a name="l02562"></a>02562                 <span class="keywordflow">if</span> (pts[n] &lt; 1 || pts[n] &gt; z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][<span class="keywordtype">id</span>])
<a name="l02563"></a>02563                     n1++;
<a name="l02564"></a>02564                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pts[n] == 1)
<a name="l02565"></a>02565                     n2++;
<a name="l02566"></a>02566                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pts[n] == z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][<span class="keywordtype">id</span>])
<a name="l02567"></a>02567                     n3++;
<a name="l02568"></a>02568                 n++;
<a name="l02569"></a>02569             }
<a name="l02570"></a>02570             <span class="keywordflow">if</span> (n1 || n3 &gt; 1) nerr1++;
<a name="l02571"></a>02571             <span class="keywordflow">if</span> (!n2 &amp;&amp; !n3) nerr2++;
<a name="l02572"></a>02572         }
<a name="l02573"></a>02573     }
<a name="l02574"></a>02574 
<a name="l02575"></a>02575     <span class="comment">/* cells */</span>
<a name="l02576"></a>02576 
<a name="l02577"></a>02577     <span class="keywordflow">else</span> {
<a name="l02578"></a>02578         <span class="keywordflow">for</span> (n = 0, np = 0; np &lt; npts; np++) {
<a name="l02579"></a>02579             n1 = 0;
<a name="l02580"></a>02580             <span class="keywordflow">for</span> (<span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; <span class="keywordtype">id</span>++) {
<a name="l02581"></a>02581                 <span class="keywordflow">if</span> (pts[n+<span class="keywordtype">id</span>] &lt; 1 || pts[n+<span class="keywordtype">id</span>] &gt;= z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][<span class="keywordtype">id</span>])
<a name="l02582"></a>02582                     n1++;
<a name="l02583"></a>02583                 n++;
<a name="l02584"></a>02584             }
<a name="l02585"></a>02585             <span class="keywordflow">if</span> (n1) nerr1++;
<a name="l02586"></a>02586         }
<a name="l02587"></a>02587     }
<a name="l02588"></a>02588 
<a name="l02589"></a>02589     <span class="keywordflow">if</span> (nerr1)
<a name="l02590"></a>02590         error (<span class="stringliteral">"%d elements are out of range"</span>, nerr1);
<a name="l02591"></a>02591     <span class="keywordflow">if</span> (nerr2)
<a name="l02592"></a>02592         warning (2, <span class="stringliteral">"%d elements are not boundary elements"</span>, nerr2);
<a name="l02593"></a>02593 }
<a name="l02594"></a>02594 
<a name="l02595"></a>02595 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l02596"></a>02596 
<a name="l02597"></a>02597 <span class="keyword">static</span> <span class="keywordtype">void</span> check_unstruct_interface (<a class="code" href="struct_z_o_n_e.html">ZONE</a> *z, <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5">PointSetType_t</a> ptype,
<a name="l02598"></a>02598     <span class="keywordtype">int</span> npts, <span class="keywordtype">int</span> *pts, <span class="keywordtype">int</span> bndry)
<a name="l02599"></a>02599 {
<a name="l02600"></a>02600     <span class="keywordtype">int</span> dim, n, nn, id, nerr1, nerr2, nerr3, *nodes;
<a name="l02601"></a>02601     <a class="code" href="struct_f_a_c_e.html">FACE</a> *face, *pf;
<a name="l02602"></a>02602 
<a name="l02603"></a>02603     nerr1 = nerr2 = nerr3 = 0;
<a name="l02604"></a>02604 
<a name="l02605"></a>02605     <span class="comment">/* vertices */</span>
<a name="l02606"></a>02606 
<a name="l02607"></a>02607     <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d9df12b6366abf1175abbfca72f5f43e">PointList</a>) {
<a name="l02608"></a>02608         <span class="keywordflow">for</span> (n = 0; n &lt; npts; n++) {
<a name="l02609"></a>02609             <span class="keywordflow">if</span> (pts[n] &lt; 1 || pts[n] &gt; z-&gt;<a class="code" href="struct_z_o_n_e.html#824ac1af8a4229ed37411081a1ffd928">nnodes</a>) nerr1++;
<a name="l02610"></a>02610         }
<a name="l02611"></a>02611         <span class="keywordflow">if</span> (nerr1)
<a name="l02612"></a>02612             error (<span class="stringliteral">"%d node numbers are out of range"</span>, nerr1);
<a name="l02613"></a>02613         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#316acbd53e045949fbce31ae6f7366f1">nextnodes</a> &amp;&amp; bndry) {
<a name="l02614"></a>02614             <span class="keywordflow">for</span> (n = 0; n &lt; npts; n++) {
<a name="l02615"></a>02615                 <span class="keywordflow">if</span> (!find_extnode (z, pts[n])) nerr2++;
<a name="l02616"></a>02616             }
<a name="l02617"></a>02617             <span class="keywordflow">if</span> (nerr2)
<a name="l02618"></a>02618                 warning (2, <span class="stringliteral">"%d nodes are not boundary nodes"</span>, nerr2);
<a name="l02619"></a>02619         }
<a name="l02620"></a>02620         <span class="keywordflow">return</span>;
<a name="l02621"></a>02621     }
<a name="l02622"></a>02622 
<a name="l02623"></a>02623     <span class="comment">/* elements */</span>
<a name="l02624"></a>02624 
<a name="l02625"></a>02625     dim = bndry ? <a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a> - 1 : <a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a>;
<a name="l02626"></a>02626 
<a name="l02627"></a>02627     <span class="keywordflow">for</span> (n = 0; n &lt; npts; n++) {
<a name="l02628"></a>02628         nodes = find_element (z, pts[n], &amp;<span class="keywordtype">id</span>, &amp;nn);
<a name="l02629"></a>02629         <span class="keywordflow">if</span> (nodes == NULL)
<a name="l02630"></a>02630             nerr1++;
<a name="l02631"></a>02631         <span class="keywordflow">else</span> {
<a name="l02632"></a>02632             <span class="keywordflow">if</span> (<span class="keywordtype">id</span> != dim) nerr2++;
<a name="l02633"></a>02633             <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a> != NULL &amp;&amp; <span class="keywordtype">id</span> == 2 &amp;&amp; nn &gt; 2) {
<a name="l02634"></a>02634                 face = new_face (nn, nodes);
<a name="l02635"></a>02635                 pf = (<a class="code" href="struct_f_a_c_e.html">FACE</a> *) <a class="code" href="hash_8c.html#3067efda339f6d8987b72e7712864cd5">HashFind</a> (z-&gt;<a class="code" href="struct_z_o_n_e.html#7f82ed85aac3a948d9a07a1294dee4de">faces</a>, face);
<a name="l02636"></a>02636                 <span class="keywordflow">if</span> (pf == NULL || pf-&gt;<a class="code" href="struct_f_a_c_e.html#be2d58850d42470d1973f25924c00c47">e2</a>) nerr3++;
<a name="l02637"></a>02637                 <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (face);
<a name="l02638"></a>02638             }
<a name="l02639"></a>02639         }
<a name="l02640"></a>02640     }
<a name="l02641"></a>02641     <span class="keywordflow">if</span> (nerr1)
<a name="l02642"></a>02642         error (<span class="stringliteral">"%d element numbers are out of range"</span>, nerr1);
<a name="l02643"></a>02643     <span class="keywordflow">if</span> (nerr2)
<a name="l02644"></a>02644         warning (1, <span class="stringliteral">"%d elements have invalid dimension"</span>, nerr2);
<a name="l02645"></a>02645     <span class="keywordflow">if</span> (nerr3 &amp;&amp; bndry)
<a name="l02646"></a>02646         warning (2, <span class="stringliteral">"%d elements are not boundary elements"</span>, nerr3);
<a name="l02647"></a>02647 }
<a name="l02648"></a>02648 
<a name="l02649"></a>02649 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l02650"></a>02650 
<a name="l02651"></a>02651 <span class="keyword">static</span> <span class="keywordtype">int</span> check_interface (<a class="code" href="struct_z_o_n_e.html">ZONE</a> *z, <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5">PointSetType_t</a> ptype,
<a name="l02652"></a>02652     <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> location, <span class="keywordtype">int</span> npts, <span class="keywordtype">int</span> *pts, <span class="keywordtype">int</span> bndry)
<a name="l02653"></a>02653 {
<a name="l02654"></a>02654     <span class="keywordtype">int</span> np, *p;
<a name="l02655"></a>02655 
<a name="l02656"></a>02656     <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d2e439dbdf858e41f5c29dd5d778bb70">PointListDonor</a>) ptype = <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d9df12b6366abf1175abbfca72f5f43e">PointList</a>;
<a name="l02657"></a>02657     <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5bbbff63b3b10923bda220174f8603760">CellListDonor</a>) ptype = <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f564fbbf86f8130201d7e4c75dfb1a59bf">ElementList</a>;
<a name="l02658"></a>02658     <span class="keywordflow">if</span> (ptype != <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a>   &amp;&amp; ptype != <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d9df12b6366abf1175abbfca72f5f43e">PointList</a> &amp;&amp;
<a name="l02659"></a>02659         ptype != <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a> &amp;&amp; ptype != <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f564fbbf86f8130201d7e4c75dfb1a59bf">ElementList</a>) {
<a name="l02660"></a>02660         error (<span class="stringliteral">"invalid point type"</span>);
<a name="l02661"></a>02661         <span class="keywordflow">return</span> 0;
<a name="l02662"></a>02662     }
<a name="l02663"></a>02663     <span class="keywordflow">if</span> (location &lt; Vertex || location &gt;= <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1320321805f8609b15483a7cd6e15e2d87">EdgeCenter</a>) {
<a name="l02664"></a>02664         error (<span class="stringliteral">"invalid grid location"</span>);
<a name="l02665"></a>02665         <span class="keywordflow">return</span> 0;
<a name="l02666"></a>02666     }
<a name="l02667"></a>02667     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> &lt; 1 || z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> &gt; 3) {
<a name="l02668"></a>02668         warning (1, <span class="stringliteral">"can't evaluate since zone \"%s\" in invalid"</span>, z-&gt;<a class="code" href="struct_z_o_n_e.html#7913ace0d483311647b8d88f795c6bfd">name</a>);
<a name="l02669"></a>02669         <span class="keywordflow">return</span> 0;
<a name="l02670"></a>02670     }
<a name="l02671"></a>02671 
<a name="l02672"></a>02672     <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a> &amp;&amp; location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>) ptype = <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a>;
<a name="l02673"></a>02673     <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d9df12b6366abf1175abbfca72f5f43e">PointList</a>  &amp;&amp; location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>) ptype = <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f564fbbf86f8130201d7e4c75dfb1a59bf">ElementList</a>;
<a name="l02674"></a>02674 
<a name="l02675"></a>02675     <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a> || ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a>) {
<a name="l02676"></a>02676         <span class="keywordtype">int</span> n, i, j, k;
<a name="l02677"></a>02677         <span class="keywordtype">int</span> pmin[3], pmax[3];
<a name="l02678"></a>02678         <span class="keywordflow">for</span> (np = 1, n = 0; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++) {
<a name="l02679"></a>02679             <span class="keywordflow">if</span> (pts[n] &lt; pts[n+z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>]) {
<a name="l02680"></a>02680                 pmin[n] = pts[n];
<a name="l02681"></a>02681                 pmax[n] = pts[n+z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>];
<a name="l02682"></a>02682             }
<a name="l02683"></a>02683             <span class="keywordflow">else</span> {
<a name="l02684"></a>02684                 pmin[n] = pts[n+z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>];
<a name="l02685"></a>02685                 pmax[n] = pts[n];
<a name="l02686"></a>02686             }
<a name="l02687"></a>02687             np *= (pmax[n] - pmin[n] + 1);
<a name="l02688"></a>02688         }
<a name="l02689"></a>02689         p = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (np * z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02690"></a>02690         <span class="keywordflow">if</span> (p == NULL) {
<a name="l02691"></a>02691             fprintf (stderr, <span class="stringliteral">"malloc failed for point/element list\n"</span>);
<a name="l02692"></a>02692             exit (1);
<a name="l02693"></a>02693         }
<a name="l02694"></a>02694         n = 0;
<a name="l02695"></a>02695         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> == 1) {
<a name="l02696"></a>02696             <span class="keywordflow">for</span> (i = pmin[0]; i &lt;= pmax[0]; i++)
<a name="l02697"></a>02697                 p[n++] = i;
<a name="l02698"></a>02698         }
<a name="l02699"></a>02699         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> == 2) {
<a name="l02700"></a>02700             <span class="keywordflow">for</span> (i = pmin[0]; i &lt;= pmax[0]; i++) {
<a name="l02701"></a>02701                 <span class="keywordflow">for</span> (j = pmin[1]; j &lt;= pmax[1]; j++) {
<a name="l02702"></a>02702                     p[n++] = i;
<a name="l02703"></a>02703                     p[n++] = j;
<a name="l02704"></a>02704                 }
<a name="l02705"></a>02705             }
<a name="l02706"></a>02706         }
<a name="l02707"></a>02707         <span class="keywordflow">else</span> {
<a name="l02708"></a>02708             <span class="keywordflow">for</span> (i = pmin[0]; i &lt;= pmax[0]; i++) {
<a name="l02709"></a>02709                 <span class="keywordflow">for</span> (j = pmin[1]; j &lt;= pmax[1]; j++) {
<a name="l02710"></a>02710                     <span class="keywordflow">for</span> (k = pmin[2]; k &lt;= pmax[2]; k++) {
<a name="l02711"></a>02711                         p[n++] = i;
<a name="l02712"></a>02712                         p[n++] = j;
<a name="l02713"></a>02713                         p[n++] = k;
<a name="l02714"></a>02714                     }
<a name="l02715"></a>02715                 }
<a name="l02716"></a>02716             }
<a name="l02717"></a>02717         }
<a name="l02718"></a>02718         <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a>)
<a name="l02719"></a>02719             ptype = <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d9df12b6366abf1175abbfca72f5f43e">PointList</a>;
<a name="l02720"></a>02720         <span class="keywordflow">else</span>
<a name="l02721"></a>02721             ptype = <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f564fbbf86f8130201d7e4c75dfb1a59bf">ElementList</a>;
<a name="l02722"></a>02722     }
<a name="l02723"></a>02723     <span class="keywordflow">else</span> {
<a name="l02724"></a>02724         np = npts;
<a name="l02725"></a>02725         p = pts;
<a name="l02726"></a>02726     }
<a name="l02727"></a>02727 
<a name="l02728"></a>02728     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a>)
<a name="l02729"></a>02729         check_struct_interface (z, ptype, np, p, bndry);
<a name="l02730"></a>02730     <span class="keywordflow">else</span>
<a name="l02731"></a>02731         check_unstruct_interface (z, ptype, np, p, bndry);
<a name="l02732"></a>02732 
<a name="l02733"></a>02733     <span class="keywordflow">if</span> (p != pts) <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (p);
<a name="l02734"></a>02734     <span class="keywordflow">return</span> np;
<a name="l02735"></a>02735 }
<a name="l02736"></a>02736 
<a name="l02737"></a>02737 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l02738"></a>02738 
<a name="l02739"></a>02739 <span class="keyword">static</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> check_location (<a class="code" href="struct_z_o_n_e.html">ZONE</a> *z, <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5">PointSetType_t</a> ptype,
<a name="l02740"></a>02740     <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> location)
<a name="l02741"></a>02741 {
<a name="l02742"></a>02742     <span class="keywordflow">switch</span> (location) {
<a name="l02743"></a>02743         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>:
<a name="l02744"></a>02744             <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a> || ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f564fbbf86f8130201d7e4c75dfb1a59bf">ElementList</a>)
<a name="l02745"></a>02745                 warning (1, <span class="stringliteral">"should not use Vertex with ElementList"</span>
<a name="l02746"></a>02746                     <span class="stringliteral">" or ElementRange"</span>);
<a name="l02747"></a>02747             <span class="keywordflow">break</span>;
<a name="l02748"></a>02748         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1345f1c1cdb99ea61bfdddc570c6a02bf2">FaceCenter</a>:
<a name="l02749"></a>02749             <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a>)
<a name="l02750"></a>02750                 warning (2,
<a name="l02751"></a>02751                     <span class="stringliteral">"use [IJK]FaceCenter with Structured grids"</span>);
<a name="l02752"></a>02752             <span class="keywordflow">break</span>;
<a name="l02753"></a>02753         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13b4cea34ab6a3c3533f2422f66bf8dc3d">IFaceCenter</a>:
<a name="l02754"></a>02754             <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> != <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a>) {
<a name="l02755"></a>02755                 error (<span class="stringliteral">"IFaceCenter only valid for Structured grids"</span>);
<a name="l02756"></a>02756                 <span class="keywordflow">return</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1345f1c1cdb99ea61bfdddc570c6a02bf2">FaceCenter</a>;
<a name="l02757"></a>02757             }
<a name="l02758"></a>02758             <span class="keywordflow">break</span>;
<a name="l02759"></a>02759         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e133f9cfc26e3953b1a7f7b8826e119a5d5">JFaceCenter</a>:
<a name="l02760"></a>02760             <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> != <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a> || z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> &lt; 2) {
<a name="l02761"></a>02761                 error (<span class="stringliteral">"JFaceCenter only valid for Structured grids"</span>
<a name="l02762"></a>02762                     <span class="stringliteral">" with CellDim &gt; 1"</span>);
<a name="l02763"></a>02763                 <span class="keywordflow">return</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1345f1c1cdb99ea61bfdddc570c6a02bf2">FaceCenter</a>;
<a name="l02764"></a>02764             }
<a name="l02765"></a>02765             <span class="keywordflow">break</span>;
<a name="l02766"></a>02766         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1387cfa4bdd4bc3bd768c3f0bab84f2143">KFaceCenter</a>:
<a name="l02767"></a>02767             <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> != <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a> || z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> &lt; 3) {
<a name="l02768"></a>02768                 error (<span class="stringliteral">"KFaceCenter only valid for Structured grids"</span>
<a name="l02769"></a>02769                     <span class="stringliteral">" with CellDim &gt; 2"</span>);
<a name="l02770"></a>02770                 <span class="keywordflow">return</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1345f1c1cdb99ea61bfdddc570c6a02bf2">FaceCenter</a>;
<a name="l02771"></a>02771             }
<a name="l02772"></a>02772             <span class="keywordflow">break</span>;
<a name="l02773"></a>02773         <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13af82b5a2366c89873ca45b75f6e6ac36">CellCenter</a>:
<a name="l02774"></a>02774             <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a> &amp;&amp; FileVersion &gt;= 2300)
<a name="l02775"></a>02775                 warning (2, <span class="stringliteral">"use [IJK]FaceCenter location rather"</span>
<a name="l02776"></a>02776                     <span class="stringliteral">" than CellCenter"</span>);
<a name="l02777"></a>02777             <span class="keywordflow">else</span>
<a name="l02778"></a>02778                 warning (2, <span class="stringliteral">"use FaceCenter location rather than"</span>
<a name="l02779"></a>02779                     <span class="stringliteral">" CellCenter"</span>);
<a name="l02780"></a>02780             <span class="keywordflow">return</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1345f1c1cdb99ea61bfdddc570c6a02bf2">FaceCenter</a>;
<a name="l02781"></a>02781             <span class="keywordflow">break</span>;
<a name="l02782"></a>02782         <span class="keywordflow">default</span>:
<a name="l02783"></a>02783             error (<span class="stringliteral">"grid location not Vertex,CellCenter,FaceCenter"</span>
<a name="l02784"></a>02784                 <span class="stringliteral">" or [IJK]FaceCenter"</span>);
<a name="l02785"></a>02785             <span class="keywordflow">break</span>;
<a name="l02786"></a>02786     }
<a name="l02787"></a>02787     <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a> || ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f564fbbf86f8130201d7e4c75dfb1a59bf">ElementList</a>)
<a name="l02788"></a>02788         <span class="keywordflow">return</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1345f1c1cdb99ea61bfdddc570c6a02bf2">FaceCenter</a>;
<a name="l02789"></a>02789     <span class="keywordflow">return</span> location;
<a name="l02790"></a>02790 }
<a name="l02791"></a>02791 
<a name="l02792"></a>02792 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l02793"></a>02793 
<a name="l02794"></a>02794 <span class="keyword">static</span> <span class="keywordtype">void</span> check_BCdata (<a class="code" href="cgns_keywords_8h.html#44b677e45de9f4d98475b69a56eec4e1">BCType_t</a> bctype, <span class="keywordtype">int</span> dirichlet, <span class="keywordtype">int</span> neumann,
<a name="l02795"></a>02795     <span class="keywordtype">int</span> size, <span class="keywordtype">int</span> parclass, <span class="keywordtype">int</span> *parunits, <span class="keywordtype">int</span> indent)
<a name="l02796"></a>02796 {
<a name="l02797"></a>02797     <span class="keywordtype">char</span> name[33], *desc;
<a name="l02798"></a>02798     <span class="keywordtype">int</span> ierr, n, nd;
<a name="l02799"></a>02799     <span class="keywordtype">int</span> *punits, units[9], dataclass;
<a name="l02800"></a>02800 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l02801"></a>02801 <span class="preprocessor"></span>    <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> location;
<a name="l02802"></a>02802     <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5">PointSetType_t</a> ptype;
<a name="l02803"></a>02803     <span class="keywordtype">int</span> hasl, hasp, npnts;
<a name="l02804"></a>02804 
<a name="l02805"></a>02805     hasl = read_gridlocation (&amp;location);
<a name="l02806"></a>02806     <span class="keywordflow">if</span> (hasl &amp;&amp; hasl != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l02807"></a>02807         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_gridlocation_read"</span>);
<a name="l02808"></a>02808     <span class="comment">/* ptset only valid below a zone */</span>
<a name="l02809"></a>02809     <span class="keywordflow">if</span> (cgnszone == 0)
<a name="l02810"></a>02810         hasp = <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>;
<a name="l02811"></a>02811     <span class="keywordflow">else</span> {
<a name="l02812"></a>02812         hasp = <a class="code" href="cgnslib_8c.html#6dc17b4e61dc1c11b7350d8720b52fce">cg_ptset_info</a> (&amp;ptype, &amp;npnts);
<a name="l02813"></a>02813         <span class="keywordflow">if</span> (hasp &amp;&amp; hasp != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l02814"></a>02814             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ptset_info"</span>);
<a name="l02815"></a>02815         <span class="keywordflow">if</span> (hasp == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a> &amp;&amp; hasl != <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l02816"></a>02816             location = <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>;
<a name="l02817"></a>02817             hasl = <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>;
<a name="l02818"></a>02818         }
<a name="l02819"></a>02819     }
<a name="l02820"></a>02820 <span class="preprocessor">#endif</span>
<a name="l02821"></a>02821 <span class="preprocessor"></span>
<a name="l02822"></a>02822     <span class="keywordflow">if</span> (verbose) {
<a name="l02823"></a>02823         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02824"></a>02824         printf (<span class="stringliteral">"BC Type=%s\n"</span>, <a class="code" href="cgnslib_8c.html#7b85152cdba9c91e213d433ca99240f6">cg_BCTypeName</a>(bctype));
<a name="l02825"></a>02825         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02826"></a>02826         printf (<span class="stringliteral">"Dirichlet Data=%s\n"</span>, dirichlet ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>);
<a name="l02827"></a>02827         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02828"></a>02828         printf (<span class="stringliteral">"Neumann Data=%s\n"</span>, neumann ? <span class="stringliteral">"yes"</span> : <span class="stringliteral">"no"</span>);
<a name="l02829"></a>02829 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l02830"></a>02830 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (hasl == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l02831"></a>02831             <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02832"></a>02832             printf (<span class="stringliteral">"Grid Location=%s\n"</span>, <a class="code" href="cgnslib_8c.html#7af88bef6535742b3a0bb04f976ff747">cg_GridLocationName</a>(location));
<a name="l02833"></a>02833         }
<a name="l02834"></a>02834         <span class="keywordflow">if</span> (hasp == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l02835"></a>02835             <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02836"></a>02836             printf (<span class="stringliteral">"Point Set Type=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6f8fbf63d32639cbaecf055db223423f">cg_PointSetTypeName</a>(ptype));
<a name="l02837"></a>02837             <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02838"></a>02838             printf (<span class="stringliteral">"Number Points=%d\n"</span>, npnts);
<a name="l02839"></a>02839         }
<a name="l02840"></a>02840 <span class="preprocessor">#endif</span>
<a name="l02841"></a>02841 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l02842"></a>02842             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l02843"></a>02843             <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l02844"></a>02844                 <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l02845"></a>02845                     <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l02846"></a>02846                 <span class="keywordflow">if</span> (desc != NULL) {
<a name="l02847"></a>02847                     <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02848"></a>02848                     printf (<span class="stringliteral">"Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l02849"></a>02849                     <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l02850"></a>02850                 }
<a name="l02851"></a>02851             }
<a name="l02852"></a>02852         }
<a name="l02853"></a>02853     }
<a name="l02854"></a>02854 
<a name="l02855"></a>02855     dataclass = read_dataclass ();
<a name="l02856"></a>02856     punits = read_units (units);
<a name="l02857"></a>02857     <span class="keywordflow">if</span> (verbose) {
<a name="l02858"></a>02858         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, indent);
<a name="l02859"></a>02859         <span class="keywordflow">if</span> (punits) print_units (punits, indent);
<a name="l02860"></a>02860     }
<a name="l02861"></a>02861     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = parclass;
<a name="l02862"></a>02862     <span class="keywordflow">if</span> (punits == NULL) punits = parunits;
<a name="l02863"></a>02863 
<a name="l02864"></a>02864     ierr = <a class="code" href="cgnslib_8c.html#39d1496f65890d79f7e63be3832347f0">cg_state_read</a> (&amp;desc);
<a name="l02865"></a>02865     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_state_read"</span>);
<a name="l02866"></a>02866     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l02867"></a>02867         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02868"></a>02868         puts (<span class="stringliteral">"checking reference state"</span>);
<a name="l02869"></a>02869         <span class="keywordflow">if</span> (desc != NULL) {
<a name="l02870"></a>02870             <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l02871"></a>02871                 <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent+2);
<a name="l02872"></a>02872                 printf (<span class="stringliteral">"Descriptor:%s\n"</span>, desc);
<a name="l02873"></a>02873             }
<a name="l02874"></a>02874             <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l02875"></a>02875         }
<a name="l02876"></a>02876         fflush (stdout);
<a name="l02877"></a>02877         go_relative (<span class="stringliteral">"ReferenceState_t"</span>, 1, NULL);
<a name="l02878"></a>02878         check_arrays (dataclass, punits, 1, 0, indent+2);
<a name="l02879"></a>02879         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02880"></a>02880     }
<a name="l02881"></a>02881 
<a name="l02882"></a>02882     check_user_data (dataclass, punits, indent);
<a name="l02883"></a>02883 
<a name="l02884"></a>02884 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l02885"></a>02885 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (hasp == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l02886"></a>02886         <span class="keywordtype">int</span> *pts;
<a name="l02887"></a>02887         <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1];
<a name="l02888"></a>02888 
<a name="l02889"></a>02889         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02890"></a>02890         puts (<span class="stringliteral">"checking BCDataSet interface"</span>);
<a name="l02891"></a>02891         fflush (stdout);
<a name="l02892"></a>02892         location = check_location (z, ptype, location);
<a name="l02893"></a>02893         <span class="keywordflow">if</span> (npnts &lt; 1) {
<a name="l02894"></a>02894             error (<span class="stringliteral">"number of points for Point Set less than 1"</span>);
<a name="l02895"></a>02895             size = 0;
<a name="l02896"></a>02896         }
<a name="l02897"></a>02897         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (npnts != 2 &amp;&amp;
<a name="l02898"></a>02898             (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a> || ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a>)) {
<a name="l02899"></a>02899             error (<span class="stringliteral">"number of points not 2 for Point/Element Range"</span>);
<a name="l02900"></a>02900             size = 0;
<a name="l02901"></a>02901         }
<a name="l02902"></a>02902         <span class="keywordflow">else</span> {
<a name="l02903"></a>02903             pts = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> * npnts * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l02904"></a>02904             <span class="keywordflow">if</span> (NULL == pts) {
<a name="l02905"></a>02905                 fprintf (stderr, <span class="stringliteral">"malloc failed for BCDataSet points\n"</span>);
<a name="l02906"></a>02906                 exit (1);
<a name="l02907"></a>02907             }
<a name="l02908"></a>02908             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#9fcf2c99f0165d62893e344c361c8c54">cg_ptset_read</a> (pts)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ptset_read"</span>);
<a name="l02909"></a>02909             <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a> || ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a>) {
<a name="l02910"></a>02910                 <span class="keywordflow">for</span> (n = 0; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++) {
<a name="l02911"></a>02911                     <span class="keywordflow">if</span> (pts[n] &gt; pts[n+z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>]) {
<a name="l02912"></a>02912                         warning (1, <span class="stringliteral">"start value &gt; end value for range"</span>);
<a name="l02913"></a>02913                         <span class="keywordflow">break</span>;
<a name="l02914"></a>02914                     }
<a name="l02915"></a>02915                 }
<a name="l02916"></a>02916             }
<a name="l02917"></a>02917             size = check_interface (z, ptype, location, npnts, pts, 1);
<a name="l02918"></a>02918             <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (pts);
<a name="l02919"></a>02919         }
<a name="l02920"></a>02920     }
<a name="l02921"></a>02921     <span class="keywordflow">else</span> {
<a name="l02922"></a>02922         <span class="keywordflow">if</span> (hasp == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>)
<a name="l02923"></a>02923             warning (1, <span class="stringliteral">"grid location should be used only with point set"</span>);
<a name="l02924"></a>02924     }
<a name="l02925"></a>02925 <span class="preprocessor">#endif</span>
<a name="l02926"></a>02926 <span class="preprocessor"></span>
<a name="l02927"></a>02927     <span class="keywordflow">if</span> (size) size = -size;  <span class="comment">/* allow array size of 1 */</span>
<a name="l02928"></a>02928 
<a name="l02929"></a>02929     <span class="keywordflow">if</span> (dirichlet) {
<a name="l02930"></a>02930         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02931"></a>02931         puts (<span class="stringliteral">"checking Dirichlet data"</span>);
<a name="l02932"></a>02932         go_relative (<span class="stringliteral">"BCData_t"</span>, <a class="code" href="cgns_keywords_8h.html#3be0aed74a9dad8d4558fa68ff3e737dd2ba0bf65961bac8373de60a7e6571b9">Dirichlet</a>, NULL);
<a name="l02933"></a>02933         check_arrays (dataclass, punits, 0, size, indent+2);
<a name="l02934"></a>02934         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02935"></a>02935     }
<a name="l02936"></a>02936 
<a name="l02937"></a>02937     <span class="keywordflow">if</span> (neumann) {
<a name="l02938"></a>02938         <a class="code" href="cgns2xml_8c.html#55b01f80540b8b128d97f2fffb7e6941">print_indent</a> (indent);
<a name="l02939"></a>02939         puts (<span class="stringliteral">"checking Neumann data"</span>);
<a name="l02940"></a>02940         go_relative (<span class="stringliteral">"BCData_t"</span>, <a class="code" href="cgns_keywords_8h.html#3be0aed74a9dad8d4558fa68ff3e737d2d800ee9173ede696b1d91d5b665d5b3">Neumann</a>, NULL);
<a name="l02941"></a>02941         check_arrays (dataclass, punits, 0, size, indent+2);
<a name="l02942"></a>02942         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l02943"></a>02943     }
<a name="l02944"></a>02944 }
<a name="l02945"></a>02945 
<a name="l02946"></a>02946 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l02947"></a>02947 
<a name="l02948"></a>02948 <span class="keyword">static</span> <span class="keywordtype">void</span> check_BCdataset (<span class="keywordtype">int</span> nb, <span class="keywordtype">int</span> nd, <span class="keywordtype">int</span> size,
<a name="l02949"></a>02949     <span class="keywordtype">int</span> parclass, <span class="keywordtype">int</span> *parunits)
<a name="l02950"></a>02950 {
<a name="l02951"></a>02951     <span class="keywordtype">char</span> name[33];
<a name="l02952"></a>02952     <span class="keywordtype">int</span> dirichlet, neumann;
<a name="l02953"></a>02953     <a class="code" href="cgns_keywords_8h.html#44b677e45de9f4d98475b69a56eec4e1">BCType_t</a> bctype;
<a name="l02954"></a>02954 
<a name="l02955"></a>02955     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#8f52911496011c3905de9a130703cf02">cg_dataset_read</a> (cgnsfn, cgnsbase, cgnszone, nb, nd,
<a name="l02956"></a>02956         name, &amp;bctype, &amp;dirichlet, &amp;neumann))
<a name="l02957"></a>02957         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_dataset_read"</span>);
<a name="l02958"></a>02958     printf (<span class="stringliteral">"    checking BC data set \"%s\"\n"</span>, name);
<a name="l02959"></a>02959     fflush (stdout);
<a name="l02960"></a>02960     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"ZoneBC_t"</span>, 1, <span class="stringliteral">"BC_t"</span>, nb,
<a name="l02961"></a>02961         <span class="stringliteral">"BCDataSet_t"</span>, nd, NULL);
<a name="l02962"></a>02962     check_BCdata (bctype, dirichlet, neumann, size, parclass, parunits, 6);
<a name="l02963"></a>02963 }
<a name="l02964"></a>02964 
<a name="l02965"></a>02965 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l02966"></a>02966 
<a name="l02967"></a>02967 <span class="keyword">static</span> <span class="keywordtype">void</span> check_BC (<span class="keywordtype">int</span> nb, <span class="keywordtype">int</span> parclass, <span class="keywordtype">int</span> *parunits)
<a name="l02968"></a>02968 {
<a name="l02969"></a>02969     <span class="keywordtype">char</span> name[33], *desc;
<a name="l02970"></a>02970     <span class="keywordtype">int</span> n, nd, ierr, npts, ndataset;
<a name="l02971"></a>02971     <span class="keywordtype">int</span> nrmlindex[3], nrmlflag, *pts;
<a name="l02972"></a>02972     <span class="keywordtype">int</span> *punits, units[9], dataclass;
<a name="l02973"></a>02973     <span class="keywordtype">void</span> *nrmllist;
<a name="l02974"></a>02974     <a class="code" href="cgns_keywords_8h.html#44b677e45de9f4d98475b69a56eec4e1">BCType_t</a> bctype;
<a name="l02975"></a>02975     <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5">PointSetType_t</a> ptype;
<a name="l02976"></a>02976     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l02977"></a>02977     <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> location;
<a name="l02978"></a>02978     <a class="code" href="cgns_keywords_8h.html#2b4b0d12e36cae57838f1b5da29bce31">WallFunctionType_t</a> wtype;
<a name="l02979"></a>02979     <a class="code" href="cgns_keywords_8h.html#1880bd253228588cf62ef75ab37c07e2">AreaType_t</a> atype;
<a name="l02980"></a>02980     <span class="keywordtype">float</span> area;
<a name="l02981"></a>02981     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1];
<a name="l02982"></a>02982 
<a name="l02983"></a>02983     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#6000dfe7f9eb8163ca59443d1124498f">cg_boco_info</a> (cgnsfn, cgnsbase, cgnszone, nb, name, &amp;bctype,
<a name="l02984"></a>02984             &amp;ptype, &amp;npts, nrmlindex, &amp;nrmlflag, &amp;datatype, &amp;ndataset))
<a name="l02985"></a>02985         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_boco_info"</span>);
<a name="l02986"></a>02986     printf (<span class="stringliteral">"  checking BC \"%s\"\n"</span>, name);
<a name="l02987"></a>02987     <span class="keywordflow">if</span> (verbose) {
<a name="l02988"></a>02988         printf (<span class="stringliteral">"    BC Type=%s\n"</span>, <a class="code" href="cgnslib_8c.html#7b85152cdba9c91e213d433ca99240f6">cg_BCTypeName</a>(bctype));
<a name="l02989"></a>02989         printf (<span class="stringliteral">"    Point Set Type=%s\n"</span>, <a class="code" href="cgnslib_8c.html#6f8fbf63d32639cbaecf055db223423f">cg_PointSetTypeName</a>(ptype));
<a name="l02990"></a>02990     }
<a name="l02991"></a>02991     fflush (stdout);
<a name="l02992"></a>02992 
<a name="l02993"></a>02993     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"ZoneBC_t"</span>, 1, <span class="stringliteral">"BC_t"</span>, nb, NULL);
<a name="l02994"></a>02994 
<a name="l02995"></a>02995     <span class="keywordflow">if</span> (FileVersion &gt;= 1270 &amp;&amp; FileVersion &lt;= 2200) {
<a name="l02996"></a>02996         <span class="keywordflow">if</span> (ptype != <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a> &amp;&amp; ptype != <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d9df12b6366abf1175abbfca72f5f43e">PointList</a>) {
<a name="l02997"></a>02997             error (<span class="stringliteral">"point set type not PointRange or PointList"</span>);
<a name="l02998"></a>02998             <span class="keywordflow">return</span>;
<a name="l02999"></a>02999         }
<a name="l03000"></a>03000     }
<a name="l03001"></a>03001     <span class="keywordflow">else</span> {
<a name="l03002"></a>03002         <span class="keywordflow">if</span> (ptype != <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a>   &amp;&amp; ptype != <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d9df12b6366abf1175abbfca72f5f43e">PointList</a> &amp;&amp;
<a name="l03003"></a>03003             ptype != <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a> &amp;&amp; ptype != <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f564fbbf86f8130201d7e4c75dfb1a59bf">ElementList</a>) {
<a name="l03004"></a>03004             error (<span class="stringliteral">"point set type not PointRange, PointList, ElementRange"</span>
<a name="l03005"></a>03005                 <span class="stringliteral">" or ElementList"</span>);
<a name="l03006"></a>03006             <span class="keywordflow">return</span>;
<a name="l03007"></a>03007         }
<a name="l03008"></a>03008     }
<a name="l03009"></a>03009 
<a name="l03010"></a>03010     <span class="keywordflow">if</span> (FileVersion &lt; 1270) {
<a name="l03011"></a>03011         <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a> || ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f564fbbf86f8130201d7e4c75dfb1a59bf">ElementList</a>)
<a name="l03012"></a>03012             location = <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1345f1c1cdb99ea61bfdddc570c6a02bf2">FaceCenter</a>;
<a name="l03013"></a>03013         <span class="keywordflow">else</span>
<a name="l03014"></a>03014             location = <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>;
<a name="l03015"></a>03015     }
<a name="l03016"></a>03016     <span class="keywordflow">else</span> {
<a name="l03017"></a>03017         ierr = read_gridlocation (&amp;location);
<a name="l03018"></a>03018         <span class="keywordflow">if</span> (ierr) {
<a name="l03019"></a>03019             <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l03020"></a>03020                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_gridlocation_read"</span>);
<a name="l03021"></a>03021             <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a> || ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f564fbbf86f8130201d7e4c75dfb1a59bf">ElementList</a>)
<a name="l03022"></a>03022                 location = <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1345f1c1cdb99ea61bfdddc570c6a02bf2">FaceCenter</a>;
<a name="l03023"></a>03023             <span class="keywordflow">else</span>
<a name="l03024"></a>03024                 location = <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>;
<a name="l03025"></a>03025         }
<a name="l03026"></a>03026         <span class="keywordflow">else</span> {
<a name="l03027"></a>03027             <span class="keywordflow">if</span> (verbose)
<a name="l03028"></a>03028                 printf (<span class="stringliteral">"    Grid Location=%s\n"</span>,
<a name="l03029"></a>03029                     <a class="code" href="cgnslib_8c.html#7af88bef6535742b3a0bb04f976ff747">cg_GridLocationName</a>(location));
<a name="l03030"></a>03030             location = check_location (z, ptype, location);
<a name="l03031"></a>03031         }
<a name="l03032"></a>03032     }
<a name="l03033"></a>03033 
<a name="l03034"></a>03034     <span class="keywordflow">if</span> (npts &lt; 1) {
<a name="l03035"></a>03035         error (<span class="stringliteral">"number of points is less than 1"</span>);
<a name="l03036"></a>03036         <span class="keywordflow">return</span>;
<a name="l03037"></a>03037     }
<a name="l03038"></a>03038     <span class="keywordflow">if</span> (FileVersion &gt;= 1270 &amp;&amp; FileVersion &lt;= 2200) {
<a name="l03039"></a>03039         <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a> &amp;&amp; npts != 2) {
<a name="l03040"></a>03040             error (<span class="stringliteral">"number of points is not 2 for PointRange"</span>);
<a name="l03041"></a>03041             <span class="keywordflow">return</span>;
<a name="l03042"></a>03042         }
<a name="l03043"></a>03043     }
<a name="l03044"></a>03044     <span class="keywordflow">else</span> {
<a name="l03045"></a>03045         <span class="keywordflow">if</span> ((ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a> || ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a>) &amp;&amp; npts != 2) {
<a name="l03046"></a>03046             error (<span class="stringliteral">"number of points is not 2 for PointRange/ElementRange"</span>);
<a name="l03047"></a>03047             <span class="keywordflow">return</span>;
<a name="l03048"></a>03048         }
<a name="l03049"></a>03049     }
<a name="l03050"></a>03050     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> == 0) <span class="keywordflow">return</span>;
<a name="l03051"></a>03051 
<a name="l03052"></a>03052     ierr = check_node (<span class="stringliteral">"\"int[IndexDimension]\""</span>);
<a name="l03053"></a>03053 
<a name="l03054"></a>03054     <span class="keywordflow">if</span> (verbose) {
<a name="l03055"></a>03055         <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l03056"></a>03056             printf (<span class="stringliteral">"    Normal Index=[%d"</span>, nrmlindex[0]);
<a name="l03057"></a>03057             <span class="keywordflow">for</span> (n = 1; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++)
<a name="l03058"></a>03058                 printf (<span class="stringliteral">",%d"</span>, nrmlindex[n]);
<a name="l03059"></a>03059             puts (<span class="stringliteral">"]"</span>);
<a name="l03060"></a>03060         }
<a name="l03061"></a>03061         <span class="keywordflow">if</span> (nrmlflag) {
<a name="l03062"></a>03062             puts (<span class="stringliteral">"    Normals Defined=yes"</span>);
<a name="l03063"></a>03063             printf (<span class="stringliteral">"    Number Normals=%d\n"</span>, nrmlflag / PhyDim);
<a name="l03064"></a>03064         }
<a name="l03065"></a>03065         <span class="keywordflow">else</span>
<a name="l03066"></a>03066             puts (<span class="stringliteral">"    Normals Defined=no"</span>);
<a name="l03067"></a>03067     }
<a name="l03068"></a>03068     fflush (stdout);
<a name="l03069"></a>03069 
<a name="l03070"></a>03070     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a> &amp;&amp; z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> != <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a>)
<a name="l03071"></a>03071         error (<span class="stringliteral">"normal index is only valid for Structured grids"</span>);
<a name="l03072"></a>03072     <span class="keywordflow">if</span> (nrmlflag) {
<a name="l03073"></a>03073         <span class="keywordflow">if</span> (datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1ca5e5244f4627fd3bf71c72015c2060">RealSingle</a> &amp;&amp; datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae5f954e649a6da0e65898e0faf7724549">RealDouble</a>) {
<a name="l03074"></a>03074             error (<span class="stringliteral">"normal data type is not RealSingle or RealDouble"</span>);
<a name="l03075"></a>03075             <span class="keywordflow">if</span> (LibraryVersion &lt; 2200) <span class="keywordflow">return</span>;
<a name="l03076"></a>03076         }
<a name="l03077"></a>03077     }
<a name="l03078"></a>03078 
<a name="l03079"></a>03079     pts = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> * npts * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03080"></a>03080     <span class="keywordflow">if</span> (NULL == pts) {
<a name="l03081"></a>03081         fprintf (stderr, <span class="stringliteral">"malloc failed for BC points\n"</span>);
<a name="l03082"></a>03082         exit (1);
<a name="l03083"></a>03083     }
<a name="l03084"></a>03084     nrmllist = NULL;
<a name="l03085"></a>03085     <span class="keywordflow">if</span> (nrmlflag &amp;&amp; LibraryVersion &lt; 2200) {
<a name="l03086"></a>03086         <span class="keywordtype">int</span> n = datatype == <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1ca5e5244f4627fd3bf71c72015c2060">RealSingle</a> ? <span class="keyword">sizeof</span>(float) : <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);
<a name="l03087"></a>03087         nrmllist = (<span class="keywordtype">void</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (nrmlflag * n);
<a name="l03088"></a>03088         <span class="keywordflow">if</span> (nrmllist == NULL) {
<a name="l03089"></a>03089             fprintf (stderr, <span class="stringliteral">"malloc failed for BC normals\n"</span>);
<a name="l03090"></a>03090             exit (1);
<a name="l03091"></a>03091         }
<a name="l03092"></a>03092     }
<a name="l03093"></a>03093     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#9709eff3de1a02677bc23eb414914d7b">cg_boco_read</a> (cgnsfn, cgnsbase, cgnszone, nb, pts, nrmllist))
<a name="l03094"></a>03094         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_boco_read"</span>);
<a name="l03095"></a>03095     <span class="keywordflow">if</span> (nrmllist) <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (nrmllist);
<a name="l03096"></a>03096 
<a name="l03097"></a>03097     ierr = <a class="code" href="cgnslib_8c.html#7bc0fed09c8e3e4152fcbd1ceb2e053d">cg_famname_read</a> (name);
<a name="l03098"></a>03098     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_famname_read"</span>);
<a name="l03099"></a>03099     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) {
<a name="l03100"></a>03100         <span class="keywordflow">if</span> (bctype == <a class="code" href="cgns_keywords_8h.html#44b677e45de9f4d98475b69a56eec4e1e1ac82a9e146fc71da27f85c9f8b8094">FamilySpecified</a>)
<a name="l03101"></a>03101             warning (1,
<a name="l03102"></a>03102                 <span class="stringliteral">"BC Type is FamilySpecified but no family name is given"</span>);
<a name="l03103"></a>03103     }
<a name="l03104"></a>03104     <span class="keywordflow">else</span> {
<a name="l03105"></a>03105         <span class="keywordflow">if</span> (verbose) printf (<span class="stringliteral">"    Family=\"%s\"\n"</span>, name);
<a name="l03106"></a>03106         <span class="keywordflow">for</span> (n = 0; n &lt; NumFamily; n++) {
<a name="l03107"></a>03107             <span class="keywordflow">if</span> (0 == strcmp (name, Family[n])) <span class="keywordflow">break</span>;
<a name="l03108"></a>03108         }
<a name="l03109"></a>03109         <span class="keywordflow">if</span> (n == NumFamily &amp;&amp;
<a name="l03110"></a>03110             (FileVersion &gt;= 1200 || strcmp(name, <span class="stringliteral">"ORPHAN"</span>)))
<a name="l03111"></a>03111             warning (1, <span class="stringliteral">"family name \"%s\" not found"</span>, name);
<a name="l03112"></a>03112     }
<a name="l03113"></a>03113 
<a name="l03114"></a>03114     ierr = read_ordinal (&amp;n);
<a name="l03115"></a>03115     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ordinal_read"</span>);
<a name="l03116"></a>03116     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a> &amp;&amp; verbose)
<a name="l03117"></a>03117         printf (<span class="stringliteral">"    Ordinal=%d\n"</span>, n);
<a name="l03118"></a>03118 
<a name="l03119"></a>03119     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03120"></a>03120         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03121"></a>03121         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03122"></a>03122             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03123"></a>03123                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03124"></a>03124             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03125"></a>03125                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03126"></a>03126                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03127"></a>03127             }
<a name="l03128"></a>03128         }
<a name="l03129"></a>03129     }
<a name="l03130"></a>03130 
<a name="l03131"></a>03131     dataclass = read_dataclass ();
<a name="l03132"></a>03132     punits = read_units (units);
<a name="l03133"></a>03133     <span class="keywordflow">if</span> (verbose) {
<a name="l03134"></a>03134         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 4);
<a name="l03135"></a>03135         <span class="keywordflow">if</span> (punits) print_units (punits, 4);
<a name="l03136"></a>03136     }
<a name="l03137"></a>03137     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = parclass;
<a name="l03138"></a>03138     <span class="keywordflow">if</span> (punits == NULL) punits = parunits;
<a name="l03139"></a>03139 
<a name="l03140"></a>03140     ierr = <a class="code" href="cgnslib_8c.html#39d1496f65890d79f7e63be3832347f0">cg_state_read</a> (&amp;desc);
<a name="l03141"></a>03141     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_state_read"</span>);
<a name="l03142"></a>03142     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l03143"></a>03143         puts (<span class="stringliteral">"    checking reference state"</span>);
<a name="l03144"></a>03144         <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03145"></a>03145             <span class="keywordflow">if</span> (verbose &gt; 1)
<a name="l03146"></a>03146                 printf (<span class="stringliteral">"      Descriptor:%s\n"</span>, desc);
<a name="l03147"></a>03147             <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03148"></a>03148         }
<a name="l03149"></a>03149         fflush (stdout);
<a name="l03150"></a>03150         go_relative (<span class="stringliteral">"ReferenceState_t"</span>, 1, NULL);
<a name="l03151"></a>03151         check_arrays (dataclass, punits, 1, 0, 6);
<a name="l03152"></a>03152         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l03153"></a>03153     }
<a name="l03154"></a>03154 
<a name="l03155"></a>03155     check_user_data (dataclass, punits, 4);
<a name="l03156"></a>03156 
<a name="l03157"></a>03157     puts (<span class="stringliteral">"    checking BC interface"</span>);
<a name="l03158"></a>03158     fflush (stdout);
<a name="l03159"></a>03159     <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a> || ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f586986673b7c935efa39b88987781a180">ElementRange</a>) {
<a name="l03160"></a>03160         <span class="keywordflow">for</span> (n = 0; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++) {
<a name="l03161"></a>03161             <span class="keywordflow">if</span> (pts[n] &gt; pts[n+z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>]) {
<a name="l03162"></a>03162                 warning (1, <span class="stringliteral">"start value &gt; end value for range"</span>);
<a name="l03163"></a>03163                 <span class="keywordflow">break</span>;
<a name="l03164"></a>03164             }
<a name="l03165"></a>03165         }
<a name="l03166"></a>03166     }
<a name="l03167"></a>03167     npts = check_interface (z, ptype, location, npts, pts, 1);
<a name="l03168"></a>03168     <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (pts);
<a name="l03169"></a>03169 
<a name="l03170"></a>03170     <span class="comment">/* BCDataSet */</span>
<a name="l03171"></a>03171 
<a name="l03172"></a>03172     <span class="keywordflow">for</span> (nd = 1; nd &lt;= ndataset; nd++)
<a name="l03173"></a>03173         check_BCdataset (nb, nd, npts, dataclass, punits);
<a name="l03174"></a>03174 
<a name="l03175"></a>03175     <span class="comment">/* BCProperty */</span>
<a name="l03176"></a>03176 
<a name="l03177"></a>03177     <span class="keywordflow">if</span> (check_node (<span class="stringliteral">"BCProperty_t"</span>) == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l03178"></a>03178         puts (<span class="stringliteral">"    checking BC property"</span>);
<a name="l03179"></a>03179         fflush (stdout);
<a name="l03180"></a>03180         go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"ZoneBC_t"</span>, 1, <span class="stringliteral">"BC_t"</span>, nb,
<a name="l03181"></a>03181             <span class="stringliteral">"BCProperty_t"</span>, 1, NULL);
<a name="l03182"></a>03182         <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03183"></a>03183             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03184"></a>03184             <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03185"></a>03185                 <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03186"></a>03186                     <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03187"></a>03187                 <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03188"></a>03188                     printf (<span class="stringliteral">"      Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03189"></a>03189                     <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03190"></a>03190                 }
<a name="l03191"></a>03191             }
<a name="l03192"></a>03192         }
<a name="l03193"></a>03193         check_user_data (dataclass, punits, 6);
<a name="l03194"></a>03194 
<a name="l03195"></a>03195         ierr = <a class="code" href="cgnslib_8c.html#f5df991940609acdf176aeb08e274d6c">cg_bc_wallfunction_read</a> (cgnsfn, cgnsbase, cgnszone, nb,
<a name="l03196"></a>03196             &amp;wtype);
<a name="l03197"></a>03197         <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l03198"></a>03198             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_bc_wallfunction_read"</span>);
<a name="l03199"></a>03199         <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l03200"></a>03200             puts (<span class="stringliteral">"      checking Wall Function property"</span>);
<a name="l03201"></a>03201             go_relative (<span class="stringliteral">"WallFunction_t"</span>, 1, NULL);
<a name="l03202"></a>03202             <span class="keywordflow">if</span> (verbose) {
<a name="l03203"></a>03203                 printf (<span class="stringliteral">"        Wall Function Type=%s\n"</span>,
<a name="l03204"></a>03204                     <a class="code" href="cgnslib_8c.html#34af4aff41507a6e8b7b975f31594e9a">cg_WallFunctionTypeName</a> (wtype));
<a name="l03205"></a>03205                 <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03206"></a>03206                     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd))
<a name="l03207"></a>03207                         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03208"></a>03208                     <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03209"></a>03209                         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03210"></a>03210                             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03211"></a>03211                         <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03212"></a>03212                             printf (<span class="stringliteral">"        Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03213"></a>03213                             <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03214"></a>03214                         }
<a name="l03215"></a>03215                     }
<a name="l03216"></a>03216                 }
<a name="l03217"></a>03217             }
<a name="l03218"></a>03218             check_user_data (dataclass, punits, 8);
<a name="l03219"></a>03219             go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l03220"></a>03220         }
<a name="l03221"></a>03221 
<a name="l03222"></a>03222         ierr = <a class="code" href="cgnslib_8c.html#567c9f3947b3bafdf333610b3eb1106c">cg_bc_area_read</a> (cgnsfn, cgnsbase, cgnszone, nb,
<a name="l03223"></a>03223             &amp;atype, &amp;area, name);
<a name="l03224"></a>03224         <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l03225"></a>03225             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_bc_area_read"</span>);
<a name="l03226"></a>03226         <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l03227"></a>03227             puts (<span class="stringliteral">"      checking Area property"</span>);
<a name="l03228"></a>03228             go_relative (<span class="stringliteral">"Area_t"</span>, 1, NULL);
<a name="l03229"></a>03229             <span class="keywordflow">if</span> (verbose) {
<a name="l03230"></a>03230                 printf (<span class="stringliteral">"        Area Type=%s\n"</span>, <a class="code" href="cgnslib_8c.html#804ddaf0925cf1dfc988e152cd0d7242">cg_AreaTypeName</a> (atype));
<a name="l03231"></a>03231                 printf (<span class="stringliteral">"        Area=%g\n"</span>, area);
<a name="l03232"></a>03232                 printf (<span class="stringliteral">"        Region=\"%s\"\n"</span>, name);
<a name="l03233"></a>03233                 <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03234"></a>03234                     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03235"></a>03235                     <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03236"></a>03236                         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03237"></a>03237                             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03238"></a>03238                         <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03239"></a>03239                             printf (<span class="stringliteral">"        Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03240"></a>03240                             <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03241"></a>03241                         }
<a name="l03242"></a>03242                     }
<a name="l03243"></a>03243                 }
<a name="l03244"></a>03244             }
<a name="l03245"></a>03245             check_quantity (1, <span class="stringliteral">"SurfaceArea"</span>, dataclass, punits, 1, 8);
<a name="l03246"></a>03246             check_user_data (dataclass, punits, 8);
<a name="l03247"></a>03247             go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l03248"></a>03248         }
<a name="l03249"></a>03249     }
<a name="l03250"></a>03250 }
<a name="l03251"></a>03251 
<a name="l03252"></a>03252 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l03253"></a>03253 
<a name="l03254"></a>03254 <span class="keyword">static</span> <span class="keywordtype">void</span> check_zoneBC (<span class="keywordtype">void</span>)
<a name="l03255"></a>03255 {
<a name="l03256"></a>03256     <span class="keywordtype">char</span> name[33], *desc;
<a name="l03257"></a>03257     <span class="keywordtype">int</span> n, nb, ierr;
<a name="l03258"></a>03258     <span class="keywordtype">int</span> *punits, units[9], dataclass;
<a name="l03259"></a>03259 
<a name="l03260"></a>03260     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#5253ffcc6485261ba8d04610ab169d66">cg_nbocos</a> (cgnsfn, cgnsbase, cgnszone, &amp;nb))
<a name="l03261"></a>03261         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_nbocos"</span>);
<a name="l03262"></a>03262     <span class="keywordflow">if</span> (nb &lt; 1) <span class="keywordflow">return</span>;
<a name="l03263"></a>03263     puts (<span class="stringliteral">"  checking boundary conditions"</span>);
<a name="l03264"></a>03264     fflush (stdout);
<a name="l03265"></a>03265     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"ZoneBC_t"</span>, 1, NULL);
<a name="l03266"></a>03266 
<a name="l03267"></a>03267     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03268"></a>03268         <span class="keywordtype">int</span> nd;
<a name="l03269"></a>03269         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03270"></a>03270         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03271"></a>03271             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03272"></a>03272                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03273"></a>03273             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03274"></a>03274                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03275"></a>03275                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03276"></a>03276             }
<a name="l03277"></a>03277         }
<a name="l03278"></a>03278     }
<a name="l03279"></a>03279 
<a name="l03280"></a>03280     dataclass = read_dataclass ();
<a name="l03281"></a>03281     punits = read_units (units);
<a name="l03282"></a>03282     <span class="keywordflow">if</span> (verbose) {
<a name="l03283"></a>03283         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 4);
<a name="l03284"></a>03284         <span class="keywordflow">if</span> (punits) print_units (punits, 4);
<a name="l03285"></a>03285     }
<a name="l03286"></a>03286     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = Zones[cgnszone-1].<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>;
<a name="l03287"></a>03287     <span class="keywordflow">if</span> (punits == NULL) punits = Zones[cgnszone-1].<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>;
<a name="l03288"></a>03288 
<a name="l03289"></a>03289     ierr = <a class="code" href="cgnslib_8c.html#39d1496f65890d79f7e63be3832347f0">cg_state_read</a> (&amp;desc);
<a name="l03290"></a>03290     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_state_read"</span>);
<a name="l03291"></a>03291     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l03292"></a>03292         puts (<span class="stringliteral">"    checking reference state"</span>);
<a name="l03293"></a>03293         <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03294"></a>03294             <span class="keywordflow">if</span> (verbose &gt; 1)
<a name="l03295"></a>03295                 printf (<span class="stringliteral">"      Descriptor:%s\n"</span>, desc);
<a name="l03296"></a>03296             <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03297"></a>03297         }
<a name="l03298"></a>03298         fflush (stdout);
<a name="l03299"></a>03299         go_relative (<span class="stringliteral">"ReferenceState_t"</span>, 1, NULL);
<a name="l03300"></a>03300         check_arrays (dataclass, punits, 1, 0, 6);
<a name="l03301"></a>03301     }
<a name="l03302"></a>03302 
<a name="l03303"></a>03303     check_user_data (dataclass, punits, 4);
<a name="l03304"></a>03304 
<a name="l03305"></a>03305     <span class="keywordflow">for</span> (n = 1; n &lt;= nb; n++)
<a name="l03306"></a>03306         check_BC (n, dataclass, punits);
<a name="l03307"></a>03307 }
<a name="l03308"></a>03308 
<a name="l03309"></a>03309 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l03310"></a>03310 
<a name="l03311"></a>03311 <span class="keyword">static</span> <span class="keywordtype">void</span> check_1to1 (<span class="keywordtype">int</span> nc)
<a name="l03312"></a>03312 {
<a name="l03313"></a>03313     <span class="keywordtype">char</span> name[33], dname[33], *desc;
<a name="l03314"></a>03314     <span class="keywordtype">int</span> ierr, n, nd, range[6], drange[6], trans[3];
<a name="l03315"></a>03315     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1], *dz;
<a name="l03316"></a>03316 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l03317"></a>03317 <span class="preprocessor"></span>    <span class="keywordtype">int</span> ndim, dims[12];
<a name="l03318"></a>03318     <span class="keywordtype">float</span> center[3], angle[3], translate[3];
<a name="l03319"></a>03319     <a class="code" href="cgns_keywords_8h.html#f47b7b9aa4b1c696a7e559427686a083">AverageInterfaceType_t</a> average;
<a name="l03320"></a>03320     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l03321"></a>03321 <span class="preprocessor">#endif</span>
<a name="l03322"></a>03322 <span class="preprocessor"></span>
<a name="l03323"></a>03323     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#bcb982ebc797da764c81e66d80abdddf">cg_1to1_read</a> (cgnsfn, cgnsbase, cgnszone, nc, name,
<a name="l03324"></a>03324         dname, range, drange, trans)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_1to1_read"</span>);
<a name="l03325"></a>03325     printf (<span class="stringliteral">"  checking 1to1 connectivity \"%s\"\n"</span>, name);
<a name="l03326"></a>03326     <span class="keywordflow">if</span> (verbose) {
<a name="l03327"></a>03327         printf (<span class="stringliteral">"    Range=[%d:%d"</span>, range[0], range[z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>]);
<a name="l03328"></a>03328         <span class="keywordflow">for</span> (n = 1; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++)
<a name="l03329"></a>03329             printf (<span class="stringliteral">",%d:%d"</span>, range[n], range[n+z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>]);
<a name="l03330"></a>03330         puts (<span class="stringliteral">"]"</span>);
<a name="l03331"></a>03331     }
<a name="l03332"></a>03332 
<a name="l03333"></a>03333     <span class="keywordflow">for</span> (n = 0; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++) {
<a name="l03334"></a>03334         <span class="keywordflow">if</span> (range[n] &gt; range[n+z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>]) {
<a name="l03335"></a>03335             warning (1, <span class="stringliteral">"start value &gt; end value for range"</span>);
<a name="l03336"></a>03336             <span class="keywordflow">break</span>;
<a name="l03337"></a>03337         }
<a name="l03338"></a>03338     }
<a name="l03339"></a>03339     puts (<span class="stringliteral">"    checking 1to1 interface"</span>);
<a name="l03340"></a>03340     fflush (stdout);
<a name="l03341"></a>03341     check_interface (z, <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a>, <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>, 2, range, 1);
<a name="l03342"></a>03342 
<a name="l03343"></a>03343     <span class="keywordflow">for</span> (dz = NULL, n = 0; n &lt; NumZones; n++) {
<a name="l03344"></a>03344         <span class="keywordflow">if</span> (0 == strcmp (dname, Zones[n].name)) {
<a name="l03345"></a>03345             dz = &amp;Zones[n];
<a name="l03346"></a>03346             <span class="keywordflow">break</span>;
<a name="l03347"></a>03347         }
<a name="l03348"></a>03348     }
<a name="l03349"></a>03349     <span class="keywordflow">if</span> (verbose)
<a name="l03350"></a>03350         printf (<span class="stringliteral">"    Donor Name=%s\n"</span>, dname);
<a name="l03351"></a>03351     <span class="keywordflow">if</span> (dz == NULL) {
<a name="l03352"></a>03352         error (<span class="stringliteral">"donor zone \"%s\" not found"</span>, dname);
<a name="l03353"></a>03353         <span class="keywordflow">if</span> (verbose)
<a name="l03354"></a>03354             puts (<span class="stringliteral">"    Donor Range=&lt;can't evaluate&gt;"</span>);
<a name="l03355"></a>03355     }
<a name="l03356"></a>03356     <span class="keywordflow">else</span> {
<a name="l03357"></a>03357         <span class="keywordflow">if</span> (verbose) {
<a name="l03358"></a>03358             printf (<span class="stringliteral">"    Donor Range=[%d:%d"</span>, drange[0], drange[dz-&gt;idim]);
<a name="l03359"></a>03359             <span class="keywordflow">for</span> (n = 1; n &lt; dz-&gt;idim; n++)
<a name="l03360"></a>03360                 printf (<span class="stringliteral">",%d:%d"</span>, drange[n], drange[n+dz-&gt;idim]);
<a name="l03361"></a>03361             puts (<span class="stringliteral">"]"</span>);
<a name="l03362"></a>03362         }
<a name="l03363"></a>03363         puts (<span class="stringliteral">"    checking donor interface"</span>);
<a name="l03364"></a>03364         fflush (stdout);
<a name="l03365"></a>03365         check_interface (dz, <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a>, <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>, 2, drange, 1);
<a name="l03366"></a>03366     }
<a name="l03367"></a>03367 
<a name="l03368"></a>03368     <span class="keywordflow">if</span> (verbose) {
<a name="l03369"></a>03369         printf (<span class="stringliteral">"    Transform=[%d"</span>, trans[0]);
<a name="l03370"></a>03370         <span class="keywordflow">for</span> (n = 1; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++)
<a name="l03371"></a>03371             printf (<span class="stringliteral">",%d"</span>, trans[n]);
<a name="l03372"></a>03372         puts (<span class="stringliteral">"]"</span>);
<a name="l03373"></a>03373     }
<a name="l03374"></a>03374 
<a name="l03375"></a>03375     <span class="keywordflow">if</span> (dz != NULL) {
<a name="l03376"></a>03376         <span class="keywordtype">int</span> id, np = 1, dnp = 1;
<a name="l03377"></a>03377         <span class="keywordflow">for</span> (n = 0; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++)
<a name="l03378"></a>03378             np *= (abs(range[n+z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>] - range[n]) + 1);
<a name="l03379"></a>03379         <span class="keywordflow">for</span> (n = 0; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++)
<a name="l03380"></a>03380             dnp *= (abs(drange[n+dz-&gt;idim] - drange[n]) + 1);
<a name="l03381"></a>03381         <span class="keywordflow">if</span> (np != dnp)
<a name="l03382"></a>03382             error (<span class="stringliteral">"number of points is not the same as for the donor zone"</span>);
<a name="l03383"></a>03383         <span class="keywordflow">for</span> (n = 0; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++) {
<a name="l03384"></a>03384             np = range[n+z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>] - range[n];
<a name="l03385"></a>03385             <span class="keywordtype">id</span> = abs (trans[n]);
<a name="l03386"></a>03386             <span class="keywordflow">if</span> ((<span class="keywordtype">id</span> == 0 &amp;&amp; np) || <span class="keywordtype">id</span> &gt; dz-&gt;idim)
<a name="l03387"></a>03387                 dnp = np + 1;
<a name="l03388"></a>03388             <span class="keywordflow">else</span> {
<a name="l03389"></a>03389                 <span class="keywordtype">id</span>--;
<a name="l03390"></a>03390                 dnp = drange[<span class="keywordtype">id</span>+dz-&gt;idim] - drange[id];
<a name="l03391"></a>03391                 <span class="keywordflow">if</span> (trans[n] &lt; 0) dnp = -dnp;
<a name="l03392"></a>03392             }
<a name="l03393"></a>03393             <span class="keywordflow">if</span> (np != dnp) {
<a name="l03394"></a>03394                 error (<span class="stringliteral">"transform specification is invalid"</span>);
<a name="l03395"></a>03395                 <span class="keywordflow">break</span>;
<a name="l03396"></a>03396             }
<a name="l03397"></a>03397         }
<a name="l03398"></a>03398     }
<a name="l03399"></a>03399 
<a name="l03400"></a>03400     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"ZoneGridConnectivity_t"</span>, 1,
<a name="l03401"></a>03401         <span class="stringliteral">"GridConnectivity1to1_t"</span>, nc, NULL);
<a name="l03402"></a>03402 
<a name="l03403"></a>03403     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03404"></a>03404         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03405"></a>03405         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03406"></a>03406             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03407"></a>03407                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03408"></a>03408             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03409"></a>03409                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03410"></a>03410                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03411"></a>03411             }
<a name="l03412"></a>03412         }
<a name="l03413"></a>03413     }
<a name="l03414"></a>03414 
<a name="l03415"></a>03415     ierr = read_ordinal (&amp;n);
<a name="l03416"></a>03416     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ordinal_read"</span>);
<a name="l03417"></a>03417     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a> &amp;&amp; verbose)
<a name="l03418"></a>03418         printf (<span class="stringliteral">"    Ordinal=%d\n"</span>, n);
<a name="l03419"></a>03419 
<a name="l03420"></a>03420     check_user_data (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 4);
<a name="l03421"></a>03421 
<a name="l03422"></a>03422 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l03423"></a>03423 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (check_node (<span class="stringliteral">"GridConnectivityProperty_t"</span>)) <span class="keywordflow">return</span>;
<a name="l03424"></a>03424     puts (<span class="stringliteral">"    checking grid connectivity property"</span>);
<a name="l03425"></a>03425     fflush (stdout);
<a name="l03426"></a>03426     go_relative (<span class="stringliteral">"GridConnectivityProperty_t"</span>, 1, NULL);
<a name="l03427"></a>03427     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03428"></a>03428         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03429"></a>03429         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03430"></a>03430             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03431"></a>03431                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03432"></a>03432             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03433"></a>03433                 printf (<span class="stringliteral">"      Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03434"></a>03434                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03435"></a>03435             }
<a name="l03436"></a>03436         }
<a name="l03437"></a>03437     }
<a name="l03438"></a>03438     check_user_data (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 6);
<a name="l03439"></a>03439 
<a name="l03440"></a>03440     ierr = <a class="code" href="cgnslib_8c.html#c62526c9622f10f58fcbae7cde01e72b">cg_1to1_periodic_read</a> (cgnsfn, cgnsbase, cgnszone, nc,
<a name="l03441"></a>03441         center, angle, translate);
<a name="l03442"></a>03442     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l03443"></a>03443         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_1to1_periodic_read"</span>);
<a name="l03444"></a>03444     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l03445"></a>03445         <span class="keywordtype">int</span> *punits, units[9], dataclass;
<a name="l03446"></a>03446 
<a name="l03447"></a>03447         puts (<span class="stringliteral">"      checking periodic property"</span>);
<a name="l03448"></a>03448         go_relative (<span class="stringliteral">"Periodic_t"</span>, 1, NULL);
<a name="l03449"></a>03449         <span class="keywordflow">if</span> (verbose) {
<a name="l03450"></a>03450             printf (<span class="stringliteral">"        Center=[%g"</span>, center[0]);
<a name="l03451"></a>03451             <span class="keywordflow">for</span> (n = 1; n &lt; PhyDim; n++)
<a name="l03452"></a>03452                 printf (<span class="stringliteral">",%g"</span>, center[n]);
<a name="l03453"></a>03453             printf (<span class="stringliteral">"]\n        Angle=[%g"</span>, angle[0]);
<a name="l03454"></a>03454             <span class="keywordflow">for</span> (n = 1; n &lt; PhyDim; n++)
<a name="l03455"></a>03455                 printf (<span class="stringliteral">",%g"</span>, angle[n]);
<a name="l03456"></a>03456             printf (<span class="stringliteral">"]\n        Translation=[%g"</span>, translate[0]);
<a name="l03457"></a>03457             <span class="keywordflow">for</span> (n = 1; n &lt; PhyDim; n++)
<a name="l03458"></a>03458                 printf (<span class="stringliteral">",%g"</span>, translate[n]);
<a name="l03459"></a>03459             puts (<span class="stringliteral">"]"</span>);
<a name="l03460"></a>03460             <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03461"></a>03461                 <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03462"></a>03462                 <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03463"></a>03463                     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03464"></a>03464                         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03465"></a>03465                     <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03466"></a>03466                         printf (<span class="stringliteral">"        Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03467"></a>03467                         <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03468"></a>03468                     }
<a name="l03469"></a>03469                 }
<a name="l03470"></a>03470             }
<a name="l03471"></a>03471         }
<a name="l03472"></a>03472 
<a name="l03473"></a>03473         dataclass = read_dataclass ();
<a name="l03474"></a>03474         punits = read_units (units);
<a name="l03475"></a>03475         <span class="keywordflow">if</span> (verbose) {
<a name="l03476"></a>03476             <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 8);
<a name="l03477"></a>03477             <span class="keywordflow">if</span> (punits) print_units (punits, 8);
<a name="l03478"></a>03478         }
<a name="l03479"></a>03479         <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>;
<a name="l03480"></a>03480         <span class="keywordflow">if</span> (punits == NULL) punits = z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>;
<a name="l03481"></a>03481 
<a name="l03482"></a>03482         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_narrays"</span>);
<a name="l03483"></a>03483         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03484"></a>03484             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l03485"></a>03485                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l03486"></a>03486             printf (<span class="stringliteral">"        checking periodic data %s\n"</span>, name);
<a name="l03487"></a>03487             check_quantity (n, name, dataclass, punits, 1, 8);
<a name="l03488"></a>03488         }
<a name="l03489"></a>03489         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l03490"></a>03490     }
<a name="l03491"></a>03491 
<a name="l03492"></a>03492     ierr = <a class="code" href="cgnslib_8c.html#18893f41e3fe2106c05a41157bdce5a1">cg_1to1_average_read</a> (cgnsfn, cgnsbase, cgnszone, nc, &amp;average);
<a name="l03493"></a>03493     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l03494"></a>03494         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_1to1_average_read"</span>);
<a name="l03495"></a>03495     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l03496"></a>03496         puts (<span class="stringliteral">"      checking average interface property"</span>);
<a name="l03497"></a>03497         fflush (stdout);
<a name="l03498"></a>03498         go_relative (<span class="stringliteral">"AverageInterface_t"</span>, 1, NULL);
<a name="l03499"></a>03499         <span class="keywordflow">if</span> (verbose) {
<a name="l03500"></a>03500             printf (<span class="stringliteral">"        Interface Type=%s\n"</span>,
<a name="l03501"></a>03501                 <a class="code" href="cgnslib_8c.html#a2056c30ab04c5dcff5667d574619275">cg_AverageInterfaceTypeName</a> (average));
<a name="l03502"></a>03502             <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03503"></a>03503                 <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03504"></a>03504                 <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03505"></a>03505                     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03506"></a>03506                         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03507"></a>03507                     <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03508"></a>03508                         printf (<span class="stringliteral">"        Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03509"></a>03509                         <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03510"></a>03510                     }
<a name="l03511"></a>03511                 }
<a name="l03512"></a>03512             }
<a name="l03513"></a>03513         }
<a name="l03514"></a>03514         check_user_data (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 8);
<a name="l03515"></a>03515     }
<a name="l03516"></a>03516 <span class="preprocessor">#endif</span>
<a name="l03517"></a>03517 <span class="preprocessor"></span>}
<a name="l03518"></a>03518 
<a name="l03519"></a>03519 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l03520"></a>03520 
<a name="l03521"></a>03521 <span class="keyword">static</span> <span class="keywordtype">void</span> check_conn (<span class="keywordtype">int</span> nc)
<a name="l03522"></a>03522 {
<a name="l03523"></a>03523     <span class="keywordtype">char</span> name[33], dname[33], *desc;
<a name="l03524"></a>03524     <span class="keywordtype">int</span> ierr, n, nd, npts, dnpts, ndim, dims[12];
<a name="l03525"></a>03525     <span class="keywordtype">int</span> <a class="code" href="write__test_8c.html#9bfa00b8588240d8860b072159cce4aa">interp</a>, *pts, *dpts;
<a name="l03526"></a>03526     <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> location;
<a name="l03527"></a>03527     <a class="code" href="cgns_keywords_8h.html#63b65ef61e306a412f1fabc9be3cc6d0">GridConnectivityType_t</a> ctype;
<a name="l03528"></a>03528     <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5">PointSetType_t</a> ptype, dptype;
<a name="l03529"></a>03529     <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe">ZoneType_t</a> dztype;
<a name="l03530"></a>03530     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l03531"></a>03531     <span class="keywordtype">float</span> center[3], angle[3], trans[3];
<a name="l03532"></a>03532     <a class="code" href="cgns_keywords_8h.html#f47b7b9aa4b1c696a7e559427686a083">AverageInterfaceType_t</a> average;
<a name="l03533"></a>03533     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1], *dz;
<a name="l03534"></a>03534 
<a name="l03535"></a>03535     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#c168c1d643364b0723f94a1f9bad3a4d">cg_conn_info</a> (cgnsfn, cgnsbase, cgnszone, nc, name,
<a name="l03536"></a>03536         &amp;location, &amp;ctype, &amp;ptype, &amp;npts, dname, &amp;dztype,
<a name="l03537"></a>03537         &amp;dptype, &amp;datatype, &amp;dnpts)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_conn_info"</span>);
<a name="l03538"></a>03538     printf (<span class="stringliteral">"  checking connectivity \"%s\"\n"</span>, name);
<a name="l03539"></a>03539     <span class="keywordflow">if</span> (verbose) {
<a name="l03540"></a>03540         printf (<span class="stringliteral">"    Connectivity Type=%s\n"</span>,
<a name="l03541"></a>03541             <a class="code" href="cgnslib_8c.html#a50947c392340e9f217131cf36e1bcfb">cg_GridConnectivityTypeName</a>(ctype));
<a name="l03542"></a>03542         printf (<span class="stringliteral">"    Grid Location=%s\n"</span>,
<a name="l03543"></a>03543             <a class="code" href="cgnslib_8c.html#7af88bef6535742b3a0bb04f976ff747">cg_GridLocationName</a>(location));
<a name="l03544"></a>03544         printf (<span class="stringliteral">"    Point Set Type=%s\n"</span>,
<a name="l03545"></a>03545             <a class="code" href="cgnslib_8c.html#6f8fbf63d32639cbaecf055db223423f">cg_PointSetTypeName</a>(ptype));
<a name="l03546"></a>03546         printf (<span class="stringliteral">"    Number Points=%d\n"</span>, npts);
<a name="l03547"></a>03547         printf (<span class="stringliteral">"    Donor Zone=\"%s\"\n"</span>, dname);
<a name="l03548"></a>03548         printf (<span class="stringliteral">"    Donor Zone Type=%s\n"</span>, <a class="code" href="cgnslib_8c.html#1025d15ec67c56b1937a230614494e93">cg_ZoneTypeName</a>(dztype));
<a name="l03549"></a>03549         printf (<span class="stringliteral">"    Donor Point Set Type=%s\n"</span>,
<a name="l03550"></a>03550             <a class="code" href="cgnslib_8c.html#6f8fbf63d32639cbaecf055db223423f">cg_PointSetTypeName</a>(dptype));
<a name="l03551"></a>03551         printf (<span class="stringliteral">"    Donor Number Points=%d\n"</span>, dnpts);
<a name="l03552"></a>03552         printf (<span class="stringliteral">"    Donor Data Type=%s\n"</span>, <a class="code" href="cgnslib_8c.html#4227609b60cff1b1349192871a24dca7">cg_DataTypeName</a>(datatype));
<a name="l03553"></a>03553     }
<a name="l03554"></a>03554     fflush (stdout);
<a name="l03555"></a>03555 
<a name="l03556"></a>03556     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"ZoneGridConnectivity_t"</span>, 1,
<a name="l03557"></a>03557         <span class="stringliteral">"GridConnectivity_t"</span>, nc, NULL);
<a name="l03558"></a>03558     interp = check_interpolants ();
<a name="l03559"></a>03559 
<a name="l03560"></a>03560     ierr = 0;
<a name="l03561"></a>03561     <span class="keywordflow">if</span> (ctype == <a class="code" href="cgns_keywords_8h.html#63b65ef61e306a412f1fabc9be3cc6d094100288a3d8ac9baaff8839a5c12998">Overset</a>) {
<a name="l03562"></a>03562         <span class="keywordflow">if</span> (location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a> &amp;&amp; location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13af82b5a2366c89873ca45b75f6e6ac36">CellCenter</a>)
<a name="l03563"></a>03563             warning (1, <span class="stringliteral">"grid location should be Vertex or CellCenter"</span>);
<a name="l03564"></a>03564     }
<a name="l03565"></a>03565     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ctype == <a class="code" href="cgns_keywords_8h.html#63b65ef61e306a412f1fabc9be3cc6d0b4bf212a4bc8bb877502efce24615895">Abutting</a> || ctype == <a class="code" href="cgns_keywords_8h.html#63b65ef61e306a412f1fabc9be3cc6d0e2171703a7093afe5f858c6873e2ecf6">Abutting1to1</a>) {
<a name="l03566"></a>03566         <span class="keywordflow">if</span> (FileVersion &lt; 2200) {
<a name="l03567"></a>03567             <span class="keywordflow">if</span> (location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a> &amp;&amp; location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13af82b5a2366c89873ca45b75f6e6ac36">CellCenter</a>)
<a name="l03568"></a>03568                 warning (1,
<a name="l03569"></a>03569                     <span class="stringliteral">"grid location should be Vertex or CellCenter"</span>);
<a name="l03570"></a>03570         }
<a name="l03571"></a>03571         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (FileVersion &gt;= 2300) {
<a name="l03572"></a>03572             <span class="keywordflow">switch</span> (location) {
<a name="l03573"></a>03573                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>:
<a name="l03574"></a>03574                     <span class="keywordflow">break</span>;
<a name="l03575"></a>03575                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1345f1c1cdb99ea61bfdddc570c6a02bf2">FaceCenter</a>:
<a name="l03576"></a>03576                     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a>)
<a name="l03577"></a>03577                         warning (2,
<a name="l03578"></a>03578                             <span class="stringliteral">"use [IJK]FaceCenter with Structured grids"</span>);
<a name="l03579"></a>03579                     <span class="keywordflow">break</span>;
<a name="l03580"></a>03580                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13b4cea34ab6a3c3533f2422f66bf8dc3d">IFaceCenter</a>:
<a name="l03581"></a>03581                     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> != <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a>)
<a name="l03582"></a>03582                         error (<span class="stringliteral">"IFaceCenter only valid for Structured grids"</span>);
<a name="l03583"></a>03583                     <span class="keywordflow">break</span>;
<a name="l03584"></a>03584                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e133f9cfc26e3953b1a7f7b8826e119a5d5">JFaceCenter</a>:
<a name="l03585"></a>03585                     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> != <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a> || z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> &lt; 2)
<a name="l03586"></a>03586                         error (<span class="stringliteral">"JFaceCenter only valid for Structured grids"</span>
<a name="l03587"></a>03587                             <span class="stringliteral">" with CellDim &gt; 1"</span>);
<a name="l03588"></a>03588                     <span class="keywordflow">break</span>;
<a name="l03589"></a>03589                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1387cfa4bdd4bc3bd768c3f0bab84f2143">KFaceCenter</a>:
<a name="l03590"></a>03590                     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> != <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a> || z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> &lt; 3)
<a name="l03591"></a>03591                         error (<span class="stringliteral">"KFaceCenter only valid for Structured grids"</span>
<a name="l03592"></a>03592                             <span class="stringliteral">" with CellDim &gt; 2"</span>);
<a name="l03593"></a>03593                     <span class="keywordflow">break</span>;
<a name="l03594"></a>03594                 <span class="keywordflow">case</span> <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13af82b5a2366c89873ca45b75f6e6ac36">CellCenter</a>:
<a name="l03595"></a>03595                     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a>)
<a name="l03596"></a>03596                         warning (2, <span class="stringliteral">"use [IJK]FaceCenter location rather"</span>
<a name="l03597"></a>03597                             <span class="stringliteral">" than CellCenter"</span>);
<a name="l03598"></a>03598                     <span class="keywordflow">else</span>
<a name="l03599"></a>03599                         warning (2, <span class="stringliteral">"use FaceCenter location rather than"</span>
<a name="l03600"></a>03600                             <span class="stringliteral">" CellCenter"</span>);
<a name="l03601"></a>03601                     <span class="keywordflow">break</span>;
<a name="l03602"></a>03602                 <span class="keywordflow">default</span>:
<a name="l03603"></a>03603                     error (<span class="stringliteral">"grid location not Vertex,CellCenter,FaceCenter"</span>
<a name="l03604"></a>03604                         <span class="stringliteral">" or [IJK]FaceCenter"</span>);
<a name="l03605"></a>03605             }
<a name="l03606"></a>03606         }
<a name="l03607"></a>03607         <span class="keywordflow">else</span> {
<a name="l03608"></a>03608             <span class="keywordflow">if</span> (location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a> &amp;&amp; location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13af82b5a2366c89873ca45b75f6e6ac36">CellCenter</a> &amp;&amp;
<a name="l03609"></a>03609                 location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1345f1c1cdb99ea61bfdddc570c6a02bf2">FaceCenter</a>)
<a name="l03610"></a>03610                 warning (1, <span class="stringliteral">"grid location should be Vertex, FaceCenter"</span>
<a name="l03611"></a>03611                     <span class="stringliteral">" or CellCenter"</span>);
<a name="l03612"></a>03612         }
<a name="l03613"></a>03613     }
<a name="l03614"></a>03614     <span class="keywordflow">else</span> {
<a name="l03615"></a>03615         error (<span class="stringliteral">"connectivity type not Overset,Abutting or Abutting1to1"</span>);
<a name="l03616"></a>03616         ierr++;
<a name="l03617"></a>03617     }
<a name="l03618"></a>03618     <span class="keywordflow">if</span> (location &lt; Vertex || location &gt;= <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1320321805f8609b15483a7cd6e15e2d87">EdgeCenter</a>) ierr++;
<a name="l03619"></a>03619 
<a name="l03620"></a>03620     <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a>) {
<a name="l03621"></a>03621         <span class="keywordflow">if</span> (npts != 2) {
<a name="l03622"></a>03622             error (<span class="stringliteral">"number of points is not 2 for PointRange"</span>);
<a name="l03623"></a>03623             ierr++;
<a name="l03624"></a>03624         }
<a name="l03625"></a>03625     }
<a name="l03626"></a>03626     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d9df12b6366abf1175abbfca72f5f43e">PointList</a>) {
<a name="l03627"></a>03627         <span class="keywordflow">if</span> (npts &lt; 1) {
<a name="l03628"></a>03628             error (<span class="stringliteral">"number of points is less than 1"</span>);
<a name="l03629"></a>03629             ierr++;
<a name="l03630"></a>03630         }
<a name="l03631"></a>03631     }
<a name="l03632"></a>03632     <span class="keywordflow">else</span> {
<a name="l03633"></a>03633         error (<span class="stringliteral">"point set type is not PointList or PointRange"</span>);
<a name="l03634"></a>03634         ierr++;
<a name="l03635"></a>03635     }
<a name="l03636"></a>03636 
<a name="l03637"></a>03637     <span class="keywordflow">for</span> (dz = NULL, n = 0; n &lt; NumZones; n++) {
<a name="l03638"></a>03638         <span class="keywordflow">if</span> (0 == strcmp (dname, Zones[n].name)) {
<a name="l03639"></a>03639             dz = &amp;Zones[n];
<a name="l03640"></a>03640             <span class="keywordflow">break</span>;
<a name="l03641"></a>03641         }
<a name="l03642"></a>03642     }
<a name="l03643"></a>03643     <span class="keywordflow">if</span> (dz == NULL) {
<a name="l03644"></a>03644         error (<span class="stringliteral">"donor zone \"%s\" not found"</span>, dname);
<a name="l03645"></a>03645         ierr++;
<a name="l03646"></a>03646     }
<a name="l03647"></a>03647     <span class="keywordflow">else</span> {
<a name="l03648"></a>03648         <span class="keywordflow">if</span> (dztype != dz-&gt;type) {
<a name="l03649"></a>03649             error (<span class="stringliteral">"returned donor zone type does not match actual zone type"</span>);
<a name="l03650"></a>03650             ierr++;
<a name="l03651"></a>03651         }
<a name="l03652"></a>03652     }
<a name="l03653"></a>03653 
<a name="l03654"></a>03654     <span class="keywordflow">if</span> (dptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d2e439dbdf858e41f5c29dd5d778bb70">PointListDonor</a>) {
<a name="l03655"></a>03655         <span class="keywordflow">if</span> (ctype != <a class="code" href="cgns_keywords_8h.html#63b65ef61e306a412f1fabc9be3cc6d0e2171703a7093afe5f858c6873e2ecf6">Abutting1to1</a> &amp;&amp; FileVersion &gt;= 2000)
<a name="l03656"></a>03656             warning (1, <span class="stringliteral">"PointListDonor should only be used for Abutting1to1"</span>);
<a name="l03657"></a>03657         <span class="keywordflow">if</span> (interp)
<a name="l03658"></a>03658             warning (1, <span class="stringliteral">"InterpolantsDonor given for PointListDonor"</span>);
<a name="l03659"></a>03659     }
<a name="l03660"></a>03660     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5bbbff63b3b10923bda220174f8603760">CellListDonor</a>) {
<a name="l03661"></a>03661         <span class="keywordflow">if</span> (interp) {
<a name="l03662"></a>03662             <span class="keywordflow">if</span> (LibraryVersion &lt; 2000)
<a name="l03663"></a>03663                 warning (1,
<a name="l03664"></a>03664                     <span class="stringliteral">"InterpolantsDonor given but they are not readable\n"</span>
<a name="l03665"></a>03665                     <span class="stringliteral">"        due to a bug in the CGNS library prior to 2.0"</span>);
<a name="l03666"></a>03666         }
<a name="l03667"></a>03667         <span class="keywordflow">else</span>
<a name="l03668"></a>03668             warning (1, <span class="stringliteral">"InterpolantsDonor not given for CellListDonor"</span>);
<a name="l03669"></a>03669     }
<a name="l03670"></a>03670     <span class="keywordflow">else</span> {
<a name="l03671"></a>03671         error (<span class="stringliteral">"donor point set type is not PointListDonor or CellListDonor"</span>);
<a name="l03672"></a>03672         ierr++;
<a name="l03673"></a>03673     }
<a name="l03674"></a>03674 
<a name="l03675"></a>03675     <span class="keywordflow">if</span> (dnpts &lt; 1) {
<a name="l03676"></a>03676         error (<span class="stringliteral">"donor number of points is less than 1"</span>);
<a name="l03677"></a>03677         ierr++;
<a name="l03678"></a>03678     }
<a name="l03679"></a>03679     <span class="keywordflow">if</span> (ierr) npts = 0;
<a name="l03680"></a>03680 
<a name="l03681"></a>03681     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03682"></a>03682         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03683"></a>03683         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03684"></a>03684             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03685"></a>03685                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03686"></a>03686             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03687"></a>03687                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03688"></a>03688                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03689"></a>03689             }
<a name="l03690"></a>03690         }
<a name="l03691"></a>03691     }
<a name="l03692"></a>03692 
<a name="l03693"></a>03693     ierr = read_ordinal (&amp;n);
<a name="l03694"></a>03694     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ordinal_read"</span>);
<a name="l03695"></a>03695     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a> &amp;&amp; verbose)
<a name="l03696"></a>03696         printf (<span class="stringliteral">"    Ordinal=%d\n"</span>, n);
<a name="l03697"></a>03697 
<a name="l03698"></a>03698     check_user_data (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 4);
<a name="l03699"></a>03699 
<a name="l03700"></a>03700     <span class="keywordflow">if</span> (npts &amp;&amp; dnpts) {
<a name="l03701"></a>03701         pts = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (npts * z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03702"></a>03702         <span class="keywordflow">if</span> (LibraryVersion &lt; 2200) {
<a name="l03703"></a>03703             <span class="comment">/* a bug in version prior to 2.2 causes the base cell dimension */</span>
<a name="l03704"></a>03704             <span class="comment">/* to be used here, instead of the donor zone index dimension */</span>
<a name="l03705"></a>03705             dpts = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (dnpts * <a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03706"></a>03706         }
<a name="l03707"></a>03707         <span class="keywordflow">else</span>
<a name="l03708"></a>03708             dpts = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (dnpts * dz-&gt;idim * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03709"></a>03709         <span class="keywordflow">if</span> (NULL == pts || NULL == dpts) {
<a name="l03710"></a>03710             fprintf (stderr, <span class="stringliteral">"malloc failed for connectivity points\n"</span>);
<a name="l03711"></a>03711             exit (1);
<a name="l03712"></a>03712         }
<a name="l03713"></a>03713         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2c707ea6be10a41725be74ffb26740bf">cg_conn_read</a> (cgnsfn, cgnsbase, cgnszone, nc, pts, <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1e2f89e867cd91c3de2ea9fbd2ef96a3">Integer</a>, dpts))
<a name="l03714"></a>03714             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_conn_read"</span>);
<a name="l03715"></a>03715 
<a name="l03716"></a>03716         puts (<span class="stringliteral">"    checking connectivity interface"</span>);
<a name="l03717"></a>03717         fflush (stdout);
<a name="l03718"></a>03718         check_interface (z, ptype, location, npts, pts, ctype != <a class="code" href="cgns_keywords_8h.html#63b65ef61e306a412f1fabc9be3cc6d094100288a3d8ac9baaff8839a5c12998">Overset</a>);
<a name="l03719"></a>03719         <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (pts);
<a name="l03720"></a>03720 
<a name="l03721"></a>03721         puts (<span class="stringliteral">"    checking donor zone interface"</span>);
<a name="l03722"></a>03722         fflush (stdout);
<a name="l03723"></a>03723         check_interface (dz, dptype, location, dnpts, dpts, ctype != <a class="code" href="cgns_keywords_8h.html#63b65ef61e306a412f1fabc9be3cc6d094100288a3d8ac9baaff8839a5c12998">Overset</a>);
<a name="l03724"></a>03724         <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (dpts);
<a name="l03725"></a>03725     }
<a name="l03726"></a>03726 
<a name="l03727"></a>03727     <span class="keywordflow">if</span> (check_node (<span class="stringliteral">"GridConnectivityProperty_t"</span>)) <span class="keywordflow">return</span>;
<a name="l03728"></a>03728     puts (<span class="stringliteral">"    checking grid connectivity property"</span>);
<a name="l03729"></a>03729     fflush (stdout);
<a name="l03730"></a>03730     go_relative (<span class="stringliteral">"GridConnectivityProperty_t"</span>, 1, NULL);
<a name="l03731"></a>03731     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03732"></a>03732         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03733"></a>03733         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03734"></a>03734             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03735"></a>03735                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03736"></a>03736             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03737"></a>03737                 printf (<span class="stringliteral">"      Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03738"></a>03738                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03739"></a>03739             }
<a name="l03740"></a>03740         }
<a name="l03741"></a>03741     }
<a name="l03742"></a>03742     check_user_data (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 6);
<a name="l03743"></a>03743 
<a name="l03744"></a>03744     ierr = <a class="code" href="cgnslib_8c.html#fa00ee1323a94daa2f6574ea8a230060">cg_conn_periodic_read</a> (cgnsfn, cgnsbase, cgnszone, nc,
<a name="l03745"></a>03745         center, angle, trans);
<a name="l03746"></a>03746     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l03747"></a>03747         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_conn_periodic_read"</span>);
<a name="l03748"></a>03748     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l03749"></a>03749         <span class="keywordtype">int</span> *punits, units[9], dataclass;
<a name="l03750"></a>03750 
<a name="l03751"></a>03751         puts (<span class="stringliteral">"      checking periodic property"</span>);
<a name="l03752"></a>03752         go_relative (<span class="stringliteral">"Periodic_t"</span>, 1, NULL);
<a name="l03753"></a>03753         <span class="keywordflow">if</span> (verbose) {
<a name="l03754"></a>03754             printf (<span class="stringliteral">"        Center=[%g"</span>, center[0]);
<a name="l03755"></a>03755             <span class="keywordflow">for</span> (n = 1; n &lt; PhyDim; n++)
<a name="l03756"></a>03756                 printf (<span class="stringliteral">",%g"</span>, center[n]);
<a name="l03757"></a>03757             printf (<span class="stringliteral">"]\n        Angle=[%g"</span>, angle[0]);
<a name="l03758"></a>03758             <span class="keywordflow">for</span> (n = 1; n &lt; PhyDim; n++)
<a name="l03759"></a>03759                 printf (<span class="stringliteral">",%g"</span>, angle[n]);
<a name="l03760"></a>03760             printf (<span class="stringliteral">"]\n        Translation=[%g"</span>, trans[0]);
<a name="l03761"></a>03761             <span class="keywordflow">for</span> (n = 1; n &lt; PhyDim; n++)
<a name="l03762"></a>03762                 printf (<span class="stringliteral">",%g"</span>, trans[n]);
<a name="l03763"></a>03763             puts (<span class="stringliteral">"]"</span>);
<a name="l03764"></a>03764             <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03765"></a>03765                 <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03766"></a>03766                 <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03767"></a>03767                     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03768"></a>03768                         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03769"></a>03769                     <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03770"></a>03770                         printf (<span class="stringliteral">"        Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03771"></a>03771                         <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03772"></a>03772                     }
<a name="l03773"></a>03773                 }
<a name="l03774"></a>03774             }
<a name="l03775"></a>03775         }
<a name="l03776"></a>03776 
<a name="l03777"></a>03777         dataclass = read_dataclass ();
<a name="l03778"></a>03778         punits = read_units (units);
<a name="l03779"></a>03779         <span class="keywordflow">if</span> (verbose) {
<a name="l03780"></a>03780             <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 8);
<a name="l03781"></a>03781             <span class="keywordflow">if</span> (punits) print_units (punits, 8);
<a name="l03782"></a>03782         }
<a name="l03783"></a>03783         <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>;
<a name="l03784"></a>03784         <span class="keywordflow">if</span> (punits == NULL) punits = z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>;
<a name="l03785"></a>03785 
<a name="l03786"></a>03786         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_narrays"</span>);
<a name="l03787"></a>03787         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03788"></a>03788             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l03789"></a>03789                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l03790"></a>03790             printf (<span class="stringliteral">"        checking periodic data %s\n"</span>, name);
<a name="l03791"></a>03791             check_quantity (n, name, dataclass, punits, 1, 8);
<a name="l03792"></a>03792         }
<a name="l03793"></a>03793         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l03794"></a>03794     }
<a name="l03795"></a>03795 
<a name="l03796"></a>03796     ierr = <a class="code" href="cgnslib_8c.html#9a741d1eb4a56d7179950c0c7bb0a29e">cg_conn_average_read</a> (cgnsfn, cgnsbase, cgnszone, nc, &amp;average);
<a name="l03797"></a>03797     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l03798"></a>03798         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_conn_average_read"</span>);
<a name="l03799"></a>03799     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l03800"></a>03800         puts (<span class="stringliteral">"      checking average interface property"</span>);
<a name="l03801"></a>03801         fflush (stdout);
<a name="l03802"></a>03802         go_relative (<span class="stringliteral">"AverageInterface_t"</span>, 1, NULL);
<a name="l03803"></a>03803         <span class="keywordflow">if</span> (verbose) {
<a name="l03804"></a>03804             printf (<span class="stringliteral">"        Interface Type=%s\n"</span>,
<a name="l03805"></a>03805                 <a class="code" href="cgnslib_8c.html#a2056c30ab04c5dcff5667d574619275">cg_AverageInterfaceTypeName</a> (average));
<a name="l03806"></a>03806             <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03807"></a>03807                 <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03808"></a>03808                 <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03809"></a>03809                     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03810"></a>03810                         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03811"></a>03811                     <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03812"></a>03812                         printf (<span class="stringliteral">"        Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03813"></a>03813                         <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03814"></a>03814                     }
<a name="l03815"></a>03815                 }
<a name="l03816"></a>03816             }
<a name="l03817"></a>03817         }
<a name="l03818"></a>03818         check_user_data (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 8);
<a name="l03819"></a>03819     }
<a name="l03820"></a>03820 }
<a name="l03821"></a>03821 
<a name="l03822"></a>03822 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l03823"></a>03823 
<a name="l03824"></a>03824 <span class="keyword">static</span> <span class="keywordtype">void</span> check_hole (<span class="keywordtype">int</span> nh)
<a name="l03825"></a>03825 {
<a name="l03826"></a>03826     <span class="keywordtype">char</span> name[33];
<a name="l03827"></a>03827     <span class="keywordtype">int</span> ierr, n, nptsets, npts, np;
<a name="l03828"></a>03828     <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> location;
<a name="l03829"></a>03829     <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5">PointSetType_t</a> ptype;
<a name="l03830"></a>03830     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1];
<a name="l03831"></a>03831 
<a name="l03832"></a>03832     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#26f6aa29d94b699e96af897afd2bfb67">cg_hole_info</a> (cgnsfn, cgnsbase, cgnszone, nh, name,
<a name="l03833"></a>03833         &amp;location, &amp;ptype, &amp;nptsets, &amp;npts)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_hole_info"</span>);
<a name="l03834"></a>03834     printf (<span class="stringliteral">"  checking overset hole \"%s\"\n"</span>, name);
<a name="l03835"></a>03835     <span class="keywordflow">if</span> (verbose) {
<a name="l03836"></a>03836         printf (<span class="stringliteral">"    Grid Location=%s\n"</span>,
<a name="l03837"></a>03837             <a class="code" href="cgnslib_8c.html#7af88bef6535742b3a0bb04f976ff747">cg_GridLocationName</a>(location));
<a name="l03838"></a>03838         printf (<span class="stringliteral">"    Point Set Type=%s\n"</span>,
<a name="l03839"></a>03839             <a class="code" href="cgnslib_8c.html#6f8fbf63d32639cbaecf055db223423f">cg_PointSetTypeName</a>(ptype));
<a name="l03840"></a>03840         printf (<span class="stringliteral">"    Number Point Sets=%d\n"</span>, nptsets);
<a name="l03841"></a>03841     }
<a name="l03842"></a>03842     fflush (stdout);
<a name="l03843"></a>03843 
<a name="l03844"></a>03844     ierr = np = 0;
<a name="l03845"></a>03845     <span class="keywordflow">if</span> (location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a> &amp;&amp; location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13af82b5a2366c89873ca45b75f6e6ac36">CellCenter</a>) {
<a name="l03846"></a>03846         error (<span class="stringliteral">"location not Vertex or CellCenter"</span>);
<a name="l03847"></a>03847         ierr++;
<a name="l03848"></a>03848     }
<a name="l03849"></a>03849     <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a>) {
<a name="l03850"></a>03850         <span class="keywordflow">if</span> (nptsets &lt; 1)
<a name="l03851"></a>03851             error (<span class="stringliteral">"nptsets must be greater then 0 for PointRange"</span>);
<a name="l03852"></a>03852         <span class="keywordflow">if</span> (npts != 2 * nptsets)
<a name="l03853"></a>03853             error (<span class="stringliteral">"npts not equal to 2 * nptsets for PointRange"</span>);
<a name="l03854"></a>03854         np = 2 * nptsets;
<a name="l03855"></a>03855     }
<a name="l03856"></a>03856     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5d9df12b6366abf1175abbfca72f5f43e">PointList</a>) {
<a name="l03857"></a>03857         <span class="keywordflow">if</span> (nptsets != 1)
<a name="l03858"></a>03858             error (<span class="stringliteral">"nptsets must be 1 for PointList"</span>);
<a name="l03859"></a>03859         <span class="keywordflow">if</span> (npts &lt; 1)
<a name="l03860"></a>03860             error (<span class="stringliteral">"npts is less than 1 for PointList"</span>);
<a name="l03861"></a>03861         nptsets = 1;
<a name="l03862"></a>03862         np = npts;
<a name="l03863"></a>03863     }
<a name="l03864"></a>03864     <span class="keywordflow">else</span> {
<a name="l03865"></a>03865         error (<span class="stringliteral">"point set type not PointList or PointRange"</span>);
<a name="l03866"></a>03866         ierr++;
<a name="l03867"></a>03867     }
<a name="l03868"></a>03868 
<a name="l03869"></a>03869     <span class="keywordflow">if</span> (!ierr &amp;&amp; np &gt; 0) {
<a name="l03870"></a>03870         <span class="keywordtype">int</span> *<a class="code" href="write__bcdata_8c.html#5e162cfaac90b1bb6effc1042b58b64e">pnts</a> = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (np * z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l03871"></a>03871         <span class="keywordflow">if</span> (pnts == NULL) {
<a name="l03872"></a>03872             fprintf (stderr, <span class="stringliteral">"malloc failed for hole data\n"</span>);
<a name="l03873"></a>03873             exit (1);
<a name="l03874"></a>03874         }
<a name="l03875"></a>03875         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#32478e71f96b0a1ff8f95aacf7c9a1d9">cg_hole_read</a> (cgnsfn, cgnsbase, cgnszone, nh, pnts))
<a name="l03876"></a>03876             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_hole_read"</span>);
<a name="l03877"></a>03877         <span class="keywordflow">if</span> (ptype == <a class="code" href="cgns_keywords_8h.html#82fcf406991383f888f145541f6616f5e5d03a0d4cdaa9d5c45a500029bd3783">PointRange</a>) npts = 2;
<a name="l03878"></a>03878         <span class="keywordflow">for</span> (np = 0, n = 1; n &lt;= nptsets; n++) {
<a name="l03879"></a>03879             printf (<span class="stringliteral">"    checking point set %d interface\n"</span>, n);
<a name="l03880"></a>03880             fflush (stdout);
<a name="l03881"></a>03881             check_interface (z, ptype, location, npts, &amp;pnts[np], <a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a>);
<a name="l03882"></a>03882             np += npts * z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>;
<a name="l03883"></a>03883         }
<a name="l03884"></a>03884         <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (pnts);
<a name="l03885"></a>03885     }
<a name="l03886"></a>03886 
<a name="l03887"></a>03887     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"ZoneGridConnectivity_t"</span>, 1,
<a name="l03888"></a>03888         <span class="stringliteral">"OversetHoles_t"</span>, nh, NULL);
<a name="l03889"></a>03889 
<a name="l03890"></a>03890     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03891"></a>03891         <span class="keywordtype">int</span> nd;
<a name="l03892"></a>03892         <span class="keywordtype">char</span> *desc;
<a name="l03893"></a>03893         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03894"></a>03894         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03895"></a>03895             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03896"></a>03896                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03897"></a>03897             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03898"></a>03898                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03899"></a>03899                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03900"></a>03900             }
<a name="l03901"></a>03901         }
<a name="l03902"></a>03902     }
<a name="l03903"></a>03903 
<a name="l03904"></a>03904     check_user_data (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 4);
<a name="l03905"></a>03905 }
<a name="l03906"></a>03906 
<a name="l03907"></a>03907 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l03908"></a>03908 
<a name="l03909"></a>03909 <span class="keyword">static</span> <span class="keywordtype">void</span> check_connectivity (<span class="keywordtype">void</span>)
<a name="l03910"></a>03910 {
<a name="l03911"></a>03911     <span class="keywordtype">int</span> ierr, n, nc;
<a name="l03912"></a>03912 
<a name="l03913"></a>03913     ierr = <a class="code" href="cgnslib_8c.html#63032357d34526e53edd521dc4f59ae4">cg_goto</a> (cgnsfn, cgnsbase, <span class="stringliteral">"Zone_t"</span>, cgnszone,
<a name="l03914"></a>03914         <span class="stringliteral">"ZoneGridConnectivity_t"</span>, 1, <span class="stringliteral">"end"</span>);
<a name="l03915"></a>03915     <span class="keywordflow">if</span> (ierr) {
<a name="l03916"></a>03916         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_goto"</span>);
<a name="l03917"></a>03917         <span class="keywordflow">return</span>;
<a name="l03918"></a>03918     }
<a name="l03919"></a>03919     puts (<span class="stringliteral">"  checking zone grid connectivty"</span>);
<a name="l03920"></a>03920     fflush (stdout);
<a name="l03921"></a>03921     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"ZoneGridConnectivity_t"</span>, 1, NULL);
<a name="l03922"></a>03922 
<a name="l03923"></a>03923     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l03924"></a>03924         <span class="keywordtype">int</span> nd;
<a name="l03925"></a>03925         <span class="keywordtype">char</span> name[33], *desc;
<a name="l03926"></a>03926         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l03927"></a>03927         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l03928"></a>03928             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l03929"></a>03929                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l03930"></a>03930             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l03931"></a>03931                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l03932"></a>03932                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l03933"></a>03933             }
<a name="l03934"></a>03934         }
<a name="l03935"></a>03935     }
<a name="l03936"></a>03936 
<a name="l03937"></a>03937     check_user_data (Zones[cgnszone-1].dataclass, Zones[cgnszone-1].punits, 4);
<a name="l03938"></a>03938 
<a name="l03939"></a>03939     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#ff2d0c2c90ebef2bf8b104bdeb507ba7">cg_n1to1</a> (cgnsfn, cgnsbase, cgnszone, &amp;nc)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_n1to1"</span>);
<a name="l03940"></a>03940     <span class="keywordflow">for</span> (n = 1; n &lt;= nc; n++)
<a name="l03941"></a>03941          check_1to1 (n);
<a name="l03942"></a>03942 
<a name="l03943"></a>03943     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2f74cda15fa5aa0f3adb2319496f9e4f">cg_nconns</a> (cgnsfn, cgnsbase, cgnszone, &amp;nc)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_nconns"</span>);
<a name="l03944"></a>03944     <span class="keywordflow">for</span> (n = 1; n &lt;= nc; n++)
<a name="l03945"></a>03945         check_conn (n);
<a name="l03946"></a>03946 
<a name="l03947"></a>03947     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3a0e6319ddad911e027b4b1df88fc140">cg_nholes</a> (cgnsfn, cgnsbase, cgnszone, &amp;nc)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_nholes"</span>);
<a name="l03948"></a>03948     <span class="keywordflow">for</span> (n = 1; n &lt;= nc; n++)
<a name="l03949"></a>03949         check_hole (n);
<a name="l03950"></a>03950 }
<a name="l03951"></a>03951 
<a name="l03952"></a>03952 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l03953"></a>03953 
<a name="l03954"></a>03954 <span class="keyword">static</span> <span class="keywordtype">void</span> check_arbitrary_motion (<span class="keywordtype">int</span> na)
<a name="l03955"></a>03955 {
<a name="l03956"></a>03956     <span class="keywordtype">char</span> name[33];
<a name="l03957"></a>03957     <span class="keywordtype">int</span> ierr, n, nd, id, rind[6];
<a name="l03958"></a>03958     <span class="keywordtype">int</span> datasize, size, ndim, dims[12];
<a name="l03959"></a>03959     <span class="keywordtype">int</span> *punits, units[9], dataclass;
<a name="l03960"></a>03960     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l03961"></a>03961     <a class="code" href="cgns_keywords_8h.html#7c3ea967ff670b6a0961dcb231d4739c">ArbitraryGridMotionType_t</a> type;
<a name="l03962"></a>03962     <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> location;
<a name="l03963"></a>03963     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1];
<a name="l03964"></a>03964 
<a name="l03965"></a>03965     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#80cd4533e894bd61a1ccb82a87d1b417">cg_arbitrary_motion_read</a> (cgnsfn, cgnsbase, cgnszone,
<a name="l03966"></a>03966             na, name, &amp;type)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_arbitrary_motion_read"</span>);
<a name="l03967"></a>03967     strcpy (ArbitraryGrid[na-1], name);
<a name="l03968"></a>03968     printf (<span class="stringliteral">"  checking arbitrary motion \"%s\"\n"</span>, name);
<a name="l03969"></a>03969     <span class="keywordflow">if</span> (verbose)
<a name="l03970"></a>03970         printf (<span class="stringliteral">"    Arbitrary Motion Type=%s\n"</span>,
<a name="l03971"></a>03971             <a class="code" href="cgnslib_8c.html#896012894566788e8b2fe455f32c563d">cg_ArbitraryGridMotionTypeName</a> (type));
<a name="l03972"></a>03972     fflush (stdout);
<a name="l03973"></a>03973 
<a name="l03974"></a>03974     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"ArbitraryGridMotion_t"</span>, na, NULL);
<a name="l03975"></a>03975 
<a name="l03976"></a>03976     <span class="comment">/* grid location */</span>
<a name="l03977"></a>03977 
<a name="l03978"></a>03978     ierr = read_gridlocation (&amp;location);
<a name="l03979"></a>03979     <span class="keywordflow">if</span> (ierr) {
<a name="l03980"></a>03980         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_gridlocation_read"</span>);
<a name="l03981"></a>03981         location = <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>;
<a name="l03982"></a>03982     }
<a name="l03983"></a>03983     <span class="keywordflow">else</span> {
<a name="l03984"></a>03984         <span class="keywordflow">if</span> (verbose)
<a name="l03985"></a>03985             printf (<span class="stringliteral">"    Grid Location=%s\n"</span>, <a class="code" href="cgnslib_8c.html#7af88bef6535742b3a0bb04f976ff747">cg_GridLocationName</a>(location));
<a name="l03986"></a>03986     }
<a name="l03987"></a>03987 
<a name="l03988"></a>03988     <span class="comment">/* rind */</span>
<a name="l03989"></a>03989 
<a name="l03990"></a>03990     ierr = read_rind (rind);
<a name="l03991"></a>03991     <span class="keywordflow">if</span> (ierr) {
<a name="l03992"></a>03992         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_rind_read"</span>);
<a name="l03993"></a>03993         <span class="keywordflow">for</span> (n = 0; n &lt; 6; n++)
<a name="l03994"></a>03994             rind[n] = 0;
<a name="l03995"></a>03995     }
<a name="l03996"></a>03996     <span class="keywordflow">else</span> {
<a name="l03997"></a>03997         <span class="keywordflow">if</span> (verbose) {
<a name="l03998"></a>03998             printf (<span class="stringliteral">"    Rind=[%d"</span>, rind[0]);
<a name="l03999"></a>03999             <span class="keywordflow">for</span> (n = 1; n &lt; 2 * z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++)
<a name="l04000"></a>04000                 printf (<span class="stringliteral">",%d"</span>, rind[n]);
<a name="l04001"></a>04001             puts (<span class="stringliteral">"]"</span>);
<a name="l04002"></a>04002         }
<a name="l04003"></a>04003         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fedef7de5f4ce5345ffd8e2726df46e388">Unstructured</a> &amp;&amp; FileVersion &lt; 2400)
<a name="l04004"></a>04004             error (<span class="stringliteral">"rind not valid for unstructured zones"</span>);
<a name="l04005"></a>04005     }
<a name="l04006"></a>04006 
<a name="l04007"></a>04007     <span class="comment">/* descriptors */</span>
<a name="l04008"></a>04008 
<a name="l04009"></a>04009     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l04010"></a>04010         <span class="keywordtype">char</span> *desc;
<a name="l04011"></a>04011         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l04012"></a>04012         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04013"></a>04013             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l04014"></a>04014                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l04015"></a>04015             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l04016"></a>04016                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l04017"></a>04017                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04018"></a>04018             }
<a name="l04019"></a>04019         }
<a name="l04020"></a>04020     }
<a name="l04021"></a>04021 
<a name="l04022"></a>04022     <span class="comment">/* dataclass and dimensional units */</span>
<a name="l04023"></a>04023 
<a name="l04024"></a>04024     dataclass = read_dataclass ();
<a name="l04025"></a>04025     punits = read_units (units);
<a name="l04026"></a>04026     <span class="keywordflow">if</span> (verbose) {
<a name="l04027"></a>04027         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 4);
<a name="l04028"></a>04028         <span class="keywordflow">if</span> (punits) print_units (punits, 4);
<a name="l04029"></a>04029     }
<a name="l04030"></a>04030     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>;
<a name="l04031"></a>04031     <span class="keywordflow">if</span> (punits == NULL) punits = z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>;
<a name="l04032"></a>04032 
<a name="l04033"></a>04033     <span class="comment">/* get grid data */</span>
<a name="l04034"></a>04034 
<a name="l04035"></a>04035     datasize = get_data_size (z, location, rind);
<a name="l04036"></a>04036 
<a name="l04037"></a>04037     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_narrays"</span>);
<a name="l04038"></a>04038     <span class="keywordflow">if</span> (nd == 0 &amp;&amp; type != <a class="code" href="cgns_keywords_8h.html#7c3ea967ff670b6a0961dcb231d4739c53b5cd189424b0ca18dd9641a54e88ba">DeformingGrid</a>)
<a name="l04039"></a>04039         warning (1, <span class="stringliteral">"grid velocity data is missing"</span>);
<a name="l04040"></a>04040 
<a name="l04041"></a>04041     <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04042"></a>04042         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l04043"></a>04043             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l04044"></a>04044         printf (<span class="stringliteral">"    checking grid velocity \"%s\"\n"</span>, name);
<a name="l04045"></a>04045         fflush (stdout);
<a name="l04046"></a>04046         <span class="keywordflow">for</span> (size = 1, <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ndim; <span class="keywordtype">id</span>++)
<a name="l04047"></a>04047             size *= dims[<span class="keywordtype">id</span>];
<a name="l04048"></a>04048         <span class="keywordflow">if</span> (ndim != z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> || size &lt; 1 ||
<a name="l04049"></a>04049             (datasize &amp;&amp; size != datasize))
<a name="l04050"></a>04050             error (<span class="stringliteral">"bad dimension values"</span>);
<a name="l04051"></a>04051         check_quantity (n, name, dataclass, punits, 1, 6);
<a name="l04052"></a>04052     }
<a name="l04053"></a>04053 
<a name="l04054"></a>04054     check_user_data (dataclass, punits, 4);
<a name="l04055"></a>04055 }
<a name="l04056"></a>04056 
<a name="l04057"></a>04057 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l04058"></a>04058 
<a name="l04059"></a>04059 <span class="keyword">static</span> <span class="keywordtype">void</span> check_rigid_motion (<span class="keywordtype">int</span> nr)
<a name="l04060"></a>04060 {
<a name="l04061"></a>04061     <span class="keywordtype">char</span> name[33];
<a name="l04062"></a>04062     <span class="keywordtype">int</span> n, nd, i, ndim, dims[12], size;
<a name="l04063"></a>04063     <span class="keywordtype">int</span> dataclass, *punits, units[9];
<a name="l04064"></a>04064     <a class="code" href="cgns_keywords_8h.html#a602987845520a58bcd078d161445d92">RigidGridMotionType_t</a> type;
<a name="l04065"></a>04065     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l04066"></a>04066     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1];
<a name="l04067"></a>04067 
<a name="l04068"></a>04068     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#d9a9c0df999939685fac9e6c0e689e40">cg_rigid_motion_read</a> (cgnsfn, cgnsbase, cgnszone,
<a name="l04069"></a>04069             nr, name, &amp;type)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_rigid_motion_read"</span>);
<a name="l04070"></a>04070     strcpy (RigidGrid[nr-1], name);
<a name="l04071"></a>04071     printf (<span class="stringliteral">"  checking rigid motion \"%s\"\n"</span>, name);
<a name="l04072"></a>04072     <span class="keywordflow">if</span> (verbose)
<a name="l04073"></a>04073         printf (<span class="stringliteral">"    Rigid Motion Type=%s\n"</span>,
<a name="l04074"></a>04074             <a class="code" href="cgnslib_8c.html#0475867506c858a9b3949eafb1096f27">cg_RigidGridMotionTypeName</a> (type));
<a name="l04075"></a>04075     fflush (stdout);
<a name="l04076"></a>04076 
<a name="l04077"></a>04077     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"RigidGridMotion_t"</span>, nr, NULL);
<a name="l04078"></a>04078 
<a name="l04079"></a>04079     <span class="comment">/* descriptors */</span>
<a name="l04080"></a>04080 
<a name="l04081"></a>04081     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l04082"></a>04082         <span class="keywordtype">char</span> *desc;
<a name="l04083"></a>04083         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l04084"></a>04084         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04085"></a>04085             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l04086"></a>04086                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l04087"></a>04087             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l04088"></a>04088                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l04089"></a>04089                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04090"></a>04090             }
<a name="l04091"></a>04091         }
<a name="l04092"></a>04092     }
<a name="l04093"></a>04093 
<a name="l04094"></a>04094     <span class="comment">/* dataclass and dimensional units */</span>
<a name="l04095"></a>04095 
<a name="l04096"></a>04096     dataclass = read_dataclass ();
<a name="l04097"></a>04097     punits = read_units (units);
<a name="l04098"></a>04098     <span class="keywordflow">if</span> (verbose) {
<a name="l04099"></a>04099         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 4);
<a name="l04100"></a>04100         <span class="keywordflow">if</span> (punits) print_units (punits, 4);
<a name="l04101"></a>04101     }
<a name="l04102"></a>04102     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>;
<a name="l04103"></a>04103     <span class="keywordflow">if</span> (punits == NULL) punits = z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>;
<a name="l04104"></a>04104 
<a name="l04105"></a>04105     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_narrays"</span>);
<a name="l04106"></a>04106     <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04107"></a>04107         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l04108"></a>04108             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l04109"></a>04109         printf (<span class="stringliteral">"    checking rigid grid data \"%s\"\n"</span>, name);
<a name="l04110"></a>04110         fflush (stdout);
<a name="l04111"></a>04111         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"OriginLocation"</span>)) {
<a name="l04112"></a>04112             <span class="keywordflow">if</span> (ndim != 2 || dims[0] != PhyDim || dims[1] != 2)
<a name="l04113"></a>04113                 error (<span class="stringliteral">"bad dimension values"</span>);
<a name="l04114"></a>04114             check_quantity (n, name, dataclass, punits, 1, 6);
<a name="l04115"></a>04115         }
<a name="l04116"></a>04116         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"RigidRotationAngle"</span>) ||
<a name="l04117"></a>04117                  0 == strcmp (name, <span class="stringliteral">"RigidRotationRate"</span>) ||
<a name="l04118"></a>04118                  0 == strcmp (name, <span class="stringliteral">"RigidVelocity"</span>)) {
<a name="l04119"></a>04119             <span class="keywordflow">if</span> (ndim != 1 || dims[0] != PhyDim)
<a name="l04120"></a>04120                 error (<span class="stringliteral">"invalid dimension"</span>);
<a name="l04121"></a>04121             check_quantity (n, name, dataclass, punits, 1, 6);
<a name="l04122"></a>04122         }
<a name="l04123"></a>04123         <span class="keywordflow">else</span> {
<a name="l04124"></a>04124             <span class="keywordflow">for</span> (size = 1, i = 0; i &lt; ndim; i++)
<a name="l04125"></a>04125                 size *= dims[i];
<a name="l04126"></a>04126             <span class="keywordflow">if</span> (ndim &lt; 1 || size &lt; 1)
<a name="l04127"></a>04127                 error (<span class="stringliteral">"bad dimension values"</span>);
<a name="l04128"></a>04128             check_quantity (n, name, dataclass, punits, -1, 6);
<a name="l04129"></a>04129         }
<a name="l04130"></a>04130     }
<a name="l04131"></a>04131 
<a name="l04132"></a>04132     check_user_data (dataclass, punits, 2);
<a name="l04133"></a>04133 }
<a name="l04134"></a>04134 
<a name="l04135"></a>04135 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l04136"></a>04136 
<a name="l04137"></a>04137 <span class="keyword">static</span> <span class="keywordtype">void</span> check_zone_iter (<span class="keywordtype">void</span>)
<a name="l04138"></a>04138 {
<a name="l04139"></a>04139     <span class="keywordtype">char</span> *p, *desc, name[33], buff[33];
<a name="l04140"></a>04140     <span class="keywordtype">int</span> ierr, n, na, nd, nn, ndim, dims[12], size;
<a name="l04141"></a>04141     <span class="keywordtype">int</span> dataclass, *punits, units[9];
<a name="l04142"></a>04142     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l04143"></a>04143     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1];
<a name="l04144"></a>04144 
<a name="l04145"></a>04145     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"ZoneIterativeData_t"</span>, 1, NULL);
<a name="l04146"></a>04146 
<a name="l04147"></a>04147     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l04148"></a>04148         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l04149"></a>04149         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04150"></a>04150             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l04151"></a>04151                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l04152"></a>04152             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l04153"></a>04153                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l04154"></a>04154                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04155"></a>04155             }
<a name="l04156"></a>04156         }
<a name="l04157"></a>04157     }
<a name="l04158"></a>04158 
<a name="l04159"></a>04159     dataclass = read_dataclass ();
<a name="l04160"></a>04160     punits = read_units (units);
<a name="l04161"></a>04161     <span class="keywordflow">if</span> (verbose) {
<a name="l04162"></a>04162         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 4);
<a name="l04163"></a>04163         <span class="keywordflow">if</span> (punits) print_units (punits, 4);
<a name="l04164"></a>04164     }
<a name="l04165"></a>04165     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>;
<a name="l04166"></a>04166     <span class="keywordflow">if</span> (!punits) punits = z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>;
<a name="l04167"></a>04167 
<a name="l04168"></a>04168     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;na)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_narrays"</span>);
<a name="l04169"></a>04169     <span class="keywordflow">for</span> (n = 1; n &lt;= na; n++) {
<a name="l04170"></a>04170         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l04171"></a>04171             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l04172"></a>04172         printf (<span class="stringliteral">"    checking zone iterative data \"%s\"\n"</span>, name);
<a name="l04173"></a>04173         fflush (stdout);
<a name="l04174"></a>04174         <span class="keywordflow">for</span> (size = 1, nd = 0; nd &lt; ndim; nd++)
<a name="l04175"></a>04175             size *= dims[nd];
<a name="l04176"></a>04176         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"ArbitraryGridMotionPointers"</span>) ||
<a name="l04177"></a>04177             0 == strcmp (name, <span class="stringliteral">"FlowSolutionPointers"</span>) ||
<a name="l04178"></a>04178             0 == strcmp (name, <span class="stringliteral">"GridCoordinatesPointers"</span>) ||
<a name="l04179"></a>04179             0 == strcmp (name, <span class="stringliteral">"RigidGridMotionPointers"</span>)) {
<a name="l04180"></a>04180             <span class="keywordflow">if</span> (ndim != 2 || dims[0] != 32 || size &lt; 1 ||
<a name="l04181"></a>04181                (NumSteps &amp;&amp; dims[1] != NumSteps))
<a name="l04182"></a>04182                 error (<span class="stringliteral">"invalid dimension values"</span>);
<a name="l04183"></a>04183             <span class="keywordflow">else</span> {
<a name="l04184"></a>04184                 desc = (<span class="keywordtype">char</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (size);
<a name="l04185"></a>04185                 <span class="keywordflow">if</span> (desc == NULL) {
<a name="l04186"></a>04186                     fprintf (stderr, <span class="stringliteral">"malloc failed for zone iter data\n"</span>);
<a name="l04187"></a>04187                     exit (1);
<a name="l04188"></a>04188                 }
<a name="l04189"></a>04189                 <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#6cbf5b299c13b0de187d599330c6134e">cg_array_read</a> (n, desc)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_read"</span>);
<a name="l04190"></a>04190                 ierr = 0;
<a name="l04191"></a>04191                 <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"ArbitraryGridMotionPointers"</span>)) {
<a name="l04192"></a>04192                     <span class="keywordflow">for</span> (nd = 0; nd &lt; dims[1]; nd++) {
<a name="l04193"></a>04193                         strncpy (buff, &amp;desc[nd&lt;&lt;5], 32);
<a name="l04194"></a>04194                         buff[32] = 0;
<a name="l04195"></a>04195                         p = buff + strlen(buff);
<a name="l04196"></a>04196                         <span class="keywordflow">while</span> (--p &gt;= buff &amp;&amp; isspace(*p))
<a name="l04197"></a>04197                             ;
<a name="l04198"></a>04198                         *++p = 0;
<a name="l04199"></a>04199                         <span class="keywordflow">for</span> (nn = 0; nn &lt; NumArbitraryGrid; nn++) {
<a name="l04200"></a>04200                             <span class="keywordflow">if</span> (0 == strcmp (buff, ArbitraryGrid[nn])) <span class="keywordflow">break</span>;
<a name="l04201"></a>04201                         }
<a name="l04202"></a>04202                         <span class="keywordflow">if</span> (nn == NumArbitraryGrid) ierr++;
<a name="l04203"></a>04203                     }
<a name="l04204"></a>04204                 }
<a name="l04205"></a>04205                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"FlowSolutionPointers"</span>)) {
<a name="l04206"></a>04206                     <span class="keywordflow">for</span> (nd = 0; nd &lt; dims[1]; nd++) {
<a name="l04207"></a>04207                         strncpy (buff, &amp;desc[nd&lt;&lt;5], 32);
<a name="l04208"></a>04208                         buff[32] = 0;
<a name="l04209"></a>04209                         p = buff + strlen(buff);
<a name="l04210"></a>04210                         <span class="keywordflow">while</span> (--p &gt;= buff &amp;&amp; isspace(*p))
<a name="l04211"></a>04211                             ;
<a name="l04212"></a>04212                         *++p = 0;
<a name="l04213"></a>04213                         <span class="keywordflow">for</span> (nn = 0; nn &lt; NumFlowSolution; nn++) {
<a name="l04214"></a>04214                             <span class="keywordflow">if</span> (0 == strcmp (buff, FlowSolution[nn])) <span class="keywordflow">break</span>;
<a name="l04215"></a>04215                         }
<a name="l04216"></a>04216                         <span class="keywordflow">if</span> (nn == NumFlowSolution) ierr++;
<a name="l04217"></a>04217                     }
<a name="l04218"></a>04218                 }
<a name="l04219"></a>04219                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"GridCoordinatesPointers"</span>)) {
<a name="l04220"></a>04220                     <span class="keywordflow">for</span> (nd = 0; nd &lt; dims[1]; nd++) {
<a name="l04221"></a>04221                         strncpy (buff, &amp;desc[nd&lt;&lt;5], 32);
<a name="l04222"></a>04222                         buff[32] = 0;
<a name="l04223"></a>04223                         p = buff + strlen(buff);
<a name="l04224"></a>04224                         <span class="keywordflow">while</span> (--p &gt;= buff &amp;&amp; isspace(*p))
<a name="l04225"></a>04225                             ;
<a name="l04226"></a>04226                         *++p = 0;
<a name="l04227"></a>04227                         <span class="keywordflow">for</span> (nn = 0; nn &lt; NumGridCoordinate; nn++) {
<a name="l04228"></a>04228                             <span class="keywordflow">if</span> (0 == strcmp (buff, GridCoordinate[nn])) <span class="keywordflow">break</span>;
<a name="l04229"></a>04229                         }
<a name="l04230"></a>04230                         <span class="keywordflow">if</span> (nn == NumGridCoordinate) ierr++;
<a name="l04231"></a>04231                     }
<a name="l04232"></a>04232                 }
<a name="l04233"></a>04233                 <span class="keywordflow">else</span> {
<a name="l04234"></a>04234                     <span class="keywordflow">for</span> (nd = 0; nd &lt; dims[1]; nd++) {
<a name="l04235"></a>04235                         strncpy (buff, &amp;desc[nd&lt;&lt;5], 32);
<a name="l04236"></a>04236                         buff[32] = 0;
<a name="l04237"></a>04237                         p = buff + strlen(buff);
<a name="l04238"></a>04238                         <span class="keywordflow">while</span> (--p &gt;= buff &amp;&amp; isspace(*p))
<a name="l04239"></a>04239                             ;
<a name="l04240"></a>04240                         *++p = 0;
<a name="l04241"></a>04241                         <span class="keywordflow">for</span> (nn = 0; nn &lt; NumRigidGrid; nn++) {
<a name="l04242"></a>04242                             <span class="keywordflow">if</span> (0 == strcmp (buff, RigidGrid[nn])) <span class="keywordflow">break</span>;
<a name="l04243"></a>04243                         }
<a name="l04244"></a>04244                         <span class="keywordflow">if</span> (nn == NumRigidGrid) ierr++;
<a name="l04245"></a>04245                     }
<a name="l04246"></a>04246                 }
<a name="l04247"></a>04247                 <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (desc);
<a name="l04248"></a>04248                 <span class="keywordflow">if</span> (ierr)
<a name="l04249"></a>04249                     error (<span class="stringliteral">"%d %s are invalid"</span>, ierr, name);
<a name="l04250"></a>04250             }
<a name="l04251"></a>04251         }
<a name="l04252"></a>04252         <span class="keywordflow">else</span> {
<a name="l04253"></a>04253             <span class="keywordflow">if</span> (ndim &lt; 1 || size &lt; 1)
<a name="l04254"></a>04254                 error (<span class="stringliteral">"invalid dimension values"</span>);
<a name="l04255"></a>04255             check_quantity (n, name, dataclass, punits, 0, 6);
<a name="l04256"></a>04256         }
<a name="l04257"></a>04257     }
<a name="l04258"></a>04258 
<a name="l04259"></a>04259     check_user_data (dataclass, punits, 4);
<a name="l04260"></a>04260 }
<a name="l04261"></a>04261 
<a name="l04262"></a>04262 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l04263"></a>04263 
<a name="l04264"></a>04264 <span class="keyword">static</span> <span class="keywordtype">void</span> check_discrete (<span class="keywordtype">int</span> ndis)
<a name="l04265"></a>04265 {
<a name="l04266"></a>04266     <span class="keywordtype">char</span> name[33];
<a name="l04267"></a>04267     <span class="keywordtype">int</span> n, nd, id, ierr, rind[6];
<a name="l04268"></a>04268     <span class="keywordtype">int</span> datasize, size, ndim, dims[12];
<a name="l04269"></a>04269     <span class="keywordtype">int</span> *punits, units[9], dataclass;
<a name="l04270"></a>04270     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l04271"></a>04271     <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> location;
<a name="l04272"></a>04272     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1];
<a name="l04273"></a>04273 
<a name="l04274"></a>04274     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#8051996f13674066bd8308777192a775">cg_discrete_read</a> (cgnsfn, cgnsbase, cgnszone, ndis, name))
<a name="l04275"></a>04275         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_discrete_read"</span>);
<a name="l04276"></a>04276     printf (<span class="stringliteral">"  checking discrete data \"%s\"\n"</span>, name);
<a name="l04277"></a>04277     fflush (stdout);
<a name="l04278"></a>04278 
<a name="l04279"></a>04279     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"DiscreteData_t"</span>, ndis, NULL);
<a name="l04280"></a>04280 
<a name="l04281"></a>04281     <span class="comment">/* grid location */</span>
<a name="l04282"></a>04282 
<a name="l04283"></a>04283     ierr = read_gridlocation (&amp;location);
<a name="l04284"></a>04284     <span class="keywordflow">if</span> (ierr) {
<a name="l04285"></a>04285         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_gridlocation_read"</span>);
<a name="l04286"></a>04286         location = <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a>;
<a name="l04287"></a>04287     }
<a name="l04288"></a>04288     <span class="keywordflow">else</span> {
<a name="l04289"></a>04289         <span class="keywordflow">if</span> (verbose)
<a name="l04290"></a>04290             printf (<span class="stringliteral">"    Grid Location=%s\n"</span>, <a class="code" href="cgnslib_8c.html#7af88bef6535742b3a0bb04f976ff747">cg_GridLocationName</a>(location));
<a name="l04291"></a>04291     }
<a name="l04292"></a>04292 
<a name="l04293"></a>04293     <span class="comment">/* rind */</span>
<a name="l04294"></a>04294 
<a name="l04295"></a>04295     ierr = read_rind (rind);
<a name="l04296"></a>04296     <span class="keywordflow">if</span> (ierr) {
<a name="l04297"></a>04297         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_rind_read"</span>);
<a name="l04298"></a>04298         <span class="keywordflow">for</span> (n = 0; n &lt; 6; n++)
<a name="l04299"></a>04299             rind[n] = 0;
<a name="l04300"></a>04300     }
<a name="l04301"></a>04301     <span class="keywordflow">else</span> {
<a name="l04302"></a>04302         <span class="keywordflow">if</span> (verbose) {
<a name="l04303"></a>04303             printf (<span class="stringliteral">"    Rind=[%d"</span>, rind[0]);
<a name="l04304"></a>04304             <span class="keywordflow">for</span> (n = 1; n &lt; 2 * z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++)
<a name="l04305"></a>04305                 printf (<span class="stringliteral">",%d"</span>, rind[n]);
<a name="l04306"></a>04306             puts (<span class="stringliteral">"]"</span>);
<a name="l04307"></a>04307         }
<a name="l04308"></a>04308         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fedef7de5f4ce5345ffd8e2726df46e388">Unstructured</a> &amp;&amp; FileVersion &lt; 2400)
<a name="l04309"></a>04309             error (<span class="stringliteral">"rind not valid for unstructured zones"</span>);
<a name="l04310"></a>04310     }
<a name="l04311"></a>04311 
<a name="l04312"></a>04312     <span class="comment">/* descriptors */</span>
<a name="l04313"></a>04313 
<a name="l04314"></a>04314     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l04315"></a>04315         <span class="keywordtype">char</span> *desc;
<a name="l04316"></a>04316         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l04317"></a>04317         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04318"></a>04318             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l04319"></a>04319                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l04320"></a>04320             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l04321"></a>04321                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l04322"></a>04322                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04323"></a>04323             }
<a name="l04324"></a>04324         }
<a name="l04325"></a>04325     }
<a name="l04326"></a>04326 
<a name="l04327"></a>04327     <span class="comment">/* dataclass and dimensional units */</span>
<a name="l04328"></a>04328 
<a name="l04329"></a>04329     dataclass = read_dataclass ();
<a name="l04330"></a>04330     punits = read_units (units);
<a name="l04331"></a>04331     <span class="keywordflow">if</span> (verbose) {
<a name="l04332"></a>04332         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 4);
<a name="l04333"></a>04333         <span class="keywordflow">if</span> (punits) print_units (punits, 4);
<a name="l04334"></a>04334     }
<a name="l04335"></a>04335     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>;
<a name="l04336"></a>04336     <span class="keywordflow">if</span> (punits == NULL) punits = z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>;
<a name="l04337"></a>04337 
<a name="l04338"></a>04338     <span class="comment">/* get discrete data */</span>
<a name="l04339"></a>04339 
<a name="l04340"></a>04340     datasize = get_data_size (z, location, rind);
<a name="l04341"></a>04341 
<a name="l04342"></a>04342     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_narrays"</span>);
<a name="l04343"></a>04343     <span class="keywordflow">if</span> (nd == 0)
<a name="l04344"></a>04344         warning (2, <span class="stringliteral">"no discrete data arrays defined"</span>);
<a name="l04345"></a>04345 
<a name="l04346"></a>04346     <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04347"></a>04347         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l04348"></a>04348             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l04349"></a>04349         printf (<span class="stringliteral">"    checking discrete data array \"%s\"\n"</span>, name);
<a name="l04350"></a>04350         fflush (stdout);
<a name="l04351"></a>04351         <span class="keywordflow">for</span> (size = 1, <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ndim; <span class="keywordtype">id</span>++)
<a name="l04352"></a>04352             size *= dims[<span class="keywordtype">id</span>];
<a name="l04353"></a>04353         <span class="keywordflow">if</span> (ndim != z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> || size &lt; 1 ||
<a name="l04354"></a>04354             (datasize &amp;&amp; size != datasize))
<a name="l04355"></a>04355             error (<span class="stringliteral">"bad dimension values"</span>);
<a name="l04356"></a>04356         check_quantity (n, name, dataclass, punits, -1, 6);
<a name="l04357"></a>04357     }
<a name="l04358"></a>04358 
<a name="l04359"></a>04359     check_user_data (dataclass, punits, 4);
<a name="l04360"></a>04360 }
<a name="l04361"></a>04361 
<a name="l04362"></a>04362 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l04363"></a>04363 
<a name="l04364"></a>04364 <span class="keyword">static</span> <span class="keywordtype">void</span> check_solution (<span class="keywordtype">int</span> ns)
<a name="l04365"></a>04365 {
<a name="l04366"></a>04366     <span class="keywordtype">char</span> name[33];
<a name="l04367"></a>04367     <span class="keywordtype">int</span> n, nf, id, ierr, rind[6];
<a name="l04368"></a>04368     <span class="keywordtype">int</span> datasize, size, ndim, dims[12];
<a name="l04369"></a>04369     <span class="keywordtype">int</span> *punits, units[9], dataclass;
<a name="l04370"></a>04370     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l04371"></a>04371     <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13">GridLocation_t</a> location;
<a name="l04372"></a>04372     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1];
<a name="l04373"></a>04373 
<a name="l04374"></a>04374     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#9ddf9ce05418ff49578f0b57eadee606">cg_sol_info</a> (cgnsfn, cgnsbase, cgnszone, ns, name, &amp;location))
<a name="l04375"></a>04375         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_sol_info"</span>);
<a name="l04376"></a>04376     strcpy (FlowSolution[ns-1], name);
<a name="l04377"></a>04377     printf (<span class="stringliteral">"  checking solution \"%s\"\n"</span>, name);
<a name="l04378"></a>04378     <span class="keywordflow">if</span> (verbose)
<a name="l04379"></a>04379         printf (<span class="stringliteral">"    Grid Location=%s\n"</span>, <a class="code" href="cgnslib_8c.html#7af88bef6535742b3a0bb04f976ff747">cg_GridLocationName</a> (location));
<a name="l04380"></a>04380     fflush (stdout);
<a name="l04381"></a>04381 
<a name="l04382"></a>04382     <span class="keywordflow">if</span> (location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13d013c4439c3e09308d6b2eef2a4025ae">Vertex</a> &amp;&amp; location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13af82b5a2366c89873ca45b75f6e6ac36">CellCenter</a>) {
<a name="l04383"></a>04383         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fedef7de5f4ce5345ffd8e2726df46e388">Unstructured</a>)
<a name="l04384"></a>04384             error (<span class="stringliteral">"grid location nust be Vertex or CellCenter for"</span>
<a name="l04385"></a>04385                 <span class="stringliteral">" unstructured zones"</span>);
<a name="l04386"></a>04386         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e13b4cea34ab6a3c3533f2422f66bf8dc3d">IFaceCenter</a> &amp;&amp;
<a name="l04387"></a>04387             location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e133f9cfc26e3953b1a7f7b8826e119a5d5">JFaceCenter</a> &amp;&amp; location != <a class="code" href="cgns_keywords_8h.html#5a0e596ed46b12f73c2ed1b8b0176e1387cfa4bdd4bc3bd768c3f0bab84f2143">KFaceCenter</a>)
<a name="l04388"></a>04388             error (<span class="stringliteral">"grid location not Vertex,CellCenter or [IJK]FaceCenter"</span>);
<a name="l04389"></a>04389     }
<a name="l04390"></a>04390 
<a name="l04391"></a>04391     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, <span class="stringliteral">"FlowSolution_t"</span>, ns, NULL);
<a name="l04392"></a>04392 
<a name="l04393"></a>04393     <span class="comment">/* rind */</span>
<a name="l04394"></a>04394 
<a name="l04395"></a>04395     ierr = read_rind (rind);
<a name="l04396"></a>04396     <span class="keywordflow">if</span> (ierr) {
<a name="l04397"></a>04397         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_rind_read"</span>);
<a name="l04398"></a>04398         <span class="keywordflow">for</span> (n = 0; n &lt; 6; n++)
<a name="l04399"></a>04399             rind[n] = 0;
<a name="l04400"></a>04400     }
<a name="l04401"></a>04401     <span class="keywordflow">else</span> {
<a name="l04402"></a>04402         <span class="keywordflow">if</span> (verbose) {
<a name="l04403"></a>04403             printf (<span class="stringliteral">"    Rind=[%d"</span>, rind[0]);
<a name="l04404"></a>04404             <span class="keywordflow">for</span> (n = 1; n &lt; 2 * z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++)
<a name="l04405"></a>04405                 printf (<span class="stringliteral">",%d"</span>, rind[n]);
<a name="l04406"></a>04406             puts (<span class="stringliteral">"]"</span>);
<a name="l04407"></a>04407         }
<a name="l04408"></a>04408         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fedef7de5f4ce5345ffd8e2726df46e388">Unstructured</a> &amp;&amp; FileVersion &lt; 2400)
<a name="l04409"></a>04409             error (<span class="stringliteral">"rind not valid for unstructured zones"</span>);
<a name="l04410"></a>04410     }
<a name="l04411"></a>04411 
<a name="l04412"></a>04412     <span class="comment">/* descriptors */</span>
<a name="l04413"></a>04413 
<a name="l04414"></a>04414     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l04415"></a>04415         <span class="keywordtype">char</span> *desc;
<a name="l04416"></a>04416         <span class="keywordtype">int</span> nd;
<a name="l04417"></a>04417         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l04418"></a>04418         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04419"></a>04419             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l04420"></a>04420                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l04421"></a>04421             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l04422"></a>04422                 printf (<span class="stringliteral">"    Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l04423"></a>04423                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04424"></a>04424             }
<a name="l04425"></a>04425         }
<a name="l04426"></a>04426     }
<a name="l04427"></a>04427 
<a name="l04428"></a>04428     <span class="comment">/* dataclass and dimensional units */</span>
<a name="l04429"></a>04429 
<a name="l04430"></a>04430     dataclass = read_dataclass ();
<a name="l04431"></a>04431     punits = read_units (units);
<a name="l04432"></a>04432     <span class="keywordflow">if</span> (verbose) {
<a name="l04433"></a>04433         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 4);
<a name="l04434"></a>04434         <span class="keywordflow">if</span> (punits) print_units (punits, 4);
<a name="l04435"></a>04435     }
<a name="l04436"></a>04436     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>;
<a name="l04437"></a>04437     <span class="keywordflow">if</span> (punits == NULL) punits = z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>;
<a name="l04438"></a>04438 
<a name="l04439"></a>04439     <span class="comment">/* get solution data size */</span>
<a name="l04440"></a>04440 
<a name="l04441"></a>04441     datasize = get_data_size (z, location, rind);
<a name="l04442"></a>04442 
<a name="l04443"></a>04443     <span class="comment">/* read solution data as arrays to get size */</span>
<a name="l04444"></a>04444 
<a name="l04445"></a>04445     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#5ee98672b9d0510e4c8b5e81221aa8d7">cg_nfields</a> (cgnsfn, cgnsbase, cgnszone, ns, &amp;nf))
<a name="l04446"></a>04446         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_nfields"</span>);
<a name="l04447"></a>04447     <span class="keywordflow">if</span> (nf == 0)
<a name="l04448"></a>04448         warning (2, <span class="stringliteral">"no solution data arrays defined"</span>);
<a name="l04449"></a>04449 
<a name="l04450"></a>04450     <span class="keywordflow">for</span> (n = 1; n &lt;= nf; n++) {
<a name="l04451"></a>04451         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l04452"></a>04452             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l04453"></a>04453         printf (<span class="stringliteral">"    checking solution field \"%s\"\n"</span>, name);
<a name="l04454"></a>04454         fflush (stdout);
<a name="l04455"></a>04455         <span class="keywordflow">for</span> (size = 1, <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; ndim; <span class="keywordtype">id</span>++)
<a name="l04456"></a>04456             size *= dims[<span class="keywordtype">id</span>];
<a name="l04457"></a>04457         <span class="keywordflow">if</span> (ndim != z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> || size &lt; 1 ||
<a name="l04458"></a>04458             (datasize &amp;&amp; size != datasize))
<a name="l04459"></a>04459             error (<span class="stringliteral">"bad dimension values"</span>);
<a name="l04460"></a>04460         check_quantity (n, name, dataclass, punits, 1, 6);
<a name="l04461"></a>04461     }
<a name="l04462"></a>04462 
<a name="l04463"></a>04463     <span class="comment">/* user data */</span>
<a name="l04464"></a>04464 
<a name="l04465"></a>04465     check_user_data (dataclass, punits, 4);
<a name="l04466"></a>04466 }
<a name="l04467"></a>04467 
<a name="l04468"></a>04468 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l04469"></a>04469 
<a name="l04470"></a>04470 <span class="keyword">static</span> <span class="keywordtype">void</span> check_zone (<span class="keywordtype">void</span>)
<a name="l04471"></a>04471 {
<a name="l04472"></a>04472     <span class="keywordtype">char</span> name[33], *desc;
<a name="l04473"></a>04473     <span class="keywordtype">int</span> n, nd, niter, ierr, eqset[7];
<a name="l04474"></a>04474     <span class="keywordtype">float</span> point[3], vector[3];
<a name="l04475"></a>04475     <a class="code" href="struct_z_o_n_e.html">ZONE</a> *z = &amp;Zones[cgnszone-1];
<a name="l04476"></a>04476     <span class="keyword">static</span> <span class="keywordtype">char</span> indexname[] = <span class="stringliteral">"IJK"</span>;
<a name="l04477"></a>04477 
<a name="l04478"></a>04478     printf (<span class="stringliteral">"checking zone \"%s\"\n"</span>, z-&gt;<a class="code" href="struct_z_o_n_e.html#7913ace0d483311647b8d88f795c6bfd">name</a>);
<a name="l04479"></a>04479     fflush (stdout);
<a name="l04480"></a>04480 
<a name="l04481"></a>04481     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fe8a382d9e08294b2cd243ee60bd75c068">Structured</a>) {
<a name="l04482"></a>04482         <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="write__rind_8c.html#b50080207e517f6d65f1444a0c68ca00">CellDim</a>; n++) {
<a name="l04483"></a>04483             <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][n] &lt; 2) {
<a name="l04484"></a>04484                 error (<span class="stringliteral">"number of points in %c-direction &lt; 2"</span>, indexname[n]);
<a name="l04485"></a>04485                 z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> = 0;
<a name="l04486"></a>04486             }
<a name="l04487"></a>04487             <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][n] != z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][n] - 1) {
<a name="l04488"></a>04488                 error (<span class="stringliteral">"number of cells in %c-direction is %d instead of %d"</span>,
<a name="l04489"></a>04489                     indexname[n], z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][n], z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][n] - 1);
<a name="l04490"></a>04490                 z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][n] = z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][n] - 1;
<a name="l04491"></a>04491             }
<a name="l04492"></a>04492             <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[2][n] != 0)
<a name="l04493"></a>04493                 warning (1, <span class="stringliteral">"VertexSizeBoundary in %c-direction should be 0"</span>
<a name="l04494"></a>04494                     <span class="stringliteral">" for structured grid"</span>, indexname[n]);
<a name="l04495"></a>04495         }
<a name="l04496"></a>04496     }
<a name="l04497"></a>04497     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a> == <a class="code" href="cgns_keywords_8h.html#68acb02e36b91d3020f4de86436a07fedef7de5f4ce5345ffd8e2726df46e388">Unstructured</a>) {
<a name="l04498"></a>04498         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][0] &lt; CellDim + 1) {
<a name="l04499"></a>04499             error (<span class="stringliteral">"number of vertices &lt; CellDim + 1"</span>);
<a name="l04500"></a>04500             z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> = 0;
<a name="l04501"></a>04501         }
<a name="l04502"></a>04502         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][0] &lt; 1) {
<a name="l04503"></a>04503             warning (1, <span class="stringliteral">"number of cells &lt; 1"</span>);
<a name="l04504"></a>04504             z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> = 0;
<a name="l04505"></a>04505         }
<a name="l04506"></a>04506         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[2][0] &gt; z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][0])
<a name="l04507"></a>04507             error (<span class="stringliteral">"VertexBoundarySize &gt; total number of vertices"</span>);
<a name="l04508"></a>04508     }
<a name="l04509"></a>04509     <span class="keywordflow">else</span>
<a name="l04510"></a>04510         error (<span class="stringliteral">"zone type is not Structured or Unstructured"</span>);
<a name="l04511"></a>04511     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a> == 0) <span class="keywordflow">return</span>;
<a name="l04512"></a>04512 
<a name="l04513"></a>04513     <span class="comment">/*----- descriptors -----*/</span>
<a name="l04514"></a>04514 
<a name="l04515"></a>04515     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, NULL);
<a name="l04516"></a>04516     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l04517"></a>04517         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l04518"></a>04518         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04519"></a>04519             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l04520"></a>04520                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l04521"></a>04521             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l04522"></a>04522                 printf (<span class="stringliteral">"  Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l04523"></a>04523                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04524"></a>04524             }
<a name="l04525"></a>04525         }
<a name="l04526"></a>04526     }
<a name="l04527"></a>04527 
<a name="l04528"></a>04528     <span class="comment">/*----- DataClass and DimensionalUnits -----*/</span>
<a name="l04529"></a>04529 
<a name="l04530"></a>04530     z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a> = read_dataclass ();
<a name="l04531"></a>04531     z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a> = read_units (z-&gt;<a class="code" href="struct_z_o_n_e.html#82de7fb1611503a894e054b1f3505cf5">units</a>);
<a name="l04532"></a>04532     <span class="keywordflow">if</span> (verbose) {
<a name="l04533"></a>04533         printf (<span class="stringliteral">"  Zone Type=%s\n"</span>, <a class="code" href="cgnslib_8c.html#1025d15ec67c56b1937a230614494e93">cg_ZoneTypeName</a>(z-&gt;<a class="code" href="struct_z_o_n_e.html#70e3228eb924895531acd9144d41916f">type</a>));
<a name="l04534"></a>04534         printf (<span class="stringliteral">"  Vertex Size=[%d"</span>, z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][0]);
<a name="l04535"></a>04535         <span class="keywordflow">for</span> (n = 1; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++)
<a name="l04536"></a>04536             printf (<span class="stringliteral">",%d"</span>, z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[0][n]);
<a name="l04537"></a>04537         puts (<span class="stringliteral">"]"</span>);
<a name="l04538"></a>04538         printf (<span class="stringliteral">"  Cell Size=[%d"</span>, z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][0]);
<a name="l04539"></a>04539         <span class="keywordflow">for</span> (n = 1; n &lt; z-&gt;<a class="code" href="struct_z_o_n_e.html#ad0e38deab88ae62604c5112c3c24890">idim</a>; n++)
<a name="l04540"></a>04540             printf (<span class="stringliteral">",%d"</span>, z-&gt;<a class="code" href="struct_z_o_n_e.html#f81d8944e2802f4667b15a6240ae7fa3">dims</a>[1][n]);
<a name="l04541"></a>04541         puts (<span class="stringliteral">"]"</span>);
<a name="l04542"></a>04542         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a> &gt;= 0) print_dataclass (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, 2);
<a name="l04543"></a>04543         <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>) print_units (z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 2);
<a name="l04544"></a>04544     }
<a name="l04545"></a>04545     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a> &lt; 0) z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a> = BaseClass;
<a name="l04546"></a>04546     <span class="keywordflow">if</span> (!z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>) z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a> = pBaseUnits;
<a name="l04547"></a>04547 
<a name="l04548"></a>04548     <span class="comment">/*----- FamilyName -----*/</span>
<a name="l04549"></a>04549 
<a name="l04550"></a>04550     ierr = <a class="code" href="cgnslib_8c.html#7bc0fed09c8e3e4152fcbd1ceb2e053d">cg_famname_read</a> (name);
<a name="l04551"></a>04551     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_famname_read"</span>);
<a name="l04552"></a>04552     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l04553"></a>04553         <span class="keywordflow">if</span> (verbose) printf (<span class="stringliteral">"  Family=%s\n"</span>, name);
<a name="l04554"></a>04554         <span class="keywordflow">for</span> (n = 0; n &lt; NumFamily; n++) {
<a name="l04555"></a>04555             <span class="keywordflow">if</span> (0 == strcmp (name, Family[n])) <span class="keywordflow">break</span>;
<a name="l04556"></a>04556         }
<a name="l04557"></a>04557         <span class="keywordflow">if</span> (n &gt;= NumFamily &amp;&amp;
<a name="l04558"></a>04558             (FileVersion &gt;= 1200 || strcmp(name, <span class="stringliteral">"ORPHAN"</span>)))
<a name="l04559"></a>04559             warning (1, <span class="stringliteral">"zone family name \"%s\" not found"</span>, name);
<a name="l04560"></a>04560     }
<a name="l04561"></a>04561 
<a name="l04562"></a>04562     <span class="comment">/*----- ReferenceState -----*/</span>
<a name="l04563"></a>04563 
<a name="l04564"></a>04564     ierr = <a class="code" href="cgnslib_8c.html#39d1496f65890d79f7e63be3832347f0">cg_state_read</a> (&amp;desc);
<a name="l04565"></a>04565     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_state_read"</span>);
<a name="l04566"></a>04566     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l04567"></a>04567         puts (<span class="stringliteral">"  checking reference state"</span>);
<a name="l04568"></a>04568         <span class="keywordflow">if</span> (desc != NULL) {
<a name="l04569"></a>04569             <span class="keywordflow">if</span> (verbose &gt; 1)
<a name="l04570"></a>04570                 printf (<span class="stringliteral">"    Descriptor:%s\n"</span>, desc);
<a name="l04571"></a>04571             <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04572"></a>04572         }
<a name="l04573"></a>04573         fflush (stdout);
<a name="l04574"></a>04574         go_relative (<span class="stringliteral">"ReferenceState_t"</span>, 1, NULL);
<a name="l04575"></a>04575         check_arrays (BaseClass, pBaseUnits, 1, 0, 4);
<a name="l04576"></a>04576     }
<a name="l04577"></a>04577 
<a name="l04578"></a>04578     <span class="comment">/*----- FlowEquationSet -----*/</span>
<a name="l04579"></a>04579 
<a name="l04580"></a>04580     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, NULL);
<a name="l04581"></a>04581     ierr = <a class="code" href="cgnslib_8c.html#fa9061626676f054e79226200bace707">cg_equationset_read</a> (&amp;eqset[0], &amp;eqset[1], &amp;eqset[2],
<a name="l04582"></a>04582         &amp;eqset[3], &amp;eqset[4], &amp;eqset[5], &amp;eqset[6]);
<a name="l04583"></a>04583     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l04584"></a>04584         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_equationset_read"</span>);
<a name="l04585"></a>04585     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l04586"></a>04586         puts (<span class="stringliteral">"  checking equation set"</span>);
<a name="l04587"></a>04587         fflush (stdout);
<a name="l04588"></a>04588         check_equation_set (eqset, z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 4);
<a name="l04589"></a>04589     }
<a name="l04590"></a>04590 
<a name="l04591"></a>04591     <span class="comment">/*----- Coordinates -----*/</span>
<a name="l04592"></a>04592 
<a name="l04593"></a>04593     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#f2a8c7418f6393b5951fc8a8c3f31182">cg_ngrids</a> (cgnsfn, cgnsbase, cgnszone,
<a name="l04594"></a>04594         &amp;NumGridCoordinate)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ngrids"</span>);
<a name="l04595"></a>04595     <span class="keywordflow">if</span> (!NumGridCoordinate)
<a name="l04596"></a>04596         error (<span class="stringliteral">"no grid coordinates defined"</span>);
<a name="l04597"></a>04597     <span class="keywordflow">else</span> {
<a name="l04598"></a>04598         create_names (NumGridCoordinate, &amp;MaxGridCoordinate, &amp;GridCoordinate);
<a name="l04599"></a>04599         <span class="keywordflow">for</span> (n = 1; n &lt;= NumGridCoordinate; n++)
<a name="l04600"></a>04600             check_coordinates (n);
<a name="l04601"></a>04601     }
<a name="l04602"></a>04602 
<a name="l04603"></a>04603     <span class="comment">/*----- Elements -----*/</span>
<a name="l04604"></a>04604 
<a name="l04605"></a>04605     <span class="keywordflow">if</span> (z-&gt;<a class="code" href="struct_z_o_n_e.html#dbfb774fafdb2da3e35a7de16db65c3c">nsets</a>) check_elements ();
<a name="l04606"></a>04606 
<a name="l04607"></a>04607     <span class="comment">/*----- ZoneBC -----*/</span>
<a name="l04608"></a>04608 
<a name="l04609"></a>04609     check_zoneBC ();
<a name="l04610"></a>04610 
<a name="l04611"></a>04611     <span class="comment">/*----- ZoneGridConnectivity -----*/</span>
<a name="l04612"></a>04612 
<a name="l04613"></a>04613     check_connectivity ();
<a name="l04614"></a>04614 
<a name="l04615"></a>04615     <span class="comment">/*----- RotatingCoordinates -----*/</span>
<a name="l04616"></a>04616 
<a name="l04617"></a>04617     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, NULL);
<a name="l04618"></a>04618     ierr = <a class="code" href="cgnslib_8c.html#572dc897f1f6809a3e6f8720254982d8">cg_rotating_read</a> (vector, point);
<a name="l04619"></a>04619     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_rotating_read"</span>);
<a name="l04620"></a>04620     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l04621"></a>04621         puts (<span class="stringliteral">"  checking rotating coordinates"</span>);
<a name="l04622"></a>04622         fflush (stdout);
<a name="l04623"></a>04623         check_rotating (point, vector, z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 4);
<a name="l04624"></a>04624     }
<a name="l04625"></a>04625 
<a name="l04626"></a>04626     <span class="comment">/*----- ArbitraryGridMotion -----*/</span>
<a name="l04627"></a>04627 
<a name="l04628"></a>04628     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#246157e41e5ad37cd083bc0f9a7476ce">cg_n_arbitrary_motions</a> (cgnsfn, cgnsbase, cgnszone,
<a name="l04629"></a>04629         &amp;NumArbitraryGrid)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_n_arbitrary_motions"</span>);
<a name="l04630"></a>04630     create_names (NumArbitraryGrid, &amp;MaxArbitraryGrid, &amp;ArbitraryGrid);
<a name="l04631"></a>04631     <span class="keywordflow">for</span> (n = 1; n &lt;= NumArbitraryGrid; n++)
<a name="l04632"></a>04632         check_arbitrary_motion (n);
<a name="l04633"></a>04633 
<a name="l04634"></a>04634     <span class="comment">/*----- RigidGridMotion -----*/</span>
<a name="l04635"></a>04635 
<a name="l04636"></a>04636     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#8e71298fc994055ae2310c8c4b3c1c68">cg_n_rigid_motions</a> (cgnsfn, cgnsbase, cgnszone,
<a name="l04637"></a>04637         &amp;NumRigidGrid)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_n_rigid_motions"</span>);
<a name="l04638"></a>04638     create_names (NumRigidGrid, &amp;MaxRigidGrid, &amp;RigidGrid);
<a name="l04639"></a>04639     <span class="keywordflow">for</span> (n = 1; n &lt;= NumRigidGrid; n++)
<a name="l04640"></a>04640         check_rigid_motion (n);
<a name="l04641"></a>04641 
<a name="l04642"></a>04642     <span class="comment">/*----- FlowSolution -----*/</span>
<a name="l04643"></a>04643 
<a name="l04644"></a>04644     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#513d544d69ce08ab7c0fcac9fcf34436">cg_nsols</a> (cgnsfn, cgnsbase, cgnszone,
<a name="l04645"></a>04645         &amp;NumFlowSolution)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_nsols"</span>);
<a name="l04646"></a>04646     create_names (NumFlowSolution, &amp;MaxFlowSolution, &amp;FlowSolution);
<a name="l04647"></a>04647     <span class="keywordflow">for</span> (n = 1; n &lt;= NumFlowSolution; n++)
<a name="l04648"></a>04648         check_solution (n);
<a name="l04649"></a>04649 
<a name="l04650"></a>04650     <span class="comment">/*----- ConvergenceHistory -----*/</span>
<a name="l04651"></a>04651 
<a name="l04652"></a>04652     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, NULL);
<a name="l04653"></a>04653     ierr = <a class="code" href="cgnslib_8c.html#801ab7e380545d837c9b3abf62114fd8">cg_convergence_read</a> (&amp;niter, &amp;desc);
<a name="l04654"></a>04654     <span class="keywordflow">if</span> (ierr) {
<a name="l04655"></a>04655         <span class="keywordflow">if</span> (ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_convergence_read"</span>);
<a name="l04656"></a>04656         niter = 0;
<a name="l04657"></a>04657     }
<a name="l04658"></a>04658     <span class="keywordflow">else</span> {
<a name="l04659"></a>04659         puts (<span class="stringliteral">"  checking zone convergence history"</span>);
<a name="l04660"></a>04660         fflush (stdout);
<a name="l04661"></a>04661         go_relative (<span class="stringliteral">"ConvergenceHistory_t"</span>, 1, NULL);
<a name="l04662"></a>04662         check_convergence (niter, desc, z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 4);
<a name="l04663"></a>04663         <span class="keywordflow">if</span> (desc != NULL) <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04664"></a>04664     }
<a name="l04665"></a>04665 
<a name="l04666"></a>04666     <span class="comment">/*----- ZoneIterativeData -----*/</span>
<a name="l04667"></a>04667 
<a name="l04668"></a>04668     ierr = <a class="code" href="cgnslib_8c.html#951943bffe66e4219c1b7045e4816a9c">cg_ziter_read</a> (cgnsfn, cgnsbase, cgnszone, name);
<a name="l04669"></a>04669     <span class="comment">/* prior to 2.3 returned ERROR instead of NODE_NOT_FOUND */</span>
<a name="l04670"></a>04670     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a> &amp;&amp; LibraryVersion &gt;= 2300)
<a name="l04671"></a>04671         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ziter_read"</span>);
<a name="l04672"></a>04672     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l04673"></a>04673         printf (<span class="stringliteral">"  checking zone iterative data \"%s\"\n"</span>, name);
<a name="l04674"></a>04674         fflush (stdout);
<a name="l04675"></a>04675         <span class="keywordflow">if</span> (BaseIter)
<a name="l04676"></a>04676             error (<span class="stringliteral">"ZoneIterativeData requires BaseIterativeData"</span>);
<a name="l04677"></a>04677         check_zone_iter ();
<a name="l04678"></a>04678     }
<a name="l04679"></a>04679 
<a name="l04680"></a>04680     <span class="comment">/*----- IntegralData -----*/</span>
<a name="l04681"></a>04681 
<a name="l04682"></a>04682     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, NULL);
<a name="l04683"></a>04683     check_integral (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 2);
<a name="l04684"></a>04684 
<a name="l04685"></a>04685     <span class="comment">/*----- UserDefinedData -----*/</span>
<a name="l04686"></a>04686 
<a name="l04687"></a>04687     go_absolute (<span class="stringliteral">"Zone_t"</span>, cgnszone, NULL);
<a name="l04688"></a>04688     check_user_data (z-&gt;<a class="code" href="struct_z_o_n_e.html#3ae006cb5c29891744976f52cdbd1a0b">dataclass</a>, z-&gt;<a class="code" href="struct_z_o_n_e.html#ff9801584ffe70b13cbbecc5caddd6ea">punits</a>, 2);
<a name="l04689"></a>04689 
<a name="l04690"></a>04690     <span class="comment">/*----- DiscreteData -----*/</span>
<a name="l04691"></a>04691 
<a name="l04692"></a>04692     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#672472989e2c26b2293c6d91f8e978ce">cg_ndiscrete</a> (cgnsfn, cgnsbase, cgnszone, &amp;nd))
<a name="l04693"></a>04693         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndiscrete"</span>);
<a name="l04694"></a>04694     <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++)
<a name="l04695"></a>04695         check_discrete (n);
<a name="l04696"></a>04696 }
<a name="l04697"></a>04697 
<a name="l04698"></a>04698 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l04699"></a>04699 
<a name="l04700"></a>04700 <span class="keyword">static</span> <span class="keywordtype">void</span> check_axisymmetry (<span class="keywordtype">float</span> *point, <span class="keywordtype">float</span> *vector)
<a name="l04701"></a>04701 {
<a name="l04702"></a>04702     <span class="keywordtype">char</span> name[33];
<a name="l04703"></a>04703     <span class="keywordtype">int</span> n, na, ndim, dims[12];
<a name="l04704"></a>04704     <span class="keywordtype">int</span> dataclass, *punits, units[9];
<a name="l04705"></a>04705     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l04706"></a>04706 
<a name="l04707"></a>04707     <span class="keywordflow">if</span> (verbose) {
<a name="l04708"></a>04708         printf (<span class="stringliteral">"  Reference Point=[%g,%g]\n"</span>, point[0], point[1]);
<a name="l04709"></a>04709         printf (<span class="stringliteral">"  Axis Vector=[%g,%g]\n"</span>, vector[0], vector[1]);
<a name="l04710"></a>04710     }
<a name="l04711"></a>04711 
<a name="l04712"></a>04712     go_absolute (<span class="stringliteral">"Axisymmetry_t"</span>, 1, NULL);
<a name="l04713"></a>04713 
<a name="l04714"></a>04714     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l04715"></a>04715         <span class="keywordtype">int</span> nd;
<a name="l04716"></a>04716         <span class="keywordtype">char</span> *desc;
<a name="l04717"></a>04717         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l04718"></a>04718         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04719"></a>04719             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l04720"></a>04720                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l04721"></a>04721             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l04722"></a>04722                 printf (<span class="stringliteral">"  Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l04723"></a>04723                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04724"></a>04724             }
<a name="l04725"></a>04725         }
<a name="l04726"></a>04726     }
<a name="l04727"></a>04727 
<a name="l04728"></a>04728     dataclass = read_dataclass ();
<a name="l04729"></a>04729     punits = read_units (units);
<a name="l04730"></a>04730     <span class="keywordflow">if</span> (verbose) {
<a name="l04731"></a>04731         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 2);
<a name="l04732"></a>04732         <span class="keywordflow">if</span> (punits) print_units (punits, 2);
<a name="l04733"></a>04733     }
<a name="l04734"></a>04734     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = BaseClass;
<a name="l04735"></a>04735     <span class="keywordflow">if</span> (!punits) punits = pBaseUnits;
<a name="l04736"></a>04736 
<a name="l04737"></a>04737     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;na)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_narrays"</span>);
<a name="l04738"></a>04738     <span class="keywordflow">for</span> (n = 1; n &lt;= na; n++) {
<a name="l04739"></a>04739         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l04740"></a>04740             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l04741"></a>04741         printf (<span class="stringliteral">"  checking axisymmetry data \"%s\"\n"</span>, name);
<a name="l04742"></a>04742         fflush (stdout);
<a name="l04743"></a>04743         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"AxisymmetryAxisVector"</span>) ||
<a name="l04744"></a>04744             0 == strcmp (name, <span class="stringliteral">"AxisymmetryReferencePoint"</span>)) {
<a name="l04745"></a>04745             <span class="keywordflow">if</span> (ndim != 1 || dims[0] != 2)
<a name="l04746"></a>04746                 error (<span class="stringliteral">"bad dimension values"</span>);
<a name="l04747"></a>04747             <span class="keywordflow">if</span> (datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1ca5e5244f4627fd3bf71c72015c2060">RealSingle</a>)
<a name="l04748"></a>04748                 error (<span class="stringliteral">"data type not real"</span>);
<a name="l04749"></a>04749             check_quantity (n, name, dataclass, punits, 1, 4);
<a name="l04750"></a>04750         }
<a name="l04751"></a>04751         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"AxisymmetryAngle"</span>)) {
<a name="l04752"></a>04752             <span class="keywordflow">if</span> (ndim != 1 || dims[0] != 1)
<a name="l04753"></a>04753                 error (<span class="stringliteral">"bad dimension values"</span>);
<a name="l04754"></a>04754             <span class="keywordflow">if</span> (datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1ca5e5244f4627fd3bf71c72015c2060">RealSingle</a>)
<a name="l04755"></a>04755                 error (<span class="stringliteral">"data type not real"</span>);
<a name="l04756"></a>04756             check_quantity (n, name, dataclass, punits, 1, 4);
<a name="l04757"></a>04757         }
<a name="l04758"></a>04758         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"CoordinateNames"</span>)) {
<a name="l04759"></a>04759             <span class="keywordflow">if</span> (ndim != 2 || dims[0] != 32 || dims[1] != 2)
<a name="l04760"></a>04760                 error (<span class="stringliteral">"bad dimension values"</span>);
<a name="l04761"></a>04761             <span class="keywordflow">if</span> (datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae0b8efba6b691115f12604f2afe5cdcb5">Character</a>)
<a name="l04762"></a>04762                 error (<span class="stringliteral">"data type not character"</span>);
<a name="l04763"></a>04763         }
<a name="l04764"></a>04764         <span class="keywordflow">else</span>
<a name="l04765"></a>04765             warning (1, <span class="stringliteral">"not valid as child of Axisymmetry"</span>);
<a name="l04766"></a>04766     }
<a name="l04767"></a>04767 
<a name="l04768"></a>04768     check_user_data (dataclass, punits, 2);
<a name="l04769"></a>04769 }
<a name="l04770"></a>04770 
<a name="l04771"></a>04771 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l04772"></a>04772 
<a name="l04773"></a>04773 <span class="keyword">static</span> <span class="keywordtype">void</span> check_gravity (<span class="keywordtype">float</span> *vector)
<a name="l04774"></a>04774 {
<a name="l04775"></a>04775     <span class="keywordtype">char</span> *desc, name[33];
<a name="l04776"></a>04776     <span class="keywordtype">int</span> n, na, nd, ndim, dims[12];
<a name="l04777"></a>04777     <span class="keywordtype">int</span> dataclass, *punits, units[9];
<a name="l04778"></a>04778     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l04779"></a>04779 
<a name="l04780"></a>04780     <span class="keywordflow">if</span> (verbose) {
<a name="l04781"></a>04781         printf (<span class="stringliteral">"  Vector=[%g]"</span>, vector[0]);
<a name="l04782"></a>04782         <span class="keywordflow">for</span> (nd = 1; nd &lt; PhyDim; nd++)
<a name="l04783"></a>04783             printf (<span class="stringliteral">",%g"</span>, vector[nd]);
<a name="l04784"></a>04784         puts (<span class="stringliteral">"]"</span>);
<a name="l04785"></a>04785     }
<a name="l04786"></a>04786 
<a name="l04787"></a>04787     go_absolute (<span class="stringliteral">"Gravity_t"</span>, 1, NULL);
<a name="l04788"></a>04788 
<a name="l04789"></a>04789     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l04790"></a>04790         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l04791"></a>04791         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04792"></a>04792             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l04793"></a>04793                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l04794"></a>04794             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l04795"></a>04795                 printf (<span class="stringliteral">"  Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l04796"></a>04796                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04797"></a>04797             }
<a name="l04798"></a>04798         }
<a name="l04799"></a>04799     }
<a name="l04800"></a>04800 
<a name="l04801"></a>04801     dataclass = read_dataclass ();
<a name="l04802"></a>04802     punits = read_units (units);
<a name="l04803"></a>04803     <span class="keywordflow">if</span> (verbose) {
<a name="l04804"></a>04804         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 2);
<a name="l04805"></a>04805         <span class="keywordflow">if</span> (punits) print_units (punits, 2);
<a name="l04806"></a>04806     }
<a name="l04807"></a>04807     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = BaseClass;
<a name="l04808"></a>04808     <span class="keywordflow">if</span> (!punits) punits = pBaseUnits;
<a name="l04809"></a>04809 
<a name="l04810"></a>04810     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;na)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_narrays"</span>);
<a name="l04811"></a>04811     <span class="keywordflow">for</span> (n = 1; n &lt;= na; n++) {
<a name="l04812"></a>04812         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l04813"></a>04813             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l04814"></a>04814         printf (<span class="stringliteral">"  checking gravity data \"%s\"\n"</span>, name);
<a name="l04815"></a>04815         fflush (stdout);
<a name="l04816"></a>04816         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"GravityVector"</span>)) {
<a name="l04817"></a>04817             <span class="keywordflow">if</span> (ndim != 1 || dims[0] != PhyDim)
<a name="l04818"></a>04818                 error (<span class="stringliteral">"invalid dimension values"</span>);
<a name="l04819"></a>04819             <span class="keywordflow">if</span> (datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1ca5e5244f4627fd3bf71c72015c2060">RealSingle</a>)
<a name="l04820"></a>04820                 error (<span class="stringliteral">"data type is not RealSingle"</span>);
<a name="l04821"></a>04821             check_quantity (n, name, dataclass, punits, 1, 4);
<a name="l04822"></a>04822         }
<a name="l04823"></a>04823         <span class="keywordflow">else</span>
<a name="l04824"></a>04824             warning (1, <span class="stringliteral">"not valid as child of Gravity"</span>);
<a name="l04825"></a>04825     }
<a name="l04826"></a>04826 
<a name="l04827"></a>04827     check_user_data (dataclass, punits, 2);
<a name="l04828"></a>04828 }
<a name="l04829"></a>04829 
<a name="l04830"></a>04830 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l04831"></a>04831 
<a name="l04832"></a>04832 <span class="keyword">static</span> <span class="keywordtype">void</span> check_family (<span class="keywordtype">int</span> fam)
<a name="l04833"></a>04833 {
<a name="l04834"></a>04834     <span class="keywordtype">char</span> famname[33], name[33], cad[33], *<a class="code" href="_a_d_f__internals_8h.html#1bc14b345d09a9f773dfde50d7f2d830">filename</a>;
<a name="l04835"></a>04835     <span class="keywordtype">int</span> ierr, i, n, nbc, ngeo, nparts;
<a name="l04836"></a>04836     <a class="code" href="cgns_keywords_8h.html#44b677e45de9f4d98475b69a56eec4e1">BCType_t</a> bctype;
<a name="l04837"></a>04837 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l04838"></a>04838 <span class="preprocessor"></span>    <span class="keywordtype">int</span> nds, dirichlet, neumann;
<a name="l04839"></a>04839     <span class="keywordtype">float</span> point[3], vector[3];
<a name="l04840"></a>04840 <span class="preprocessor">#endif</span>
<a name="l04841"></a>04841 <span class="preprocessor"></span>
<a name="l04842"></a>04842     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#a9faa3668e4a4a73e7226f7d93563b22">cg_family_read</a> (cgnsfn, cgnsbase, fam, famname, &amp;nbc, &amp;ngeo))
<a name="l04843"></a>04843         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_family_read"</span>);
<a name="l04844"></a>04844     printf (<span class="stringliteral">"checking family \"%s\"\n"</span>, famname);
<a name="l04845"></a>04845 
<a name="l04846"></a>04846     go_absolute (<span class="stringliteral">"Family_t"</span>, fam, NULL);
<a name="l04847"></a>04847     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l04848"></a>04848         <span class="keywordtype">int</span> nd;
<a name="l04849"></a>04849         <span class="keywordtype">char</span> *desc;
<a name="l04850"></a>04850         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l04851"></a>04851         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04852"></a>04852             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l04853"></a>04853                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l04854"></a>04854             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l04855"></a>04855                 printf (<span class="stringliteral">"  Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l04856"></a>04856                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04857"></a>04857             }
<a name="l04858"></a>04858         }
<a name="l04859"></a>04859     }
<a name="l04860"></a>04860 
<a name="l04861"></a>04861     <span class="keywordflow">if</span> (verbose)
<a name="l04862"></a>04862         printf (<span class="stringliteral">"  Number BC=%d\n"</span>, nbc);
<a name="l04863"></a>04863     <span class="keywordflow">if</span> (nbc &lt; 0 || nbc &gt; 1)
<a name="l04864"></a>04864         error (<span class="stringliteral">"number of BCs not 0 or 1 for %s"</span>, famname);
<a name="l04865"></a>04865     <span class="keywordflow">for</span> (n = 1; n &lt;= nbc; n++) {
<a name="l04866"></a>04866         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#1b24674d2179f032f4a3c1c7430da2fc">cg_fambc_read</a> (cgnsfn, cgnsbase, fam, n, name, &amp;bctype))
<a name="l04867"></a>04867             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_fambc_read"</span>);
<a name="l04868"></a>04868         <span class="keywordflow">if</span> (verbose) {
<a name="l04869"></a>04869             printf (<span class="stringliteral">"    BC Name=\"%s\"\n"</span>, name);
<a name="l04870"></a>04870             printf (<span class="stringliteral">"    BC Type=%s\n"</span>, <a class="code" href="cgnslib_8c.html#7b85152cdba9c91e213d433ca99240f6">cg_BCTypeName</a>(bctype));
<a name="l04871"></a>04871         }
<a name="l04872"></a>04872 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l04873"></a>04873 <span class="preprocessor"></span>        go_relative (<span class="stringliteral">"FamilyBC_t"</span>, n, NULL);
<a name="l04874"></a>04874         ierr = <a class="code" href="cgnslib_8c.html#3aedffe64d3a57dbe9fd408261123322">cg_bcdataset_info</a> (&amp;nds);
<a name="l04875"></a>04875         <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l04876"></a>04876             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_bcdataset_info"</span>);
<a name="l04877"></a>04877         <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a> &amp;&amp; nds &gt; 0) {
<a name="l04878"></a>04878             <span class="keywordflow">for</span> (i = 1; i &lt;= nds; i++) {
<a name="l04879"></a>04879                 <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#15119844d83979c9b97ccb51d55bd057">cg_bcdataset_read</a> (i, name, &amp;bctype, &amp;dirichlet, &amp;neumann))
<a name="l04880"></a>04880                     <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_bcdataset_read"</span>);
<a name="l04881"></a>04881                 printf (<span class="stringliteral">"  checking BC data set \"%s\"\n"</span>, name);
<a name="l04882"></a>04882                 fflush (stdout);
<a name="l04883"></a>04883                 go_relative (<span class="stringliteral">"BCDataSet_t"</span>, i, NULL);
<a name="l04884"></a>04884                 check_BCdata (bctype, dirichlet, neumann, 1,
<a name="l04885"></a>04885                     BaseClass, pBaseUnits, 4);
<a name="l04886"></a>04886                 go_relative (<span class="stringliteral">".."</span>, i, NULL);
<a name="l04887"></a>04887             }
<a name="l04888"></a>04888         }
<a name="l04889"></a>04889         go_relative (<span class="stringliteral">".."</span>, 1, NULL);
<a name="l04890"></a>04890 <span class="preprocessor">#endif</span>
<a name="l04891"></a>04891 <span class="preprocessor"></span>    }
<a name="l04892"></a>04892 
<a name="l04893"></a>04893     <span class="keywordflow">if</span> (verbose) printf (<span class="stringliteral">"  Number Geo=%d\n"</span>, ngeo);
<a name="l04894"></a>04894     <span class="keywordflow">for</span> (n = 1; n &lt;= ngeo; n++) {
<a name="l04895"></a>04895         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#1fd4d75606054b629455ca361297d177">cg_geo_read</a> (cgnsfn, cgnsbase, fam, n, name, &amp;filename,
<a name="l04896"></a>04896                 cad, &amp;nparts)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_geo_read"</span>);
<a name="l04897"></a>04897         <span class="keywordflow">if</span> (verbose) {
<a name="l04898"></a>04898             printf (<span class="stringliteral">"    Geo Name=\"%s\"\n"</span>, name);
<a name="l04899"></a>04899             printf (<span class="stringliteral">"    Geo File=\"%s\"\n"</span>,
<a name="l04900"></a>04900                 filename == NULL ? <span class="stringliteral">"&lt;unknown&gt;"</span> : filename);
<a name="l04901"></a>04901             printf (<span class="stringliteral">"    CAD=\"%s\"\n"</span>, cad);
<a name="l04902"></a>04902             printf (<span class="stringliteral">"    Nparts=%d\n"</span>, nparts);
<a name="l04903"></a>04903         }
<a name="l04904"></a>04904         <span class="keywordflow">if</span> (filename != NULL) <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (filename);
<a name="l04905"></a>04905         <span class="keywordflow">for</span> (i = 1; i &lt;= nparts; i++) {
<a name="l04906"></a>04906             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#395d7c8ec498b9efa940f3e2e74342ff">cg_part_read</a> (cgnsfn, cgnsbase, fam, n, i, name))
<a name="l04907"></a>04907                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_part_read"</span>);
<a name="l04908"></a>04908             <span class="keywordflow">if</span> (verbose &gt; 2)
<a name="l04909"></a>04909                 printf (<span class="stringliteral">"      Part %d Name=\"%s\"\n"</span>, i, name);
<a name="l04910"></a>04910         }
<a name="l04911"></a>04911     }
<a name="l04912"></a>04912 
<a name="l04913"></a>04913     ierr = read_ordinal (&amp;i);
<a name="l04914"></a>04914     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ordinal_read"</span>);
<a name="l04915"></a>04915 
<a name="l04916"></a>04916 <span class="preprocessor">#if CGNS_VERSION &gt;= 2400</span>
<a name="l04917"></a>04917 <span class="preprocessor"></span>    ierr = <a class="code" href="cgnslib_8c.html#572dc897f1f6809a3e6f8720254982d8">cg_rotating_read</a> (vector, point);
<a name="l04918"></a>04918     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_rotating_read"</span>);
<a name="l04919"></a>04919     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l04920"></a>04920         puts (<span class="stringliteral">"  checking rotating coordinates"</span>);
<a name="l04921"></a>04921         fflush (stdout);
<a name="l04922"></a>04922         check_rotating (point, vector, BaseClass, pBaseUnits, 4);
<a name="l04923"></a>04923     }
<a name="l04924"></a>04924 <span class="preprocessor">#endif</span>
<a name="l04925"></a>04925 <span class="preprocessor"></span>
<a name="l04926"></a>04926     check_user_data (BaseClass, pBaseUnits, 2);
<a name="l04927"></a>04927 }
<a name="l04928"></a>04928 
<a name="l04929"></a>04929 <span class="comment">/*-----------------------------------------------------------------------*/</span>
<a name="l04930"></a>04930 
<a name="l04931"></a>04931 <span class="keyword">static</span> <span class="keywordtype">void</span> check_base_iter (<span class="keywordtype">void</span>)
<a name="l04932"></a>04932 {
<a name="l04933"></a>04933     <span class="keywordtype">char</span> *p, *desc, name[33];
<a name="l04934"></a>04934     <span class="keywordtype">int</span> ierr, n, na, ns, nd, nmax, ndim, dims[12];
<a name="l04935"></a>04935     <span class="keywordtype">int</span> dataclass, *punits, units[9];
<a name="l04936"></a>04936     <span class="keywordtype">int</span> *icnt, nnf = 0, nfp = 0, nnz = 0, nzp = 0;
<a name="l04937"></a>04937     <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae">DataType_t</a> datatype;
<a name="l04938"></a>04938 
<a name="l04939"></a>04939     <span class="keywordflow">if</span> (verbose) printf (<span class="stringliteral">"  Number Steps=%d\n"</span>, NumSteps);
<a name="l04940"></a>04940     <span class="keywordflow">if</span> (NumSteps &lt; 1)
<a name="l04941"></a>04941         warning (2, <span class="stringliteral">"number of time steps is not &gt; 0"</span>);
<a name="l04942"></a>04942 
<a name="l04943"></a>04943     go_absolute (<span class="stringliteral">"BaseIterativeData_t"</span>, 1, NULL);
<a name="l04944"></a>04944     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l04945"></a>04945         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l04946"></a>04946         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l04947"></a>04947             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l04948"></a>04948                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l04949"></a>04949             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l04950"></a>04950                 printf (<span class="stringliteral">"  Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l04951"></a>04951                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l04952"></a>04952             }
<a name="l04953"></a>04953         }
<a name="l04954"></a>04954     }
<a name="l04955"></a>04955 
<a name="l04956"></a>04956     dataclass = read_dataclass ();
<a name="l04957"></a>04957     punits = read_units (units);
<a name="l04958"></a>04958     <span class="keywordflow">if</span> (verbose) {
<a name="l04959"></a>04959         <span class="keywordflow">if</span> (dataclass &gt;= 0) print_dataclass (dataclass, 2);
<a name="l04960"></a>04960         <span class="keywordflow">if</span> (punits) print_units (punits, 2);
<a name="l04961"></a>04961     }
<a name="l04962"></a>04962     <span class="keywordflow">if</span> (dataclass &lt; 0) dataclass = BaseClass;
<a name="l04963"></a>04963     <span class="keywordflow">if</span> (!punits) punits = pBaseUnits;
<a name="l04964"></a>04964 
<a name="l04965"></a>04965     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#83d51b1c2a84e0b52a11ed6757542923">cg_narrays</a> (&amp;na)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_narrays"</span>);
<a name="l04966"></a>04966     ns = 0;
<a name="l04967"></a>04967     <span class="keywordflow">for</span> (n = 1; n &lt;= na; n++) {
<a name="l04968"></a>04968         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (n, name, &amp;datatype, &amp;ndim, dims))
<a name="l04969"></a>04969             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l04970"></a>04970         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"NumberOfFamilies"</span>)) {
<a name="l04971"></a>04971             nnf = n;
<a name="l04972"></a>04972             <span class="keywordflow">continue</span>;
<a name="l04973"></a>04973         }
<a name="l04974"></a>04974         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"FamilyPointers"</span>)) {
<a name="l04975"></a>04975             nfp = n;
<a name="l04976"></a>04976             <span class="keywordflow">continue</span>;
<a name="l04977"></a>04977         }
<a name="l04978"></a>04978         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"NumberOfZones"</span>)) {
<a name="l04979"></a>04979             nnz = n;
<a name="l04980"></a>04980             <span class="keywordflow">continue</span>;
<a name="l04981"></a>04981         }
<a name="l04982"></a>04982         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"ZonePointers"</span>)) {
<a name="l04983"></a>04983             nzp = n;
<a name="l04984"></a>04984             <span class="keywordflow">continue</span>;
<a name="l04985"></a>04985         }
<a name="l04986"></a>04986         printf (<span class="stringliteral">"  checking \"%s\"\n"</span>, name);
<a name="l04987"></a>04987         fflush (stdout);
<a name="l04988"></a>04988         <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"IterationValues"</span>)) {
<a name="l04989"></a>04989             <span class="keywordflow">if</span> (ndim != 1 || dims[0] != NumSteps)
<a name="l04990"></a>04990                 error (<span class="stringliteral">"invalid dimension values"</span>);
<a name="l04991"></a>04991             <span class="keywordflow">if</span> (datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1e2f89e867cd91c3de2ea9fbd2ef96a3">Integer</a>)
<a name="l04992"></a>04992                 error (<span class="stringliteral">"data type not integer"</span>);
<a name="l04993"></a>04993             ns++;
<a name="l04994"></a>04994         }
<a name="l04995"></a>04995         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strcmp (name, <span class="stringliteral">"TimeValues"</span>)) {
<a name="l04996"></a>04996             <span class="keywordflow">if</span> (ndim != 1 || dims[0] != NumSteps)
<a name="l04997"></a>04997                 error (<span class="stringliteral">"invalid dimension values"</span>);
<a name="l04998"></a>04998             <span class="keywordflow">if</span> (datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1ca5e5244f4627fd3bf71c72015c2060">RealSingle</a> &amp;&amp; datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae5f954e649a6da0e65898e0faf7724549">RealDouble</a>)
<a name="l04999"></a>04999                 error (<span class="stringliteral">"data type not real or double"</span>);
<a name="l05000"></a>05000             ns++;
<a name="l05001"></a>05001         }
<a name="l05002"></a>05002         <span class="keywordflow">else</span> {
<a name="l05003"></a>05003             check_quantity (n, name, dataclass, punits, 0, 4);
<a name="l05004"></a>05004         }
<a name="l05005"></a>05005     }
<a name="l05006"></a>05006     <span class="keywordflow">if</span> (!ns)
<a name="l05007"></a>05007         error (<span class="stringliteral">"TimeValues and/or IterationValues is required"</span>);
<a name="l05008"></a>05008 
<a name="l05009"></a>05009     <span class="comment">/* check family pointers */</span>
<a name="l05010"></a>05010 
<a name="l05011"></a>05011     <span class="keywordflow">if</span> (nnf &amp;&amp; !nfp)
<a name="l05012"></a>05012         error (<span class="stringliteral">"NumberOfFamilies given but not FamilyPointers"</span>);
<a name="l05013"></a>05013     <span class="keywordflow">if</span> (!nnf &amp;&amp; nfp)
<a name="l05014"></a>05014         error (<span class="stringliteral">"FamilyPointers given but not NumberOfFamilies"</span>);
<a name="l05015"></a>05015     <span class="keywordflow">if</span> (nnf &amp;&amp; nfp) {
<a name="l05016"></a>05016         ierr = nmax = 0;
<a name="l05017"></a>05017         icnt = NULL;
<a name="l05018"></a>05018         puts (<span class="stringliteral">"  checking \"NumberOfFamilies\""</span>);
<a name="l05019"></a>05019         fflush (stdout);
<a name="l05020"></a>05020         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (nnf, name, &amp;datatype, &amp;ndim, dims))
<a name="l05021"></a>05021             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l05022"></a>05022         <span class="keywordflow">if</span> (ndim != 1 || dims[0] != NumSteps) {
<a name="l05023"></a>05023             error (<span class="stringliteral">"invalid dimension values"</span>);
<a name="l05024"></a>05024             ierr = 1;
<a name="l05025"></a>05025         }
<a name="l05026"></a>05026         <span class="keywordflow">if</span> (datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1e2f89e867cd91c3de2ea9fbd2ef96a3">Integer</a>) {
<a name="l05027"></a>05027             error (<span class="stringliteral">"data type not integer"</span>);
<a name="l05028"></a>05028             ierr = 1;
<a name="l05029"></a>05029         }
<a name="l05030"></a>05030         <span class="keywordflow">if</span> (!ierr &amp;&amp; NumSteps &gt; 0) {
<a name="l05031"></a>05031             icnt = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (NumSteps * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l05032"></a>05032             <span class="keywordflow">if</span> (icnt == NULL) {
<a name="l05033"></a>05033                 fprintf (stderr, <span class="stringliteral">"malloc failed for number of families\n"</span>);
<a name="l05034"></a>05034                 exit (1);
<a name="l05035"></a>05035             }
<a name="l05036"></a>05036             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#6cbf5b299c13b0de187d599330c6134e">cg_array_read</a> (nnf, icnt)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_read"</span>);
<a name="l05037"></a>05037             <span class="keywordflow">for</span> (ns = 0; ns &lt; NumSteps; ns++) {
<a name="l05038"></a>05038                 <span class="keywordflow">if</span> (icnt[ns] &lt; 0 || icnt[ns] &gt; NumFamily) ierr++;
<a name="l05039"></a>05039                 <span class="keywordflow">if</span> (nmax &lt; icnt[ns]) nmax = icnt[ns];
<a name="l05040"></a>05040             }
<a name="l05041"></a>05041             <span class="keywordflow">if</span> (ierr)
<a name="l05042"></a>05042                 error (<span class="stringliteral">"there are %d invalid entries"</span>, ierr);
<a name="l05043"></a>05043             <span class="keywordflow">if</span> (nmax == 0)
<a name="l05044"></a>05044                 error (<span class="stringliteral">"max number of families is 0"</span>);
<a name="l05045"></a>05045         }
<a name="l05046"></a>05046 
<a name="l05047"></a>05047         puts (<span class="stringliteral">"  checking \"FamilyPointers\""</span>);
<a name="l05048"></a>05048         fflush (stdout);
<a name="l05049"></a>05049         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (nfp, name, &amp;datatype, &amp;ndim, dims))
<a name="l05050"></a>05050             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l05051"></a>05051         <span class="keywordflow">if</span> (ndim != 3 || dims[0] != 32 ||
<a name="l05052"></a>05052             dims[1] != nmax || dims[2] != NumSteps) {
<a name="l05053"></a>05053             error (<span class="stringliteral">"invalid dimension values"</span>);
<a name="l05054"></a>05054             ierr = 1;
<a name="l05055"></a>05055         }
<a name="l05056"></a>05056         <span class="keywordflow">if</span> (datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae0b8efba6b691115f12604f2afe5cdcb5">Character</a>) {
<a name="l05057"></a>05057             error (<span class="stringliteral">"data type not character"</span>);
<a name="l05058"></a>05058             ierr = 1;
<a name="l05059"></a>05059         }
<a name="l05060"></a>05060         <span class="keywordflow">if</span> (NumSteps &gt; 0 &amp;&amp; nmax &gt; 0 &amp;&amp; !ierr) {
<a name="l05061"></a>05061             desc = (<span class="keywordtype">char</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (32 * nmax * NumSteps * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l05062"></a>05062             <span class="keywordflow">if</span> (NULL == desc) {
<a name="l05063"></a>05063                 fprintf (stderr, <span class="stringliteral">"malloc failed for family pointers\n"</span>);
<a name="l05064"></a>05064                 exit (1);
<a name="l05065"></a>05065             }
<a name="l05066"></a>05066             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#6cbf5b299c13b0de187d599330c6134e">cg_array_read</a> (nfp, desc)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_read"</span>);
<a name="l05067"></a>05067             <span class="keywordflow">for</span> (ierr = 0, n = 0, ns = 0; ns &lt; NumSteps; ns++) {
<a name="l05068"></a>05068                 <span class="keywordflow">for</span> (nd = 0; nd &lt; icnt[ns]; nd++) {
<a name="l05069"></a>05069                     strncpy (name, &amp;desc[n + 32 * nd], 32);
<a name="l05070"></a>05070                     name[32] = 0;
<a name="l05071"></a>05071                     p = name + strlen(name);
<a name="l05072"></a>05072                     <span class="keywordflow">while</span> (--p &gt;= name &amp;&amp; isspace(*p))
<a name="l05073"></a>05073                         ;
<a name="l05074"></a>05074                     *++p = 0;
<a name="l05075"></a>05075                     <span class="keywordflow">for</span> (na = 0; na &lt; NumFamily; na++) {
<a name="l05076"></a>05076                         <span class="keywordflow">if</span> (0 == strcmp (name, Family[na])) <span class="keywordflow">break</span>;
<a name="l05077"></a>05077                     }
<a name="l05078"></a>05078                     <span class="keywordflow">if</span> (na &gt;= NumFamily) ierr++;
<a name="l05079"></a>05079                 }
<a name="l05080"></a>05080                 n += 32 * nmax;
<a name="l05081"></a>05081             }
<a name="l05082"></a>05082             <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (desc);
<a name="l05083"></a>05083             <span class="keywordflow">if</span> (ierr)
<a name="l05084"></a>05084                 warning (1, <span class="stringliteral">"%d unknown families"</span>, ierr);
<a name="l05085"></a>05085         }
<a name="l05086"></a>05086         <span class="keywordflow">if</span> (icnt != NULL) <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (icnt);
<a name="l05087"></a>05087     }
<a name="l05088"></a>05088 
<a name="l05089"></a>05089     <span class="comment">/* check zone pointers */</span>
<a name="l05090"></a>05090 
<a name="l05091"></a>05091     <span class="keywordflow">if</span> (nnz &amp;&amp; !nzp)
<a name="l05092"></a>05092         error (<span class="stringliteral">"NumberOfZones given but not ZonePointers"</span>);
<a name="l05093"></a>05093     <span class="keywordflow">if</span> (!nnz &amp;&amp; nzp)
<a name="l05094"></a>05094         error (<span class="stringliteral">"ZonePointers given but not NumberOfZones"</span>);
<a name="l05095"></a>05095     <span class="keywordflow">if</span> (nnz &amp;&amp; nzp) {
<a name="l05096"></a>05096         ierr = nmax = 0;
<a name="l05097"></a>05097         icnt = NULL;
<a name="l05098"></a>05098         puts (<span class="stringliteral">"  checking \"NumberOfZones\""</span>);
<a name="l05099"></a>05099         fflush (stdout);
<a name="l05100"></a>05100         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (nnz, name, &amp;datatype, &amp;ndim, dims))
<a name="l05101"></a>05101             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l05102"></a>05102         <span class="keywordflow">if</span> (ndim != 1 || dims[0] != NumSteps) {
<a name="l05103"></a>05103             error (<span class="stringliteral">"invalid dimension values"</span>);
<a name="l05104"></a>05104             ierr = 1;
<a name="l05105"></a>05105         }
<a name="l05106"></a>05106         <span class="keywordflow">if</span> (datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae1e2f89e867cd91c3de2ea9fbd2ef96a3">Integer</a>) {
<a name="l05107"></a>05107             error (<span class="stringliteral">"data type not integer"</span>);
<a name="l05108"></a>05108             ierr = 1;
<a name="l05109"></a>05109         }
<a name="l05110"></a>05110         <span class="keywordflow">if</span> (!ierr &amp;&amp; NumSteps &gt; 0) {
<a name="l05111"></a>05111             icnt = (<span class="keywordtype">int</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (NumSteps * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l05112"></a>05112             <span class="keywordflow">if</span> (icnt == NULL) {
<a name="l05113"></a>05113                 fprintf (stderr, <span class="stringliteral">"malloc failed for number of zones\n"</span>);
<a name="l05114"></a>05114                 exit (1);
<a name="l05115"></a>05115             }
<a name="l05116"></a>05116             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#6cbf5b299c13b0de187d599330c6134e">cg_array_read</a> (nnz, icnt)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_read"</span>);
<a name="l05117"></a>05117             <span class="keywordflow">for</span> (ns = 0; ns &lt; NumSteps; ns++) {
<a name="l05118"></a>05118                 <span class="keywordflow">if</span> (icnt[ns] &lt; 0 || icnt[ns] &gt; NumZones) ierr++;
<a name="l05119"></a>05119                 <span class="keywordflow">if</span> (nmax &lt; icnt[ns]) nmax = icnt[ns];
<a name="l05120"></a>05120             }
<a name="l05121"></a>05121             <span class="keywordflow">if</span> (ierr)
<a name="l05122"></a>05122                 error (<span class="stringliteral">"there are %d invalid entries"</span>, ierr);
<a name="l05123"></a>05123             <span class="keywordflow">if</span> (nmax == 0)
<a name="l05124"></a>05124                 error (<span class="stringliteral">"max number of zones is 0"</span>);
<a name="l05125"></a>05125         }
<a name="l05126"></a>05126 
<a name="l05127"></a>05127         printf (<span class="stringliteral">"  checking \"ZonePointers\"\n"</span>);
<a name="l05128"></a>05128         fflush (stdout);
<a name="l05129"></a>05129         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#68cfcdb5df1ea692152256bed7b8606c">cg_array_info</a> (nzp, name, &amp;datatype, &amp;ndim, dims))
<a name="l05130"></a>05130             <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_info"</span>);
<a name="l05131"></a>05131         <span class="keywordflow">if</span> (ndim != 3 || dims[0] != 32 ||
<a name="l05132"></a>05132             dims[1] != nmax || dims[2] != NumSteps) {
<a name="l05133"></a>05133             error (<span class="stringliteral">"invalid dimension values"</span>);
<a name="l05134"></a>05134             ierr = 1;
<a name="l05135"></a>05135         }
<a name="l05136"></a>05136         <span class="keywordflow">if</span> (datatype != <a class="code" href="cgns_keywords_8h.html#405dc77179a4a9e1c6ad0a6d252bebae0b8efba6b691115f12604f2afe5cdcb5">Character</a>) {
<a name="l05137"></a>05137             error (<span class="stringliteral">"data type not character"</span>);
<a name="l05138"></a>05138             ierr = 1;
<a name="l05139"></a>05139         }
<a name="l05140"></a>05140         <span class="keywordflow">if</span> (NumSteps &gt; 0 &amp;&amp; nmax &gt; 0 &amp;&amp; !ierr) {
<a name="l05141"></a>05141             desc = (<span class="keywordtype">char</span> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (32 * nmax * NumSteps * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));
<a name="l05142"></a>05142             <span class="keywordflow">if</span> (NULL == desc) {
<a name="l05143"></a>05143                 fprintf (stderr, <span class="stringliteral">"malloc failed for zone pointers\n"</span>);
<a name="l05144"></a>05144                 exit (1);
<a name="l05145"></a>05145             }
<a name="l05146"></a>05146             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#6cbf5b299c13b0de187d599330c6134e">cg_array_read</a> (nzp, desc)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_array_read"</span>);
<a name="l05147"></a>05147             <span class="keywordflow">for</span> (ierr = 0, n = 0, ns = 0; ns &lt; NumSteps; ns++) {
<a name="l05148"></a>05148                 <span class="keywordflow">for</span> (nd = 0; nd &lt; icnt[ns]; nd++) {
<a name="l05149"></a>05149                     strncpy (name, &amp;desc[n + 32 * nd], 32);
<a name="l05150"></a>05150                     name[32] = 0;
<a name="l05151"></a>05151                     p = name + strlen(name);
<a name="l05152"></a>05152                     <span class="keywordflow">while</span> (--p &gt;= name &amp;&amp; isspace(*p))
<a name="l05153"></a>05153                         ;
<a name="l05154"></a>05154                     *++p = 0;
<a name="l05155"></a>05155                     <span class="keywordflow">for</span> (na = 0; na &lt; NumZones; na++) {
<a name="l05156"></a>05156                         <span class="keywordflow">if</span> (0 == strcmp (name, Zones[na].name)) <span class="keywordflow">break</span>;
<a name="l05157"></a>05157                     }
<a name="l05158"></a>05158                     <span class="keywordflow">if</span> (na &gt;= NumZones) ierr++;
<a name="l05159"></a>05159                 }
<a name="l05160"></a>05160                 n += 32 * nmax;
<a name="l05161"></a>05161             }
<a name="l05162"></a>05162             <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (desc);
<a name="l05163"></a>05163             <span class="keywordflow">if</span> (ierr)
<a name="l05164"></a>05164                 warning (1, <span class="stringliteral">"%d unknown zones"</span>, ierr);
<a name="l05165"></a>05165         }
<a name="l05166"></a>05166         <span class="keywordflow">if</span> (icnt != NULL) <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (icnt);
<a name="l05167"></a>05167     }
<a name="l05168"></a>05168 
<a name="l05169"></a>05169     check_user_data (dataclass, punits, 2);
<a name="l05170"></a>05170 }
<a name="l05171"></a>05171 
<a name="l05172"></a>05172 <span class="comment">/*=======================================================================*/</span>
<a name="l05173"></a>05173 
<a name="l05174"></a>05174 <span class="keyword">static</span> <span class="keywordtype">void</span> check_base (<span class="keywordtype">void</span>)
<a name="l05175"></a>05175 {
<a name="l05176"></a>05176     <span class="keywordtype">char</span> basename[33], name[33], *desc;
<a name="l05177"></a>05177     <span class="keywordtype">int</span> n, nz, ierr, nd, nf, eqset[7];
<a name="l05178"></a>05178     <span class="keywordtype">float</span> point[3], vector[3];
<a name="l05179"></a>05179     <a class="code" href="cgns_keywords_8h.html#9e78c57e09b9a11a016f0c65bc00f185">SimulationType_t</a> simulation;
<a name="l05180"></a>05180 
<a name="l05181"></a>05181     <span class="comment">/*----- base dimensions -----*/</span>
<a name="l05182"></a>05182 
<a name="l05183"></a>05183     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#cb7189dc6bb6c007a47ce0fe7a28fec3">cg_base_read</a> (cgnsfn, cgnsbase, basename, &amp;CellDim, &amp;PhyDim))
<a name="l05184"></a>05184         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_base_read"</span>);
<a name="l05185"></a>05185     printf (<span class="stringliteral">"\nreading base \"%s\"\n"</span>, basename);
<a name="l05186"></a>05186     fflush (stdout);
<a name="l05187"></a>05187     <span class="keywordflow">if</span> (CellDim &lt; 1) {
<a name="l05188"></a>05188         error (<span class="stringliteral">"Cell Dimension &lt; 1"</span>);
<a name="l05189"></a>05189         <span class="keywordflow">return</span>;
<a name="l05190"></a>05190     }
<a name="l05191"></a>05191     <span class="keywordflow">if</span> (PhyDim &lt; CellDim) {
<a name="l05192"></a>05192         error (<span class="stringliteral">"Physical Dimension &lt; Cell Dimension"</span>);
<a name="l05193"></a>05193         <span class="keywordflow">return</span>;
<a name="l05194"></a>05194     }
<a name="l05195"></a>05195 
<a name="l05196"></a>05196     <span class="keywordflow">if</span> (CellDim &lt; 2 || CellDim &gt; 3 || PhyDim &lt; 2 || PhyDim &gt; 3) {
<a name="l05197"></a>05197         puts (<span class="stringliteral">"INTERNAL:can't handle CellDim and/or Phydim &lt; 2 or &gt; 3"</span>);
<a name="l05198"></a>05198         <span class="keywordflow">return</span>;
<a name="l05199"></a>05199     }
<a name="l05200"></a>05200 
<a name="l05201"></a>05201     <span class="comment">/*----- read zones -----*/</span>
<a name="l05202"></a>05202 
<a name="l05203"></a>05203     <span class="keywordflow">for</span> (nz = 0; nz &lt; NumZones; nz++) {
<a name="l05204"></a>05204         <span class="keywordflow">if</span> (Zones[nz].nsets) {
<a name="l05205"></a>05205             <span class="keywordflow">for</span> (n = 0; n &lt; Zones[nz].<a class="code" href="struct_z_o_n_e.html#dbfb774fafdb2da3e35a7de16db65c3c">nsets</a>; n++) {
<a name="l05206"></a>05206                 <span class="keywordflow">if</span> (Zones[nz].sets[n].<a class="code" href="test__partial_8c.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a> != NULL)
<a name="l05207"></a>05207                     <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (Zones[nz].sets[n].<a class="code" href="test__partial_8c.html#7f858599c75d4d48b0a564d2dbc9f693">elements</a>);
<a name="l05208"></a>05208                 <span class="keywordflow">if</span> (Zones[nz].sets[n].<a class="code" href="test__partial_8c.html#8e99857563320b5d943128e5816b1d70">parent</a> != NULL)
<a name="l05209"></a>05209                     <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (Zones[nz].sets[n].<a class="code" href="test__partial_8c.html#8e99857563320b5d943128e5816b1d70">parent</a>);
<a name="l05210"></a>05210             }
<a name="l05211"></a>05211             <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (Zones[nz].sets);
<a name="l05212"></a>05212         }
<a name="l05213"></a>05213         <span class="keywordflow">if</span> (Zones[nz].<a class="code" href="test__partial_8c.html#952633aac593ee8d692314906f5bdb42">faces</a>)
<a name="l05214"></a>05214             <a class="code" href="hash_8c.html#9f2e60b882aa7f10ff3c658be0425bd6">HashDestroy</a> (Zones[nz].faces, <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a>);
<a name="l05215"></a>05215         <span class="keywordflow">if</span> (Zones[nz].nextnodes)
<a name="l05216"></a>05216             <a class="code" href="cg__malloc_8h.html#a7943e5d135734f6801bebcc37401fc0">free</a> (Zones[nz].extnodes);
<a name="l05217"></a>05217     }
<a name="l05218"></a>05218 
<a name="l05219"></a>05219     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#07dcc0b8b0f82b92663ab05823d379c8">cg_nzones</a> (cgnsfn, cgnsbase, &amp;NumZones)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_nzones"</span>);
<a name="l05220"></a>05220     <span class="keywordflow">if</span> (NumZones &gt; MaxZones) {
<a name="l05221"></a>05221         <span class="keywordflow">if</span> (MaxZones)
<a name="l05222"></a>05222             Zones = (<a class="code" href="struct_z_o_n_e.html">ZONE</a> *) <a class="code" href="cg__malloc_8h.html#54df243d89c451240697d7d3afb5663f">realloc</a> (Zones, NumZones * <span class="keyword">sizeof</span>(<a class="code" href="struct_z_o_n_e.html">ZONE</a>));
<a name="l05223"></a>05223         <span class="keywordflow">else</span>
<a name="l05224"></a>05224             Zones = (<a class="code" href="struct_z_o_n_e.html">ZONE</a> *) <a class="code" href="cg__malloc_8h.html#535b58ab5aa48e2e86073e334d43fd32">malloc</a> (NumZones * <span class="keyword">sizeof</span>(<a class="code" href="struct_z_o_n_e.html">ZONE</a>));
<a name="l05225"></a>05225         <span class="keywordflow">if</span> (NULL == Zones) {
<a name="l05226"></a>05226             fprintf (stderr, <span class="stringliteral">"malloc failed for zones\n"</span>);
<a name="l05227"></a>05227             exit (1);
<a name="l05228"></a>05228         }
<a name="l05229"></a>05229         MaxZones = NumZones;
<a name="l05230"></a>05230     }
<a name="l05231"></a>05231 
<a name="l05232"></a>05232     <span class="keywordflow">for</span> (nz = 0; nz &lt; NumZones; nz++)
<a name="l05233"></a>05233         read_zone (nz);
<a name="l05234"></a>05234     cgnszone = 0;
<a name="l05235"></a>05235 
<a name="l05236"></a>05236     <span class="comment">/*----- read families -----*/</span>
<a name="l05237"></a>05237 
<a name="l05238"></a>05238     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#15ebfa562832f11f2a199e891884248a">cg_nfamilies</a> (cgnsfn, cgnsbase, &amp;NumFamily))
<a name="l05239"></a>05239         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_nfamilies"</span>);
<a name="l05240"></a>05240     <span class="keywordflow">if</span> (NumFamily) {
<a name="l05241"></a>05241         puts (<span class="stringliteral">"reading families"</span>);
<a name="l05242"></a>05242         fflush (stdout);
<a name="l05243"></a>05243         create_names (NumFamily, &amp;MaxFamily, &amp;Family);
<a name="l05244"></a>05244         <span class="keywordflow">for</span> (nf = 0; nf &lt; NumFamily; nf++) {
<a name="l05245"></a>05245             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#a9faa3668e4a4a73e7226f7d93563b22">cg_family_read</a> (cgnsfn, cgnsbase, nf + 1, name, &amp;n, &amp;nd))
<a name="l05246"></a>05246                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_family_read"</span>);
<a name="l05247"></a>05247             strcpy (Family[nf], name);
<a name="l05248"></a>05248         }
<a name="l05249"></a>05249     }
<a name="l05250"></a>05250 
<a name="l05251"></a>05251     <span class="comment">/*----- check base -----*/</span>
<a name="l05252"></a>05252 
<a name="l05253"></a>05253     printf (<span class="stringliteral">"\nchecking base \"%s\"\n"</span>, basename);
<a name="l05254"></a>05254     <span class="keywordflow">if</span> (verbose)
<a name="l05255"></a>05255         printf (<span class="stringliteral">"  Cell Dimension=%d\n  Physical Dimension=%d\n"</span>,
<a name="l05256"></a>05256             CellDim, PhyDim);
<a name="l05257"></a>05257     fflush (stdout);
<a name="l05258"></a>05258 
<a name="l05259"></a>05259     go_absolute (NULL);
<a name="l05260"></a>05260 
<a name="l05261"></a>05261     <span class="comment">/*----- base descriptors -----*/</span>
<a name="l05262"></a>05262 
<a name="l05263"></a>05263     <span class="keywordflow">if</span> (verbose &gt; 1) {
<a name="l05264"></a>05264         <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2776b88507745e15c0eacd81740283c9">cg_ndescriptors</a> (&amp;nd)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_ndescriptors"</span>);
<a name="l05265"></a>05265         <span class="keywordflow">for</span> (n = 1; n &lt;= nd; n++) {
<a name="l05266"></a>05266             <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#3354446ad83190fae758e8af628f1177">cg_descriptor_read</a> (n, name, &amp;desc))
<a name="l05267"></a>05267                 <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_descriptor_read"</span>);
<a name="l05268"></a>05268             <span class="keywordflow">if</span> (desc != NULL) {
<a name="l05269"></a>05269                 printf (<span class="stringliteral">"  Descriptor %s:\n%s\n"</span>, name, desc);
<a name="l05270"></a>05270                 <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l05271"></a>05271             }
<a name="l05272"></a>05272         }
<a name="l05273"></a>05273     }
<a name="l05274"></a>05274 
<a name="l05275"></a>05275     <span class="comment">/*----- SimulationType -----*/</span>
<a name="l05276"></a>05276 
<a name="l05277"></a>05277     ierr = <a class="code" href="cgnslib_8c.html#90d9739cca5ff1137871fcc1c94ae421">cg_simulation_type_read</a> (cgnsfn, cgnsbase, &amp;simulation);
<a name="l05278"></a>05278     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l05279"></a>05279         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_simulation_type_read"</span>);
<a name="l05280"></a>05280     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a> &amp;&amp; verbose)
<a name="l05281"></a>05281         printf (<span class="stringliteral">"  Simulation Type=%s\n"</span>, <a class="code" href="cgnslib_8c.html#ebf5aa7794e316343205301f9a45e953">cg_SimulationTypeName</a>(simulation));
<a name="l05282"></a>05282 
<a name="l05283"></a>05283     <span class="comment">/*----- data class, dimensional units -----*/</span>
<a name="l05284"></a>05284 
<a name="l05285"></a>05285     BaseClass = read_dataclass ();
<a name="l05286"></a>05286     pBaseUnits = read_units (BaseUnits);
<a name="l05287"></a>05287     <span class="keywordflow">if</span> (verbose) {
<a name="l05288"></a>05288         <span class="keywordflow">if</span> (BaseClass &gt;= 0) print_dataclass (BaseClass, 2);
<a name="l05289"></a>05289         <span class="keywordflow">if</span> (pBaseUnits) print_units (pBaseUnits, 2);
<a name="l05290"></a>05290     }
<a name="l05291"></a>05291 
<a name="l05292"></a>05292     <span class="comment">/*----- ReferenceState -----*/</span>
<a name="l05293"></a>05293 
<a name="l05294"></a>05294     ierr = <a class="code" href="cgnslib_8c.html#39d1496f65890d79f7e63be3832347f0">cg_state_read</a> (&amp;desc);
<a name="l05295"></a>05295     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_state_read"</span>);
<a name="l05296"></a>05296     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l05297"></a>05297         puts (<span class="stringliteral">"checking reference state"</span>);
<a name="l05298"></a>05298         <span class="keywordflow">if</span> (desc != NULL) {
<a name="l05299"></a>05299             <span class="keywordflow">if</span> (verbose &gt; 1)
<a name="l05300"></a>05300                 printf (<span class="stringliteral">"  Descriptor:%s\n"</span>, desc);
<a name="l05301"></a>05301             <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l05302"></a>05302         }
<a name="l05303"></a>05303         fflush (stdout);
<a name="l05304"></a>05304         go_absolute (<span class="stringliteral">"ReferenceState_t"</span>, 1, NULL);
<a name="l05305"></a>05305         check_arrays (BaseClass, pBaseUnits, 1, 0, 2);
<a name="l05306"></a>05306     }
<a name="l05307"></a>05307 
<a name="l05308"></a>05308     <span class="comment">/*----- FlowEquationSet -----*/</span>
<a name="l05309"></a>05309 
<a name="l05310"></a>05310     go_absolute (NULL);
<a name="l05311"></a>05311     ierr = <a class="code" href="cgnslib_8c.html#fa9061626676f054e79226200bace707">cg_equationset_read</a> (&amp;eqset[0], &amp;eqset[1], &amp;eqset[2],
<a name="l05312"></a>05312         &amp;eqset[3], &amp;eqset[4], &amp;eqset[5], &amp;eqset[6]);
<a name="l05313"></a>05313     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_equationset_read"</span>);
<a name="l05314"></a>05314     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l05315"></a>05315         puts (<span class="stringliteral">"checking equation set"</span>);
<a name="l05316"></a>05316         fflush (stdout);
<a name="l05317"></a>05317         check_equation_set (eqset, BaseClass, pBaseUnits, 2);
<a name="l05318"></a>05318     }
<a name="l05319"></a>05319 
<a name="l05320"></a>05320     <span class="comment">/*----- Families -----*/</span>
<a name="l05321"></a>05321 
<a name="l05322"></a>05322     <span class="keywordflow">for</span> (nf = 1; nf &lt;= NumFamily; nf++)
<a name="l05323"></a>05323         check_family (nf);
<a name="l05324"></a>05324 
<a name="l05325"></a>05325     <span class="comment">/*----- Axisymmetry -----*/</span>
<a name="l05326"></a>05326 
<a name="l05327"></a>05327     ierr = <a class="code" href="cgnslib_8c.html#526254bf002a0776cb3782312ae8036f">cg_axisym_read</a> (cgnsfn, cgnsbase, point, vector);
<a name="l05328"></a>05328     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_axisym_read"</span>);
<a name="l05329"></a>05329     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l05330"></a>05330         <span class="keywordflow">if</span> (PhyDim != 2)
<a name="l05331"></a>05331             error (<span class="stringliteral">"axisymmetry is only valid for physical dimension of 2"</span>);
<a name="l05332"></a>05332         <span class="keywordflow">else</span> {
<a name="l05333"></a>05333             puts (<span class="stringliteral">"checking axisymmetry"</span>);
<a name="l05334"></a>05334             fflush (stdout);
<a name="l05335"></a>05335             check_axisymmetry (point, vector);
<a name="l05336"></a>05336         }
<a name="l05337"></a>05337     }
<a name="l05338"></a>05338 
<a name="l05339"></a>05339     <span class="comment">/*----- RotatingCoordinates -----*/</span>
<a name="l05340"></a>05340 
<a name="l05341"></a>05341     go_absolute (NULL);
<a name="l05342"></a>05342     ierr = <a class="code" href="cgnslib_8c.html#572dc897f1f6809a3e6f8720254982d8">cg_rotating_read</a> (vector, point);
<a name="l05343"></a>05343     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l05344"></a>05344         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_rotating_read"</span>);
<a name="l05345"></a>05345     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l05346"></a>05346         puts (<span class="stringliteral">"checking rotating coordinates"</span>);
<a name="l05347"></a>05347         fflush (stdout);
<a name="l05348"></a>05348         check_rotating (point, vector, BaseClass, pBaseUnits, 2);
<a name="l05349"></a>05349     }
<a name="l05350"></a>05350 
<a name="l05351"></a>05351     <span class="comment">/*----- Gravity -----*/</span>
<a name="l05352"></a>05352 
<a name="l05353"></a>05353     ierr = <a class="code" href="cgnslib_8c.html#04b2059099f7486b7611218ed79f4cb5">cg_gravity_read</a> (cgnsfn, cgnsbase, vector);
<a name="l05354"></a>05354     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l05355"></a>05355         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_gravity_read"</span>);
<a name="l05356"></a>05356     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l05357"></a>05357         puts (<span class="stringliteral">"checking gravity"</span>);
<a name="l05358"></a>05358         fflush (stdout);
<a name="l05359"></a>05359         check_gravity (vector);
<a name="l05360"></a>05360     }
<a name="l05361"></a>05361 
<a name="l05362"></a>05362     <span class="comment">/*----- BaseIterativeData -----*/</span>
<a name="l05363"></a>05363 
<a name="l05364"></a>05364     BaseIter = <a class="code" href="cgnslib_8c.html#8c8df0a90a9f9c0be3c036b9b6b985a0">cg_biter_read</a> (cgnsfn, cgnsbase, name, &amp;NumSteps);
<a name="l05365"></a>05365     <span class="keywordflow">if</span> (BaseIter &amp;&amp; BaseIter != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l05366"></a>05366         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_biter_read"</span>);
<a name="l05367"></a>05367     <span class="keywordflow">if</span> (BaseIter == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a>) {
<a name="l05368"></a>05368         printf (<span class="stringliteral">"checking base iterative data \"%s\"\n"</span>, name);
<a name="l05369"></a>05369         fflush (stdout);
<a name="l05370"></a>05370         check_base_iter ();
<a name="l05371"></a>05371     }
<a name="l05372"></a>05372     <span class="keywordflow">else</span>
<a name="l05373"></a>05373         NumSteps = 0;
<a name="l05374"></a>05374 
<a name="l05375"></a>05375     <span class="comment">/*----- ConvergenceHistory -----*/</span>
<a name="l05376"></a>05376 
<a name="l05377"></a>05377     go_absolute (NULL);
<a name="l05378"></a>05378     ierr = <a class="code" href="cgnslib_8c.html#801ab7e380545d837c9b3abf62114fd8">cg_convergence_read</a> (&amp;nd, &amp;desc);
<a name="l05379"></a>05379     <span class="keywordflow">if</span> (ierr &amp;&amp; ierr != <a class="code" href="cgns_keywords_8h.html#e3177764863da4b451449a76ab55bebd">CG_NODE_NOT_FOUND</a>)
<a name="l05380"></a>05380         <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_convergence_read"</span>);
<a name="l05381"></a>05381     <span class="keywordflow">if</span> (ierr == <a class="code" href="cgns_keywords_8h.html#19bc5a320676b72d79aab883accaa598">CG_OK</a> &amp;&amp; nd) {
<a name="l05382"></a>05382         puts (<span class="stringliteral">"checking global convergence history"</span>);
<a name="l05383"></a>05383         fflush (stdout);
<a name="l05384"></a>05384         go_absolute (<span class="stringliteral">"ConvergenceHistory_t"</span>, 1, NULL);
<a name="l05385"></a>05385         check_convergence (nd, desc, BaseClass, pBaseUnits, 2);
<a name="l05386"></a>05386         <span class="keywordflow">if</span> (desc != NULL) <a class="code" href="cgnscheck_8c.html#ef3e96336f03537d68b69b28c9332cf4">cg_free</a> (desc);
<a name="l05387"></a>05387     }
<a name="l05388"></a>05388 
<a name="l05389"></a>05389     <span class="comment">/*=----- IntegralData -----*/</span>
<a name="l05390"></a>05390 
<a name="l05391"></a>05391     go_absolute (NULL);
<a name="l05392"></a>05392     check_integral (BaseClass, pBaseUnits, 0);
<a name="l05393"></a>05393 
<a name="l05394"></a>05394     <span class="comment">/*----- UserDefinedData -----*/</span>
<a name="l05395"></a>05395 
<a name="l05396"></a>05396     go_absolute (NULL);
<a name="l05397"></a>05397     check_user_data (BaseClass, pBaseUnits, 0);
<a name="l05398"></a>05398 
<a name="l05399"></a>05399     <span class="comment">/*----- Zones -----*/</span>
<a name="l05400"></a>05400 
<a name="l05401"></a>05401     <span class="keywordflow">if</span> (NumZones == 0) {
<a name="l05402"></a>05402         warning (1, <span class="stringliteral">"no zones defined"</span>);
<a name="l05403"></a>05403         <span class="keywordflow">return</span>;
<a name="l05404"></a>05404     }
<a name="l05405"></a>05405 
<a name="l05406"></a>05406     <span class="keywordflow">for</span> (cgnszone = 1; cgnszone &lt;= NumZones; cgnszone++)
<a name="l05407"></a>05407         check_zone ();
<a name="l05408"></a>05408 }
<a name="l05409"></a>05409 
<a name="l05410"></a>05410 <span class="comment">/*=======================================================================*/</span>
<a name="l05411"></a>05411 
<a name="l05412"></a><a class="code" href="cgnscheck_8c.html#0ddf1224851353fc92bfbff6f499fa97">05412</a> <span class="keywordtype">int</span> <a class="code" href="adf2hdf_8c.html#3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
<a name="l05413"></a>05413 {
<a name="l05414"></a>05414     <span class="keywordtype">char</span> *cgnsfile;
<a name="l05415"></a>05415     <span class="keywordtype">int</span> n, nbases, update = 0;
<a name="l05416"></a>05416     <span class="keywordtype">float</span> file_version;
<a name="l05417"></a>05417 
<a name="l05418"></a>05418     <span class="keywordflow">if</span> (argc &lt; 2)
<a name="l05419"></a>05419         <a class="code" href="tests_2getargs_8c.html#f2d4dfa5d66f265dc672b4601b830ca1">print_usage</a> (usgmsg, NULL);
<a name="l05420"></a>05420 
<a name="l05421"></a>05421     <span class="keywordflow">while</span> ((n = <a class="code" href="tests_2getargs_8c.html#175e400acb0e6991273c23e26c50585c">getargs</a> (argc, argv, options)) &gt; 0) {
<a name="l05422"></a>05422         <span class="keywordflow">switch</span> (n) {
<a name="l05423"></a>05423             <span class="keywordflow">case</span> <span class="charliteral">'v'</span>:
<a name="l05424"></a>05424                 verbose = 1;
<a name="l05425"></a>05425                 <span class="keywordflow">break</span>;
<a name="l05426"></a>05426             <span class="keywordflow">case</span> <span class="charliteral">'V'</span>:
<a name="l05427"></a>05427                 verbose = 2;
<a name="l05428"></a>05428                 <span class="keywordflow">break</span>;
<a name="l05429"></a>05429             <span class="keywordflow">case</span> <span class="charliteral">'u'</span>:
<a name="l05430"></a>05430             <span class="keywordflow">case</span> <span class="charliteral">'U'</span>:
<a name="l05431"></a>05431                 update = n;
<a name="l05432"></a>05432                 <span class="keywordflow">break</span>;
<a name="l05433"></a>05433             <span class="keywordflow">case</span> <span class="charliteral">'w'</span>:
<a name="l05434"></a>05434                 dowarn = atoi (<a class="code" href="tests_2getargs_8c.html#551d9bb1ecea9cf307fb4f32fdcdf815">argarg</a>);
<a name="l05435"></a>05435                 <span class="keywordflow">break</span>;
<a name="l05436"></a>05436             <span class="keywordflow">case</span> <span class="charliteral">'e'</span>:
<a name="l05437"></a>05437                 doerr = 0;
<a name="l05438"></a>05438                 <span class="keywordflow">break</span>;
<a name="l05439"></a>05439         }
<a name="l05440"></a>05440     }
<a name="l05441"></a>05441 
<a name="l05442"></a>05442     <span class="keywordflow">if</span> (<a class="code" href="tests_2getargs_8c.html#c990dfee758e8af230f32082c2128245">argind</a> == argc)
<a name="l05443"></a>05443         <a class="code" href="tests_2getargs_8c.html#f2d4dfa5d66f265dc672b4601b830ca1">print_usage</a> (usgmsg, <span class="stringliteral">"CGNSfile not given"</span>);
<a name="l05444"></a>05444     cgnsfile = argv[<a class="code" href="tests_2getargs_8c.html#c990dfee758e8af230f32082c2128245">argind</a>++];
<a name="l05445"></a>05445 
<a name="l05446"></a>05446     <span class="comment">/* update CGNS file by opening it in modify mode */</span>
<a name="l05447"></a>05447 
<a name="l05448"></a>05448     <span class="keywordflow">if</span> (update) {
<a name="l05449"></a>05449         <span class="keywordtype">char</span> *newfile = <a class="code" href="tests_2getargs_8c.html#c990dfee758e8af230f32082c2128245">argind</a> &lt; argc ? argv[<a class="code" href="tests_2getargs_8c.html#c990dfee758e8af230f32082c2128245">argind</a>] : NULL;
<a name="l05450"></a>05450         cgnsfile = update_version (cgnsfile, newfile);
<a name="l05451"></a>05451         <span class="keywordflow">if</span> (update == <span class="charliteral">'U'</span>)
<a name="l05452"></a>05452             exit (0);
<a name="l05453"></a>05453     }
<a name="l05454"></a>05454 
<a name="l05455"></a>05455     printf (<span class="stringliteral">"reading CGNS file %s\n"</span>, cgnsfile);
<a name="l05456"></a>05456     fflush (stdout);
<a name="l05457"></a>05457     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2955a491a7a66eeba1892453e3d95466">cg_open</a> (cgnsfile, <a class="code" href="cgns_keywords_8h.html#eca03512ad78c691a2015799ba394b46">CG_MODE_READ</a>, &amp;cgnsfn)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_open"</span>);
<a name="l05458"></a>05458 
<a name="l05459"></a>05459     <span class="comment">/* get version */</span>
<a name="l05460"></a>05460 
<a name="l05461"></a>05461     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#0f6ad489630fca6ed6e0057cc7699d4b">cg_version</a> (cgnsfn, &amp;file_version)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_version"</span>);
<a name="l05462"></a>05462     FileVersion = (int)(1000.0 * file_version + 0.5);
<a name="l05463"></a>05463     <span class="keywordflow">if</span> (LibraryVersion &lt; FileVersion)
<a name="l05464"></a>05464         warning (1, <span class="stringliteral">"CGNS file version is more recent than library version"</span>);
<a name="l05465"></a>05465 
<a name="l05466"></a>05466     <span class="comment">/* get number of bases */</span>
<a name="l05467"></a>05467 
<a name="l05468"></a>05468     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#2ba1455488f589ca9f720fd84056eed1">cg_nbases</a> (cgnsfn, &amp;nbases)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_nbases"</span>);
<a name="l05469"></a>05469     <span class="keywordflow">if</span> (nbases &lt; 1) warning (1, <span class="stringliteral">"no bases defined in CGNS file"</span>);
<a name="l05470"></a>05470     <span class="keywordflow">for</span> (cgnsbase = 1; cgnsbase &lt;= nbases; cgnsbase++)
<a name="l05471"></a>05471         check_base ();
<a name="l05472"></a>05472 
<a name="l05473"></a>05473     <span class="comment">/* close CGNS file and exit */</span>
<a name="l05474"></a>05474 
<a name="l05475"></a>05475     <span class="keywordflow">if</span> (<a class="code" href="cgnslib_8c.html#6ddf0a34d741c920b84d52e341ffc533">cg_close</a> (cgnsfn)) <a class="code" href="test__exts_8c.html#f728cd7e7ab13b7179164eb8fe96f9a5">error_exit</a>(<span class="stringliteral">"cg_close"</span>);
<a name="l05476"></a>05476     puts (<span class="stringliteral">"\nchecking complete"</span>);
<a name="l05477"></a>05477     <span class="keywordflow">if</span> (totwarn) printf (<span class="stringliteral">"%d warnings (%d shown)\n"</span>, totwarn, nwarn);
<a name="l05478"></a>05478     <span class="keywordflow">if</span> (nerr) printf (<span class="stringliteral">"%d errors\n"</span>, nerr);
<a name="l05479"></a>05479     <span class="keywordflow">return</span> 0;
<a name="l05480"></a>05480 }
<a name="l05481"></a>05481 
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Jun 25 10:29:46 2009 for CGNS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
